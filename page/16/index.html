<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="90后，桶装水保洁工程狮，ಥ_ಥ">
<meta property="og:type" content="website">
<meta property="og:title" content="Nameless13">
<meta property="og:url" content="https://nameless13.github.io/page/16/index.html">
<meta property="og:site_name" content="Nameless13">
<meta property="og:description" content="90后，桶装水保洁工程狮，ಥ_ಥ">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Nameless13">
<meta name="twitter:description" content="90后，桶装水保洁工程狮，ಥ_ಥ">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: 'J3OX6892F7',
      apiKey: '38852eb9095216f8f2ada575a06a9cfc',
      indexName: 'Blog',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://nameless13.github.io/page/16/"/>





  <title>Nameless13</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Nameless13</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Document/Docker入门到实践.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Document/Docker入门到实践.html" itemprop="url">Docker入门到实践</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-20T00:00:00+08:00">
                2016-10-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Document/" itemprop="url" rel="index">
                    <span itemprop="name">Document</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Docker–入门到实践"><a href="#Docker–入门到实践" class="headerlink" title="Docker–入门到实践"></a>Docker–入门到实践</h1><p>Virtuial Machines<br>each virtualized application includes not nonly the application - which may be only 10s of MB -and the necessary binaries,but also an entire guest operating system - which may weigh 10s of GB</p>
<hr>
<p>Docker<br>The Docker Engine container comprises just the application and its dependencies. it runs aas an isolated process in userspace on the host operating system,sharing the kernel with other containers. Thus,it enjoys the resource and allocation benefits of VMs but is much more portable and efficient.</p>
<hr>
<p>容器除了运行其中的应用外,基本不消耗额外的系统资源,使得应用性能很高,同事系统的开销尽量小,相比传统虚拟机方式运行10个不同的应用要起10个虚拟机,而Docker只需要启动10个隔离应用即可.</p>
<table>
<thead>
<tr>
<th style="text-align:left">特性</th>
<th style="text-align:left">容器</th>
<th style="text-align:left">虚拟机</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">启动</td>
<td style="text-align:left">秒级</td>
<td style="text-align:left">分钟级</td>
</tr>
<tr>
<td style="text-align:left">硬盘使用</td>
<td style="text-align:left">一般为MB</td>
<td style="text-align:left">一般为GB</td>
</tr>
<tr>
<td style="text-align:left">性能</td>
<td style="text-align:left">接近原生</td>
<td style="text-align:left">弱于</td>
</tr>
<tr>
<td style="text-align:left">系统支持量</td>
<td style="text-align:left">单机支持上千个容器</td>
<td style="text-align:left">一般几十个</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><ul>
<li>镜像(Image)</li>
</ul>
<p>Docker镜像就是一个只读的模版,如可以包含一个完整的操作系统里面仅安装了Apache<br>镜像可以用来创建Docker容器<br>Docker提供了一个很简单的机制来创建镜像或者更新现有镜像,或者拿一个做好的镜像直接使用</p>
<hr>
<ul>
<li>容器(Container)</li>
</ul>
<p>Docker利用容器俩运行运用<br>容器是从镜像创建的运行实例.可以被启动,开始停止,删除.每个容器容器都是相互隔离的,保证安全的平台<br>可以把容器看作是一个简易版的Linux环境 (包括root用户权限,进程空间,用户空间和网络空间等)和运行在其中的应用程序</p>
<p>// 镜像是只读的,容器在启动的时候创建一层<code>可写层</code>作为最上层</p>
<hr>
<ul>
<li>仓库(Repository)</li>
</ul>
<p>仓库是几种存放镜像文件的场所.仓库注册服务器上往往存放多个仓库,每个仓库中又包含多个镜像,每个镜像有不同的标签(tag)</p>
<p>仓库分为公开仓库(Public)和私有仓库(Private)</p>
<p>最大的公开仓库是Docker Hub,国内公开仓库有Docker Pool</p>
<p>用户可以本地网络内创建一个私有仓库,当创建了自己的镜像后可使用<code>push</code>命令上传到仓库,命令<code>pull</code>从仓库下载</p>
<hr>
<h2 id="CentOS-系列安装Docker"><a href="#CentOS-系列安装Docker" class="headerlink" title="CentOS 系列安装Docker"></a>CentOS 系列安装Docker</h2><p><code>docker pull hub.c.163.com/public/&lt;centos:7 class=&quot;0&quot;&gt;&lt;/centos:7&gt;</code></p>
<p><code>docker run -t -i hub.c.163.com/public/centos:7.0 /bin/bash</code><br>-t  选项让Docker分配一个伪终端（pseudo-tty）并绑定到容器的标准输入上，  -i  则让容器的标准输入保持打开</p>
<p><code>docker run -t -i training/sinatra /bin/bash</code>  //会下载一个新的…镜像</p>
<p>当利用<code>docker run</code> 创建容器时,Docker在后台运行的标准是:</p>
<ul>
<li>检查本地是否存在指定的镜像,不存在就从公有仓库下载</li>
<li>利用镜像创建并启动一个容器</li>
<li>分配一个文件系统,并在只读的镜像层外面挂载一层可读写成</li>
<li>从宿主主机配置的网桥接口中桥接一个虚拟接口道容器中去</li>
<li>从地址池配置一个IP地址给容器</li>
<li>执行用户指定的应用程序</li>
</ul>
<p><code>docker commit -m &quot;Added git&quot; -a &quot;Docker Newbee&quot; 40c9fe0a35ef centos:v2</code></p>
<hr>
<p><code>docker run -t -i hub.c.163.com/public/centos:7.0 /bin/bash</code><br><code>-t 让Docker分配一个伪终端(pseudo-tty)并绑定到容器的标准输入上,-i 让容器的标准输入保持打开</code></p>
<p>当利用docker run 创建容器时,Docker在后台运行的标准操作包括:</p>
<ul>
<li>检查本地是否存在指定的镜像,不存在就从公有仓库下载</li>
<li>利用镜像创建并启动一个容器</li>
<li>分配一个文件系统,并在只读的镜像层外面挂载一层可读写层</li>
<li>从宿主主机配置的网桥接口中桥接一个虚拟接口道容器中去</li>
<li>从地址池配置一个ip地址给容器</li>
<li>执行用户指定的应用程序</li>
<li>执行完毕后容器被终止</li>
</ul>
<h4 id="启动已终止容器"><a href="#启动已终止容器" class="headerlink" title="启动已终止容器"></a>启动已终止容器</h4><p>利用 <code>docker start</code> ,直接将一个已经终止的容器启动运行<br>容器的核心为所执行的应用程序,所需要的资源都是应用程序运行必需的.</p>
<h4 id="后台background运行"><a href="#后台background运行" class="headerlink" title="后台background运行"></a>后台background运行</h4><p>需要让docker在后台运行</p>
<hr>
<p>安装 `.bashrc_docker</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">wget -P ~ https://github.com/yeasy/docker_practice/raw/master/_local/.bashrc_docker</div><div class="line"><span class="built_in">echo</span> <span class="string">"[ -f ~/.bashrc_docker ] &amp;&amp; . ~/.bashrc_docker"</span> &gt;&gt; ~/.bashrc; <span class="built_in">source</span> ~/.bashrc</div><div class="line"></div><div class="line"><span class="built_in">echo</span> $(docker-pid docker)</div></pre></td></tr></table></figure>
</p>
<hr>
<h2 id="redis-master"><a href="#redis-master" class="headerlink" title="redis-master"></a>redis-master</h2><p><code>docker run --name redis-master -v /home/testuser/docker/master-redis.conf:/usr/local/etc/master-redis.conf -d -p 16397:16379 redis redis-server /usr/local/etc/master-redis.conf</code></p>
<h2 id="redis-slave"><a href="#redis-slave" class="headerlink" title="redis-slave"></a>redis-slave</h2><p><code>docker run --link redis-master:redis-master -v /home/testuser/docker/slave-redis.conf:/usr/local/etc/slave-redis.conf --name redis-slave1 -d redis redis-server /usr/local/etc/slave-redis.conf</code></p>
<h4 id="宿主机上如何获得-docker-container-容器的-ip-地址？"><a href="#宿主机上如何获得-docker-container-容器的-ip-地址？" class="headerlink" title="宿主机上如何获得 docker container 容器的 ip 地址？"></a>宿主机上如何获得 docker container 容器的 ip 地址？</h4><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">docker inspect --format=&apos;&#123;&#123;.NetworkSettings.IPAddress&#125;&#125;&apos; $CONTAINER_ID</div></pre></td></tr></table></figure>
</p>
<h3 id="在Docker容器内外互相拷贝数据"><a href="#在Docker容器内外互相拷贝数据" class="headerlink" title="在Docker容器内外互相拷贝数据"></a>在Docker容器内外互相拷贝数据</h3><h4 id="从容器内拷贝文件到主机上"><a href="#从容器内拷贝文件到主机上" class="headerlink" title="从容器内拷贝文件到主机上"></a>从容器内拷贝文件到主机上</h4><p><code>docker cp &lt;containerId&gt;:/file/path/within/container /host/path/target</code></p>
<p>没试验过</p>
<h4 id="从主机上拷贝文件到容器内"><a href="#从主机上拷贝文件到容器内" class="headerlink" title="从主机上拷贝文件到容器内"></a>从主机上拷贝文件到容器内</h4><ol>
<li><p>用-v挂载主机数据卷到容器内<br><code>docker run -v /path/to/hostdir:/mnt $container</code><br>在容器内拷贝<br><code>cp /mnt/sourcefile /path/to/destfile</code></p>
</li>
<li><p>直接在主机上拷贝到容器物理存储系统</p>
<ol>
<li>获取容器名称或者id : <code>docker ps</code></li>
<li><p>获取整个容器的id: </p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">docker inspect -f   <span class="string">'&#123;&#123;.Id&#125;&#125;'</span>  [获取的名称或者id]</div></pre></td></tr></table></figure>
</p>
</li>
<li><p>在主机上拷贝文件: <code>cp path-file-host /var/lib/docker/devicemapper/mnt/[获取的名称或者id]/rootfs/root</code></p>
</li>
</ol>
</li>
</ol>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line"></div><div class="line">1.</div><div class="line">[testuser@CentOS1 docker]<span class="variable">$docker</span> ps</div><div class="line">CONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                                NAMES</div><div class="line">01a349ea86bd        redis               <span class="string">"docker-entrypoint.s   42 minutes ago      Up 42 minutes       6379/tcp                             redis-slave3        </span></div><div class="line">bd45650a61f6        redis               "docker-entrypoint.s   43 minutes ago      Up 43 minutes       6379/tcp                             redis-slave2        </div><div class="line">ce2321f0d4d5        redis               <span class="string">"docker-entrypoint.s   46 minutes ago      Up 46 minutes       6379/tcp                             redis-slave1        </span></div><div class="line">9408dd71f9e9        redis               "docker-entrypoint.s   54 minutes ago      Up 54 minutes       6379/tcp, 0.0.0.0:16397-&gt;16379/tcp   redis-master </div><div class="line"></div><div class="line"></div><div class="line">2. </div><div class="line">[testuser@CentOS1 docker]$ docker inspect -f <span class="string">'&#123;&#123;.Id&#125;&#125;'</span> 9408dd71f9e9</div><div class="line">9408dd71f9e943b6ed08dd146e20700439eef280db7ce914852452340bfbfbbe</div><div class="line"></div><div class="line"></div><div class="line">3.</div><div class="line">[root@CentOS1 ~]<span class="comment">#cp sentinel.conf /var/lib/docker/devicemapper/mnt/9408dd71f9e943b6ed08dd146e20700439eef280db7ce914852452340bfbfbbe/rootfs/root/</span></div></pre></td></tr></table></figure>
</p>
<h4 id="退出容器而不停止容器"><a href="#退出容器而不停止容器" class="headerlink" title="退出容器而不停止容器"></a>退出容器而不停止容器</h4><p>组合键：Ctrl+P+Q</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Document/Dockerfile.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Document/Dockerfile.html" itemprop="url">Dockerfile</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-20T00:00:00+08:00">
                2016-10-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Document/" itemprop="url" rel="index">
                    <span itemprop="name">Document</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h1><p>使用Dockerfile可以允许用户创建自定义镜像</p>
<h2 id="基本结构"><a href="#基本结构" class="headerlink" title="基本结构"></a>基本结构</h2><p>Dockerfile 由一行行命令语句组成,并支持以#开头的注释行.<br>一般的，Dockerfile 分为四部分：基础镜像信息、维护者信息、镜像操作指令和容<br>器启动时执行指令:</p>
<p>`   </p>
<pre><code># This dockerfile uses the ubuntu image
# VERSION 2 - EDITION 1
# Author: docker_user
# Command format: Instruction [arguments / command] ..
# Base image to use, this must be set as the first line FROM ubuntu
# Maintainer: docker_user &lt;docker_user at email.com&gt; (@docker_user)
MAINTAINER docker_user docker_user@email.com
# Commands to update the image
RUN echo &quot;deb http://archive.ubuntu.com/ubuntu/ raring main universe&quot; &gt;&gt; /etc/apt/sources.list
RUN apt-get update &amp;&amp; apt-get install -y nginx
RUN echo &quot;\ndaemon off;&quot; &gt;&gt; /etc/nginx/nginx.conf
# Commands when creating a new container
CMD /usr/sbin/nginx

</code></pre><p>`</p>
<p>其中，一开始必须指明所基于的镜像名称，接下来推荐说明维护者信息。<br>后面则是镜像操作指令，例如 RUN 指令， RUN 指令将对镜像执行跟随的命令。<br>每运行一条 RUN 指令，镜像添加新的一层，并提交。<br>最后是 CMD 指令，来指定运行容器时的操作命令。<br>下面是一个更复杂的例子</p>
<p>`</p>
<pre><code># Nginx
#
# VERSION 0.0.1
FROM ubuntu
MAINTAINER Victor Vieux &lt;victor@docker.com&gt;
RUN apt-get update &amp;&amp; apt-get install -y inotify-tools nginx apache2 openssh-server
# Firefox over VNC
#
# VERSION 0.3
FROM ubuntu
# Install vnc, xvfb in order to create a &apos;fake&apos; display and firefox
RUN apt-get update &amp;&amp; apt-get install -y x11vnc xvfb firefox
RUN mkdir /.vnc
# Setup a password
RUN x11vnc -storepasswd 1234 ~/.vnc/passwd
# Autostart firefox (might not be the best way, but it does the trick)
RUN bash -c &apos;echo &quot;firefox&quot; &gt;&gt; /.bashrc&apos;
EXPOSE 5900
CMD [&quot;x11vnc&quot;, &quot;-forever&quot;, &quot;-usepw&quot;, &quot;-create&quot;]
# Multiple images example
#
# VERSION 0.1
FROM ubuntu
RUN echo foo &gt; bar
# Will output something like ===&gt; 907ad6c2736f
FROM ubuntu
RUN echo moo &gt; oink
# Will output something like ===&gt; 695d7793cbe4
# You᾿ll now have two images, 907ad6c2736f with /bar, and 695d7793cbe4 with
# /oink.

</code></pre><p>`</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Document/Dockerfile 实例.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Document/Dockerfile 实例.html" itemprop="url">Dockerfile 实例</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-20T00:00:00+08:00">
                2016-10-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Document/" itemprop="url" rel="index">
                    <span itemprop="name">Document</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Dockerfile-实例"><a href="#Dockerfile-实例" class="headerlink" title="Dockerfile 实例"></a>Dockerfile 实例</h1><p>apt-get update<br>&lt;!-- apt-get install openssh-server --&gt;<br>apt-get install -y openssh-server apache2 supervisor vim</p>
<hr>
<p>`   </p>
<pre><code>; supervisor config file

[unix_http_server]
file=/var/run/supervisor.sock   ; (the path to the socket file)
chmod=0700                       ; sockef file mode (default 0700)

[supervisord]
logfile=/var/log/supervisor/supervisord.log ; (main log file;default $CWD/supervisord.log)
pidfile=/var/run/supervisord.pid ; (supervisord pidfile;default supervisord.pid)
childlogdir=/var/log/supervisor            ; (&apos;AUTO&apos; child log dir, default $TEMP)

; the below section must remain in the config file for RPC
; (supervisorctl/web interface) to work, additional interfaces may be
; added by defining them in separate rpcinterface: sections
[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///var/run/supervisor.sock ; use a unix:// URL  for a unix socket

; The [include] section can just contain the &quot;files&quot; setting.  This
; setting can list multiple files (separated by whitespace or
; newlines).  It can also contain wildcards.  The filenames are
; interpreted as relative to this file.  Included files *cannot*
; include files themselves.

[include]
files = /etc/supervisor/conf.d/*.conf


</code></pre><p>`</p>
<hr>
<p>`   </p>
<pre><code>[supervisord]
nodaemon=true
[program:sshd]
command=/usr/sbin/sshd -D
[program:apache2]
command=/bin/bash -c &quot;source /etc/apache2/envvars &amp;&amp; exec /usr/sbin/apache2 -DFOREGROUND&quot;

</code></pre><p>`</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Linux/centos sublime.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Linux/centos sublime.html" itemprop="url">centos sublime</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-07T00:00:00+08:00">
                2016-09-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="建立软件安装目录（我一般把软件安装在opt目录下）"><a href="#建立软件安装目录（我一般把软件安装在opt目录下）" class="headerlink" title="建立软件安装目录（我一般把软件安装在opt目录下）"></a>建立软件安装目录（我一般把软件安装在opt目录下）</h1><p><code>mkdir /opt</code><br><code>cd /opt</code></p>
<h2 id="下载软件"><a href="#下载软件" class="headerlink" title="下载软件"></a>下载软件</h2><p><a href="http://www.sublimetext.com/3" target="_blank" rel="noopener">http://www.sublimetext.com/3</a><br>注意一定要下Ubuntu/tarball包。<br>也可以用命令下载</p>
<p>wget <a href="http://c758482.r82.cf2.rackcdn.com/sublime_text_3_build_3083_x64.tar.bz2" target="_blank" rel="noopener">http://c758482.r82.cf2.rackcdn.com/sublime_text_3_build_3083_x64.tar.bz2</a></p>
<p>如果链接地址失效，请到官网获取最新下载地址。</p>
<h2 id="解压软件包"><a href="#解压软件包" class="headerlink" title="解压软件包"></a>解压软件包</h2><p>tar jxvf sublime_text_3_build_3059_x64.tar.bz2</p>
<h2 id="命令行下直接运行"><a href="#命令行下直接运行" class="headerlink" title="命令行下直接运行"></a>命令行下直接运行</h2><p><code>cd /opt/sublime_text_3</code><br><code>./sublime_text</code></p>
<h2 id="创建桌面快捷方式"><a href="#创建桌面快捷方式" class="headerlink" title="创建桌面快捷方式"></a>创建桌面快捷方式</h2><p>复制文件</p>
<p><code>cp /opt/sublime_text_3/sublime_text.desktop /usr/share/applications</code></p>
<p>更改配置文件</p>
<p><code>vim /usr/share/applications/sublime_text.desktop</code></p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">我的配置如下</div><div class="line">[Desktop Entry]</div><div class="line">Version=1.0</div><div class="line">Type=Application</div><div class="line">Name=Sublime Text</div><div class="line">GenericName=Text Editor</div><div class="line">Comment=Sophisticated text editor for code, markup and prose</div><div class="line">Exec=/opt/sublime_text_3/sublime_text %F</div><div class="line">Terminal=false</div><div class="line">MimeType=text/plain;</div><div class="line">Icon=/opt/sublime_text_3/Icon/48x48/sublime-text.png</div><div class="line">Categories=TextEditor;Development;</div><div class="line">StartupNotify=true</div><div class="line">Actions=Window;Document;</div><div class="line"></div><div class="line">[Desktop Action Window]</div><div class="line">Name=New Window</div><div class="line">Exec=/opt/sublime_text_3/sublime_text -n</div><div class="line">OnlyShowIn=Unity;</div><div class="line"></div><div class="line">[Desktop Action Document]</div><div class="line">Name=New File</div><div class="line">Exec=/opt/sublime_text/sublime_text_3 --command new_file</div><div class="line">OnlyShowIn=Unity;</div></pre></td></tr></table></figure>
</p>
<h2 id="打开软件"><a href="#打开软件" class="headerlink" title="打开软件"></a>打开软件</h2><p>应用程序 &gt;编程 &gt; Sublime Text”右键”将此启动器添加到桌面”</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Document/YAML.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Document/YAML.html" itemprop="url">YAML</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-07T00:00:00+08:00">
                2016-09-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Document/" itemprop="url" rel="index">
                    <span itemprop="name">Document</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="YAML"><a href="#YAML" class="headerlink" title="YAML"></a>YAML</h1><p><a href="http://nodeca.github.io/js-yaml/" target="_blank" rel="noopener">demo实例</a></p>
<ul>
<li>大小写敏感</li>
<li>使用缩进表示层级关系</li>
<li>缩进时不允许使用Tab键,只运行使用空格</li>
<li>缩进的空格数目不重要,只要相同层级的元素左侧对齐即可</li>
<li><h1 id="表示注释-从这个字符一直到行尾-都会被解析器忽略"><a href="#表示注释-从这个字符一直到行尾-都会被解析器忽略" class="headerlink" title="表示注释,从这个字符一直到行尾,都会被解析器忽略"></a>表示注释,从这个<em>字符</em>一直到行尾,都会被解析器忽略</h1></li>
</ul>
<h3 id="YAML支持的数据结构有三种"><a href="#YAML支持的数据结构有三种" class="headerlink" title="YAML支持的数据结构有三种"></a>YAML支持的数据结构有三种</h3><ul>
<li>对象:键值对的集合又称为映射（mapping）/ 哈希（hashes） / 字典（dictionary）</li>
<li>数组:一组按次序排列的值，又称为序列（sequence） / 列表（list）</li>
<li>纯量（scalars）：单个的、不可再分的值</li>
</ul>
<h2 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h2><p>对象的一组键值对，使用冒号结构表示<br>animal: pets –&gt; JS { animal: ‘pets’ }</p>
<p>Yaml 也允许另一种写法，将所有键值对写成一个行内对象。<br>hash: { name: Steve, foo: bar }   –&gt; JS { hash: { name: ‘Steve’, foo: ‘bar’ } }</p>
<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><p>一组连词线开头的行，构成一个数组。<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line"></div><div class="line">- Cat</div><div class="line">- Dog</div><div class="line">- Goldfish</div></pre></td></tr></table></figure></p>
<p>–&gt; JS<br>[ ‘Cat’, ‘Dog’, ‘Goldfish’ ]</p>
<p>数据结构的子成员是一个数组，则可以在该项下面缩进一个空格。<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line"></div><div class="line">-</div><div class="line"> - Cat</div><div class="line"> - Dog</div><div class="line"> - Goldfish</div></pre></td></tr></table></figure></p>
<p>–&gt;JS<br>[ [ ‘Cat’, ‘Dog’, ‘Goldfish’ ] ]<br>数组也可以采用行内表示法。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Linux/Linux 防火墙.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Linux/Linux 防火墙.html" itemprop="url">Linux 防火墙</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-07T00:00:00+08:00">
                2016-09-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[root@CentOS3 redis]# service iptables status</div><div class="line">Table: filter</div><div class="line">Chain INPUT (policy ACCEPT)</div><div class="line">num  target     prot opt source               destination         </div><div class="line">1    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           state RELATED,ESTABLISHED </div><div class="line">2    ACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0           </div><div class="line">3    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           </div><div class="line">4    ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           state NEW tcp dpt:22 </div><div class="line">5    REJECT     all  --  0.0.0.0/0            0.0.0.0/0           reject-with icmp-host-prohibited </div><div class="line"></div><div class="line">Chain FORWARD (policy ACCEPT)</div><div class="line">num  target     prot opt source               destination         </div><div class="line">1    REJECT     all  --  0.0.0.0/0            0.0.0.0/0           reject-with icmp-host-prohibited </div><div class="line"></div><div class="line">Chain OUTPUT (policy ACCEPT)</div><div class="line">num  target     prot opt source               destination         </div><div class="line"></div><div class="line">[root@CentOS3 redis]# service iptables stop</div><div class="line">iptables: Setting chains to policy ACCEPT: filter          [  OK  ]</div><div class="line">iptables: Flushing firewall rules:                         [  OK  ]</div><div class="line">iptables: Unloading modules:                               [  OK  ]</div><div class="line">[root@CentOS3 redis]# service ip6tables stop</div><div class="line">ip6tables: Setting chains to policy ACCEPT: filter         [  OK  ]</div><div class="line">ip6tables: Flushing firewall rules:                        [  OK  ]</div><div class="line">ip6tables: Unloading modules:                              [  OK  ]</div><div class="line">[root@CentOS3 redis]# chkconfig iptables down</div><div class="line">chkconfig version 1.3.49.3 - Copyright (C) 1997-2000 Red Hat, Inc.</div><div class="line">This may be freely redistributed under the terms of the GNU Public License.</div><div class="line"></div><div class="line">usage:   chkconfig [--list] [--type &lt;type&gt;] [name]</div><div class="line">         chkconfig --add &lt;name&gt;</div><div class="line">         chkconfig --del &lt;name&gt;</div><div class="line">         chkconfig --override &lt;name&gt;</div><div class="line">         chkconfig [--level &lt;levels&gt;] [--type &lt;type&gt;] &lt;name&gt; &lt;on|off|reset|resetpriorities&gt;</div><div class="line">[root@CentOS3 redis]# chkconfig iptables off</div><div class="line">[root@CentOS3 redis]# chkconfig ip6tables off</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">`service iptables status`   查看iptables状态</div><div class="line">`service iptables restart`  iptables服务重启</div><div class="line">`service iptables stop`     iptables服务禁用</div></pre></td></tr></table></figure>
</p>
<hr>
<p>ip地址后边加个/8(16,24,32)是什么意思?<br>是掩码的位数，A类IP地址的默认子网掩码为255.0.0.0（由于255相当于二进制的8位1，所以也缩写成“/8”，表示网络号占了8位）;B类的为255.255.0.0（/16）;C类的为255.255.255.0(/24)。/30就是255.255.255.252。32就是255.255.255.255.</p>
<p>本机的DNS配置信息是在：/etc/resolv.conf</p>
<hr>
<p>time cost is(3\d{3}?ms)</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Redis/Redis.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Redis/Redis.html" itemprop="url">Redis</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-07T00:00:00+08:00">
                2016-09-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/redis/" itemprop="url" rel="index">
                    <span itemprop="name">redis</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="名字引用规则"><a href="#名字引用规则" class="headerlink" title="名字引用规则"></a>名字引用规则</h3><pre><code>在第一次应用Redis源代码文件file中的名字name时,本书使用file/name格式,比如redis.c/main 表示redis.c文件中的main函数,而redis.h/redisDb则表示redis.h文件中的redisDb结构,

另外,在第一次应用标准库头文件file中的名字name时,本书使用&lt;file&gt;/name格式,比如&lt;unistd.h&gt;/write表示unistd.h头文件的write函数,而&lt;sudio.h&gt;/printf则表示stdio.h头文件的write函数,而&lt;stdio.h&gt;/printf则表示stdio.h头文件的printf函数,

在第一次引用某个名字之后,本书就回去掉名字前缀的文件名,直接使用名字本身.举个例子.当第一次引用redis.h文件的redisDb结构的时候,会使用redis.h/redisDb格式,而之后再次引用redisDb结构时,只使用redisDb.


</code></pre><hr>
<h3 id="结构引用规则"><a href="#结构引用规则" class="headerlink" title="结构引用规则"></a>结构引用规则</h3><pre><code>本书使用struct.property格式来引用struct结构的property属性,比如redisDb.id表示redisDb结构的id属性,而redisDb.expires则表示redisDb结构的expires属性


</code></pre><hr>
<h3 id="Cluster群集一般来讲有四个功能"><a href="#Cluster群集一般来讲有四个功能" class="headerlink" title="Cluster群集一般来讲有四个功能"></a>Cluster群集一般来讲有四个功能</h3><ol>
<li>冗余功能,就是说在这个群集中的任何一台机器出现本机或网络故障时，整个网络仍不中断，对外的服务也不中断，网络有多个路线可以走,服务器也可以相互代替。<br>2.负载均衡，就是当网络流量很大时。少量的服务器可能响应不过来，这时需要多台服务器为其分担处理。打个比方：一台IA服务器的处理能力是每秒几万个，显然无法在一秒钟内处理几十万个请求，但如果我们能够有10台这样的服务器组成一个系统，如果有办法将所有的请求平均分配到所有的服务器，那么这个系统就拥有了每秒处理几十万个请求的能力。</li>
<li>协商处理，这种方案的原理是客户请求会同时被所有的节点所接收，然后所有节点按照一定的规则协商决定由哪个节点处理这个请求。此种方案中比较显著的特点就是整个集群中没有显著的管理节点，所有决定由全体工作节点共同协商作出。<br>4。流量分发，原理是所有的用户请求首先到达集群的管理节点，管理节点可以根据所有服务节点的处理能力和现状来决定将这个请求分发给某个服务节点。当某个服务节点由于硬件或软件原因故障时，管理节点能够自动检测到并停止向这个服务节点分发流量。这样，既通过将流量分担而增加了整个系统的性能和处理能力，又可以很好的提高系统的可用性。</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Redis/redis-conf-笔记/redis_version_3.2.4.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Redis/redis-conf-笔记/redis_version_3.2.4.html" itemprop="url">redis_version_3.2.4</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-07T00:00:00+08:00">
                2016-09-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/redis/" itemprop="url" rel="index">
                    <span itemprop="name">redis</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/redis/redis-conf-笔记/" itemprop="url" rel="index">
                    <span itemprop="name">redis-conf-笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>redis_version:3.2.4                                                                                     //Redis 服务器版本<br>redis_git_sha1:00000000                                                                                     //Git SHA1<br>redis_git_dirty:0                                                                                   //Git dirty flag<br>redis_build_id:96326b2f9b8cf2d2<br>redis_mode:standalone<br>os:Linux 3.10.0-327.el7.x86_64 x86_64                                                                                   //Redis 服务器的宿主操作系统<br>arch_bits:64                                                                                    // 架构（32 或 64 位）<br>multiplexing_api:epoll                                                                                      // Redis 所使用的事件处理机制<br>gcc_version:4.8.5                                                                                       //编译 Redis 时所使用的 GCC 版本<br>process_id:23278                                                                                    //服务器进程的 PID<br>run_id:f5284394b52327c8697f7bff3995643dcbc2af7b                                                                                     //Redis 服务器的随机标识符（用于 Sentinel 和集群）<br>tcp_port:7380                                                                                   //TCP/IP 监听端口<br>uptime_in_seconds:617                                                                                       //自 Redis 服务器启动以来，经过的秒数<br>uptime_in_days:0                                                                                        // 自 Redis 服务器启动以来，经过的天数<br>hz:10<br>lru_clock:16720581                                                                                      //以分钟为单位进行自增的时钟，用于 LRU 管理<br>executable:/root/redis-server<br>config_file:/etc/redis/7380.conf</p>
<h1 id="Clients"><a href="#Clients" class="headerlink" title="Clients"></a>Clients</h1><p>connected_clients:7                                                  : 已连接客户端的数量（不包括通过从属服务器连接的客户端）<br>client_longest_output_list:0                                                 : 当前连接的客户端当中，最长的输出列表<br>client_biggest_input_buf:0                                                   : 当前连接的客户端当中，最大输入缓存<br>blocked_clients:0                                                : 正在等待阻塞命令（BLPOP、BRPOP、BRPOPLPUSH）的客户端的数量</p>
<h1 id="Memory"><a href="#Memory" class="headerlink" title="Memory"></a>Memory</h1><p>used_memory:6210872                                                  : 由 Redis 分配器分配的内存总量，以字节（byte）为单位<br>used_memory_human:5.92M                                                  : 以人类可读的格式返回 Redis 分配的内存总量<br>used_memory_rss:2621440                                                  : 从操作系统的角度，返回 Redis 已分配的内存总量（俗称常驻集大小）。这个值和 top 、 ps 等命令的输出一致。<br>used_memory_rss_human:2.50M<br>used_memory_peak:6332792                                                 : Redis 的内存消耗峰值（以字节为单位）<br>used_memory_peak_human:6.04M<br>total_system_memory:8087961600<br>total_system_memory_human:7.53G<br>used_memory_lua:37888    Lua 引擎所使用的内存大小（以字节为单位）<br>used_memory_lua_human:37.00K<br>maxmemory:2147483648<br>maxmemory_human:2.00G<br>maxmemory_policy:noeviction<br>mem_fragmentation_ratio:0.42                                                 : used_memory_rss 和 used_memory 之间的比率<br>mem_allocator:jemalloc-4.0.3                                                 : 在编译时指定的， Redis 所使用的内存分配器。可以是 libc 、 jemalloc 或者 tcmalloc </p>
<pre><code>在理想情况下， used_memory_rss 的值应该只比 used_memory 稍微高一点儿。

</code></pre><p>当 rss &gt; used ，且两者的值相差较大时，表示存在（内部或外部的）内存碎片。<br>内存碎片的比率可以通过 mem_fragmentation_ratio 的值看出。<br>当 used &gt; rss 时，表示 Redis 的部分内存被操作系统换出到交换空间了，在这种情况下，操作可能会产生明显的延迟。<br>        Because Redis does not have control over how its allocations are mapped to memory pages, high used_memory_rss is often the result of a spike in memory usage.<br>当 Redis 释放内存时，分配器可能会，也可能不会，将内存返还给操作系统。<br>如果 Redis 释放了内存，却没有将内存返还给操作系统，那么 used_memory 的值可能和操作系统显示的 Redis 内存占用并不一致。<br>查看 used_memory_peak 的值可以验证这种情况是否发生。</p>
<h1 id="Persistence-RDB-和-AOF-的相关信息"><a href="#Persistence-RDB-和-AOF-的相关信息" class="headerlink" title="Persistence                                                    : RDB 和 AOF 的相关信息"></a>Persistence                                                    : RDB 和 AOF 的相关信息</h1><p>loading:0<br>rdb_changes_since_last_save:0<br>rdb_bgsave_in_progress:0<br>rdb_last_save_time:1476337757<br>rdb_last_bgsave_status:ok<br>rdb_last_bgsave_time_sec:0<br>rdb_current_bgsave_time_sec:-1<br>aof_enabled:1<br>aof_rewrite_in_progress:0<br>aof_rewrite_scheduled:0<br>aof_last_rewrite_time_sec:-1<br>aof_current_rewrite_time_sec:-1<br>aof_last_bgrewrite_status:ok<br>aof_last_write_status:ok<br>aof_current_size:0<br>aof_base_size:0<br>aof_pending_rewrite:0<br>aof_buffer_length:0<br>aof_rewrite_buffer_length:0<br>aof_pending_bio_fsync:0<br>aof_delayed_fsync:0</p>
<h1 id="Stats-一般统计信息"><a href="#Stats-一般统计信息" class="headerlink" title="Stats                                                  : 一般统计信息"></a>Stats                                                  : 一般统计信息</h1><p>total_connections_received:9<br>total_commands_processed:3497<br>instantaneous_ops_per_sec:6<br>total_net_input_bytes:180031<br>total_net_output_bytes:12844181<br>instantaneous_input_kbps:0.35<br>instantaneous_output_kbps:1.08<br>rejected_connections:0<br>sync_full:1<br>sync_partial_ok:0<br>sync_partial_err:0<br>expired_keys:0<br>evicted_keys:0<br>keyspace_hits:0<br>keyspace_misses:0<br>pubsub_channels:1<br>pubsub_patterns:0<br>latest_fork_usec:83<br>migrate_cached_sockets:0</p>
<h1 id="Replication-主-从复制信息"><a href="#Replication-主-从复制信息" class="headerlink" title="Replication                                                : 主/从复制信息"></a>Replication                                                : 主/从复制信息</h1><p>role:master<br>connected_slaves:1<br>slave0:ip=192.168.29.136,port=7381,state=online,offset=128863,lag=0<br>master_repl_offset:128863<br>repl_backlog_active:1<br>repl_backlog_size:5242880<br>repl_backlog_first_byte_offset:2<br>repl_backlog_histlen:128862</p>
<h1 id="CPU-CPU-计算量统计信息"><a href="#CPU-CPU-计算量统计信息" class="headerlink" title="CPU                                                : CPU 计算量统计信息"></a>CPU                                                : CPU 计算量统计信息</h1><p>used_cpu_sys:0.33<br>used_cpu_user:0.20<br>used_cpu_sys_children:0.00<br>used_cpu_user_children:0.00</p>
<h1 id="Cluster-Redis-集群信息"><a href="#Cluster-Redis-集群信息" class="headerlink" title="Cluster                                                : Redis 集群信息"></a>Cluster                                                : Redis 集群信息</h1><p>cluster_enabled:0</p>
<h1 id="Keyspace"><a href="#Keyspace" class="headerlink" title="Keyspace"></a>Keyspace</h1>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Redis/redis服务搭建/redis服务搭建.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Redis/redis服务搭建/redis服务搭建.html" itemprop="url">redis服务搭建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-07T00:00:00+08:00">
                2016-09-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/redis/" itemprop="url" rel="index">
                    <span itemprop="name">redis</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/redis/redis服务搭建/" itemprop="url" rel="index">
                    <span itemprop="name">redis服务搭建</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="redis服务搭建"><a href="#redis服务搭建" class="headerlink" title="redis服务搭建"></a>redis服务搭建</h1><h2 id="主机命名"><a href="#主机命名" class="headerlink" title="主机命名"></a>主机命名</h2><ol>
<li>确定操作系统类型<br><code>cat  /etc/issue</code></li>
<li><p>查看当前系统的主机名<code>hostname</code></p>
</li>
<li><p>改/etc/sysconfig下的network文件<code>vi /etc/sysconfig/network</code></p>
<p>把HOSTNAME后面的值改为想要设置的主机名<br><code>NETWORKING=yes
HOSTNAME=CentOS2</code></p>
</li>
</ol>
<p>system network reset</p>
<p>exit 验证</p>
<p>不得重启</p>
<ol>
<li><p>更改/etc下的hosts文件</p>
<p><code>vi /etc/hosts</code><br>然后将localhost.localdomain改为想要设置的主机名。</p>
<pre><code>127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
192.168.29.136  CentOS1
192.168.29.135  CentOS2
192.168.29.134  CentOS3




</code></pre></li>
</ol>
<ol>
<li><code>reboot</code></li>
<li>检查<code>hostname</code></li>
</ol>
<h2 id="时钟同步"><a href="#时钟同步" class="headerlink" title="时钟同步"></a>时钟同步</h2><h3 id="CentOS6"><a href="#CentOS6" class="headerlink" title="CentOS6"></a>CentOS6</h3><ol>
<li><p>检查是否启动时钟同步服务<br>service检查:  <code>service ntpd status</code><br>job 检查 :    <code>crontab -l</code><br>修改定时任务: <code>crontab -e</code> </p>
</li>
<li><p>设置时钟同步:</p>
<ul>
<li>修改 /etc/ntp.conf  加入 ntp server ip<br><code>vi /etc/ntp.conf</code> <code>server 10.200.92.18</code></li>
<li>启动ntp服务:<br><code>service ntpd start</code></li>
<li>设置服务自动启动: <ol>
<li>设置 <code>chkconfig ntpd on</code></li>
<li>检查 <code>chkconfig -list ntpd</code></li>
</ol>
</li>
</ul>
</li>
</ol>
<h3 id="CentOS7"><a href="#CentOS7" class="headerlink" title="CentOS7"></a>CentOS7</h3><ul>
<li>使用rpm检查ntp包是否安装<br>[root@CentOS3 home]# rpm -q ntp<br>ntp-4.2.6p5-22.el7.centos.x86_64</li>
<li>如果已经安装则略过此步，否则使用yum进行安装，并设置系统开机自动启动并启动服务<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">yum -y install ntp</div><div class="line">systemctl enable ntpd</div><div class="line">systemctl start ntpd</div></pre></td></tr></table></figure>
</p>
</li>
</ul>
<p>修改完成后重启ntpd服务systemctl restart ntpd</p>
<p>使用ntpq -p 查看网络中的NTP服务器，同时显示客户端和每个服务器的关系</p>
<p>使用ntpstat 命令查看时间同步状态，这个一般需要5-10分钟后才能成功连接和同步。所以，服务器启动后需要稍等下：<br>刚启动的时候，一般是：</p>
<pre><code>unsynchronised
  time server re-starting
   polling server every 8 s





</code></pre><h2 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h2><p>CentOS release 6.8 (Final)</p>
<p>CentOS 7</p>
<h2 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h2><h3 id="CentOS-6-8"><a href="#CentOS-6-8" class="headerlink" title="CentOS 6.8:"></a>CentOS 6.8:</h3><pre><code>- 防火墙:
    - 即使生效,重启后失效
        开启: service iptables start
        关闭: service iptables stop
    - 重启后生效
        开启: chkconfig iptables on
        关闭: chkconfig iptables off
- 开启了防火墙时,做如下设置可以仅开启相关端口:
    修改/etc/sysconfig/iptables 文件,添加以下内容:
        -A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT 
        -A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT


</code></pre><h3 id="CentOS-7-0"><a href="#CentOS-7-0" class="headerlink" title="CentOS 7.0:"></a>CentOS 7.0:</h3><p>CentOS 7.0默认使用的是firewall作为防火墙，这里改为iptables防火墙。<br>firewall：</p>
<pre><code>systemctl start firewalld.service#启动firewall

systemctl stop firewalld.service#停止firewall

systemctl disable firewalld.service#禁止firewall开机启动



</code></pre><h2 id="源码安装redis"><a href="#源码安装redis" class="headerlink" title="源码安装redis"></a>源码安装redis</h2><pre><code>wget http://download.redis.io/releases/redis-3.2.4.tar.gz
tar xzf redis-3.2.4.tar.gz
cd redis-3.2.4
make
make test   //只用单核运行 make test：taskset -c 1 sudo make test
make install
mv redis-3.2.4 redis
mv redis /usr/local/



</code></pre><h2 id="修复3个redis-server-启动警告"><a href="#修复3个redis-server-启动警告" class="headerlink" title="修复3个redis-server 启动警告"></a>修复3个redis-server 启动警告</h2><pre><code>echo 1 &gt; /proc/sys/vm/overcommit_memory
echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled
echo 511 &gt; /proc/sys/net/core/somaxconn


</code></pre><h2 id="开机启动redis"><a href="#开机启动redis" class="headerlink" title="开机启动redis"></a>开机启动redis</h2><p><code>/usr/local/redis/utils/install_server.sh</code><br>第一个参数分别选择7380 7381 26379</p>
<h3 id="26379"><a href="#26379" class="headerlink" title="26379"></a>26379</h3><pre><code>Please select the redis executable path [/usr/local/bin/redis-server] 
+  /usr/local/bin/redis-sentinel



</code></pre><h3 id="关闭实例"><a href="#关闭实例" class="headerlink" title="关闭实例"></a>关闭实例</h3><pre><code>[root@CentOS3 redis]# ps aux|grep redis
root     19874  0.0  0.0 136912  7528 ?        Ssl  15:43   0:00 /usr/local/bin/redis-server 127.0.0.1:7380
root     20178  0.0  0.0 136912  7528 ?        Ssl  15:43   0:00 /usr/local/bin/redis-server 127.0.0.1:7381
root     20541  0.0  0.0 136912  7528 ?        Ssl  15:47   0:00 /usr/local/bin/redis-server 127.0.0.1:26379
root     20705  0.0  0.0 112644   992 pts/2    S+   15:48   0:00 grep --color=auto redis
[root@CentOS3 redis]# redis-cli -p 7380 shutdown
[root@CentOS3 redis]# redis-cli -p 7381 shutdown
[root@CentOS3 redis]# redis-cli -p 26379 shutdown
[root@CentOS3 redis]# ps aux|grep redis
root     20721  0.0  0.0 112644   996 pts/2    S+   15:49   0:00 grep --color=auto redis


</code></pre><p><code>redis-cli -p 7380 shutdown &amp;&amp; redis-cli -p 7381 shutdown &amp;&amp; redis-cli -p 26379 shutdown</code></p>
<h3 id="修改sentinel启动脚本"><a href="#修改sentinel启动脚本" class="headerlink" title="修改sentinel启动脚本"></a>修改sentinel启动脚本</h3><p><code>vim /etc/init.d/redis_26379</code></p>
<pre><code>+  REDISHOSTNAME=&quot;192.168.29.134&quot;

-   $CLIEXEC -p $REDISPORT shutdown
+   $CLIEXEC -h $REDISHOSTNAME -p $REDISPORT shutdown


</code></pre><h2 id="resid-service-config-135-7380"><a href="#resid-service-config-135-7380" class="headerlink" title="resid-service config (135:7380)"></a>resid-service config (135:7380)</h2><pre><code>-  bind 127.0.0.1
+  bind 192.168.29.135   

-  protected-mode yes
+  protected-mode no

-  # unixsocket /tmp/redis.sock
-  # unixsocketperm 700
+  unixsocket /tmp/redis.sock
+  unixsocketperm 700

-  timeout 0 
+  timeout 300

-  tcp-keepalive 300
+  tcp-keepalive 0

-  save 900 1
-  save 300 10
-  save 60 10000
+  #save 900 1
+  #save 300 10
+  #save 60 10000

-  stop-writes-on-bgsave-error yes
+  stop-writes-on-bgsave-error no

-  #repl-ping-slave-period 10
+  repl-ping-slave-period 10

-  # repl-backlog-size 1mb
+  repl-backlog-size 5mb
-  # repl-backlog-ttl 3600
+  repl-backlog-ttl 600

-  #maxclients 10000
+  maxclients 10000

-  # maxmemory &lt;bytes&gt;
+  maxmemory 2gb

-  appendonly no
+  appendonly yes 


</code></pre><h3 id="resid-service-config-135-7381"><a href="#resid-service-config-135-7381" class="headerlink" title="resid-service config (135:7381)"></a>resid-service config (135:7381)</h3><pre><code>cp /etc/redis/7380.conf /etc/redis/7381.conf
vim  /etc/redis/7381.conf

    `:%s/7380/7381/g`   //替换所有的7380为7381


</code></pre><h2 id="redis-sentinal-config-135-26379"><a href="#redis-sentinal-config-135-26379" class="headerlink" title="redis-sentinal config (135:26379)"></a>redis-sentinal config (135:26379)</h2><pre><code>rm -f /etc/redis/26379.conf
cp /usr/local/redis/sentinel.conf /etc/redis/26379.conf
vim /usr/local/redis/26379.conf

    +  daemonize yes
    -  #protected-mode no
    +  protected-mode no
    -  dir /tmp
    +  dir /var/lib/redis/26379
    +  logfile /var/log/redis_26379.log

    -  sentinel monitor mymaster 127.0.0.1 6379 2
    +  sentinel monitor redis136 192.168.29.136 7380 2
    -  sentinel down-after-milliseconds mymaster 30000
    +  sentinel down-after-milliseconds redis136 5000        
    -  sentinel parallel-syncs mymaster 1
    +  sentinel parallel-syncs redis136 1 
    -  sentinel failover-timeout mymaster 180000
    +  sentinel failover-timeout redis136 60000

    +  sentinel monitor redis135 192.168.29.135 7380 2
    +  sentinel down-after-milliseconds redis135 5000
    +  sentinel failover-timeout redis135 60000
    +  sentinel parallel-syncs redis135 1

    +  sentinel monitor redis134 192.168.29.134 7380 2
    +  sentinel down-after-milliseconds redis134 5000
    +  sentinel failover-timeout redis134 60000
    +  sentinel parallel-syncs redis134 1



</code></pre><h2 id="redis部署"><a href="#redis部署" class="headerlink" title="redis部署"></a>redis部署</h2><h3 id="预定分配方案"><a href="#预定分配方案" class="headerlink" title="预定分配方案:"></a>预定分配方案:</h3><pre><code>            192.168.29.134
             +---------+  
             | M1 7380 |
             | R3 7381 |
             | S1      |
             +---------+
192.168.29.136    |    192.168.29.135
  +---------+     |     +---------+
  | M3 7380 |     |     | M2 7380 |  
  | R2 7381 |-----------| R1 7381 |
  | S3      |           | S2      |
  +---------+           +---------+

  Configuration: quorum = 2




</code></pre><h3 id="redis-server实例启动"><a href="#redis-server实例启动" class="headerlink" title="redis-server实例启动:"></a>redis-server实例启动:</h3><pre><code>redis-server /etc/redis/7380.conf
redis-server /etc/redis/7381.conf

netstat -lntpa |grep redis 

</code></pre><h3 id="主从分配"><a href="#主从分配" class="headerlink" title="主从分配"></a>主从分配</h3><p>三台主机实例均启动之后,进行主从配置:</p>
<pre><code>redis-cli -h 192.168.29.134 -p 7381 slaveof 192.168.29.136 7380
redis-cli -h 192.168.29.135 -p 7381 slaveof 192.168.29.134 7380
redis-cli -h 192.168.29.136 -p 7381 slaveof 192.168.29.135 7380


</code></pre><h3 id="redis-sentinel实例启动"><a href="#redis-sentinel实例启动" class="headerlink" title="redis-sentinel实例启动:"></a>redis-sentinel实例启动:</h3><p>最后在三台主机上启动sentinel</p>
<p><code>redis-sentinel /etc/redis/26379.conf</code></p>
<h2 id="检查failover"><a href="#检查failover" class="headerlink" title="检查failover"></a>检查failover</h2><pre><code>redis-cli -h 192.168.29.135 -p 7380  debug sleep 300s
redis-cli -p 26379 sentinel master redis135



</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Redis/redis服务搭建/redis-sentinel docker集群.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Redis/redis服务搭建/redis-sentinel docker集群.html" itemprop="url">redis-sentinel docker集群</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-07T00:00:00+08:00">
                2016-09-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/redis/" itemprop="url" rel="index">
                    <span itemprop="name">redis</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/redis/redis服务搭建/" itemprop="url" rel="index">
                    <span itemprop="name">redis服务搭建</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="redis-master"><a href="#redis-master" class="headerlink" title="redis-master"></a>redis-master</h2><p><code>docker run --name redis-master -v /home/testuser/docker/master-redis.conf:/usr/local/etc/master-redis.conf -d -p 16397:16379 redis redis-server /usr/local/etc/master-redis.conf</code></p>
<h2 id="redis-slave"><a href="#redis-slave" class="headerlink" title="redis-slave"></a>redis-slave</h2><p><code>docker run --link redis-master:redis-master -v /home/testuser/docker/slave-redis.conf:/usr/local/etc/slave-redis.conf --name redis-slave1 -d redis redis-server /usr/local/etc/slave-redis.conf</code></p>
<p><code>docker run --link redis-master:redis-master -v /home/testuser/docker/slave-redis.conf:/usr/local/etc/slave-redis.conf --name redis-slave2 -d redis redis-server /usr/local/etc/slave-redis.conf</code></p>
<h4 id="宿主机上如何获得-docker-container-容器的-ip-地址？"><a href="#宿主机上如何获得-docker-container-容器的-ip-地址？" class="headerlink" title="宿主机上如何获得 docker container 容器的 ip 地址？"></a>宿主机上如何获得 docker container 容器的 ip 地址？</h4><p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">docker inspect --format=<span class="string">'&#123;&#123;.NetworkSettings.IPAddress&#125;&#125;'</span> [<span class="variable">$CONTAINER_ID</span>]</div></pre></td></tr></table></figure>
</p>
<p>172.17.0.51 mster<br>172.17.0.55 slave1<br>56  2<br>57  3</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">docker inspect -f <span class="string">'&#123;&#123;.Id&#125;&#125;'</span> [获取的名称或者id]</div></pre></td></tr></table></figure>
</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">[testuser@CentOS1 docker]$ redis-sentinel 3sentinel.conf &amp;</div><div class="line">[3] 28932</div><div class="line">[testuser@CentOS1 docker]$                 _._                                                  </div><div class="line">           _.-``__ <span class="string">''</span>-._                                             </div><div class="line">      _.-``    `.  `_.  <span class="string">''</span>-._           Redis 3.0.7 (00000000/0) 64 bit</div><div class="line">  .-`` .-```.  ```\/    _.,_ <span class="string">''</span>-._                                   </div><div class="line"> (    <span class="string">'      ,       .-`  | `,    )     Running in sentinel mode</span></div><div class="line"> |`-._`-...-` __...-.``-._|'` _.-<span class="string">'|     Port: 26383</span></div><div class="line"> |    `-._   `._    /     _.-'    |     PID: 28932</div><div class="line">  `-._    `-._  `-./  _.-<span class="string">'    _.-'</span>                                   </div><div class="line"> |`-._`-._    `-.__.-<span class="string">'    _.-'</span>_.-<span class="string">'|                                  </span></div><div class="line"> |    `-._`-._        _.-'_.-<span class="string">'    |           http://redis.io        </span></div><div class="line">  `-._    `-._`-.__.-'_.-<span class="string">'    _.-'</span>                                   </div><div class="line"> |`-._`-._    `-.__.-<span class="string">'    _.-'</span>_.-<span class="string">'|                                  </span></div><div class="line"> |    `-._`-._        _.-'_.-<span class="string">'    |                                  </span></div><div class="line">  `-._    `-._`-.__.-'_.-<span class="string">'    _.-'</span>                                   </div><div class="line">      `-._    `-.__.-<span class="string">'    _.-'</span>                                       </div><div class="line">          `-._        _.-<span class="string">'                                           </span></div><div class="line">              `-.__.-'                                               </div><div class="line"></div><div class="line">28932:X 05 Sep 16:10:12.875 <span class="comment"># Sentinel runid is d1d5d361d1d4c9576d64ab274571361ac963351f</span></div><div class="line">28932:X 05 Sep 16:10:12.875 <span class="comment"># +monitor master redis-master 172.17.0.62 16379 quorum 2</span></div><div class="line">28932:X 05 Sep 16:10:12.876 * +slave slave 172.17.0.63:16379 172.17.0.63 16379 @ redis-master 172.17.0.62 16379</div><div class="line">28932:X 05 Sep 16:10:12.908 * +slave slave 172.17.0.64:16379 172.17.0.64 16379 @ redis-master 172.17.0.62 16379</div><div class="line">28932:X 05 Sep 16:10:12.933 * +sentinel sentinel 172.17.42.1:26381 172.17.42.1 26381 @ redis-master 172.17.0.62 16379</div><div class="line">28932:X 05 Sep 16:10:13.009 * +sentinel sentinel 172.17.42.1:26382 172.17.42.1 26382 @ redis-master 172.17.0.62 16379</div></pre></td></tr></table></figure>
</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/15/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><span class="page-number current">16</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/17/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Nameless13" />
          <p class="site-author-name" itemprop="name">Nameless13</p>
           
              <p class="site-description motion-element" itemprop="description">90后，桶装水保洁工程狮，ಥ_ಥ</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">164</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">33</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        

      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Nameless13</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
