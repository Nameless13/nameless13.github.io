<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="90后，桶装水保洁工程狮，ಥ_ಥ">
<meta property="og:type" content="website">
<meta property="og:title" content="Nameless13">
<meta property="og:url" content="https://nameless13.github.io/page/9/index.html">
<meta property="og:site_name" content="Nameless13">
<meta property="og:description" content="90后，桶装水保洁工程狮，ಥ_ಥ">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Nameless13">
<meta name="twitter:description" content="90后，桶装水保洁工程狮，ಥ_ಥ">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: 'J3OX6892F7',
      apiKey: '38852eb9095216f8f2ada575a06a9cfc',
      indexName: 'Blog',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://nameless13.github.io/page/9/"/>





  <title>Nameless13</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Nameless13</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Error/[Hbase]hbase 连接超时.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Error/[Hbase]hbase 连接超时.html" itemprop="url">hbase 连接超时</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-23T00:00:00+08:00">
                2017-06-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/" itemprop="url" rel="index">
                    <span itemprop="name">CDH</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/Error/" itemprop="url" rel="index">
                    <span itemprop="name">Error</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="hbase-连接超时"><a href="#hbase-连接超时" class="headerlink" title="hbase 连接超时"></a>hbase 连接超时</h1><p>最开始是inood块权限有问题<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">6月 7, 早上8点24:55.119分    WARN    org.apache.hadoop.security.UserGroupInformation </div><div class="line">PriviledgedActionException as:hbase (auth:SIMPLE) cause:org.apache.hadoop.security.AccessControlException: Permission denied: user=hbase, access=WRITE, inode=&quot;/hbase/data/default/user_info/cc019437cc8b9ea29ab57461d9538945/info/4c3bafa7a4164b21bf71c6b3a80c0439_SeqId_222_&quot;:hadoop:supergroup:-rw-r--r--</div><div class="line">6月 7, 早上8点24:55.119分    INFO    org.apache.hadoop.ipc.Server    </div><div class="line">IPC Server handler 40 on 8020, call org.apache.hadoop.hdfs.protocol.ClientProtocol.setTimes from 10.200.60.145:34847 Call#9611380 Retry#0: org.apache.hadoop.security.AccessControlException: Permission denied: user=hbase, access=WRITE, inode=&quot;/hbase/data/default/user_info/cc019437cc8b9ea29ab57461d9538945/info/4c3bafa7a4164b21bf71c6b3a80c0439_SeqId_222_&quot;:hadoop:supergroup:-rw-r--r--</div></pre></td></tr></table></figure></p>
<p>手动修改后发现接连不断报出来 ,后来发现类似的bluk太多,直接修改chown上级目录 </p>
<p>之后发现 有很多的连接超时<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">6月 7, 下午1点38:29.634分	WARN	org.apache.zookeeper.server.NIOServerCnxnFactory	</div><div class="line">Too many connections from /10.200.60.123 - max is 60</div><div class="line">6月 7, 下午1点38:30.006分	INFO	org.apache.zookeeper.server.NIOServerCnxnFactory	</div><div class="line">Accepted socket connection from /172.16.70.43:41978</div><div class="line">6月 7, 下午1点38:30.010分	INFO	org.apache.zookeeper.server.ZooKeeperServer	</div><div class="line">Client attempting to establish new session at /172.16.70.43:41978</div><div class="line">6月 7, 下午1点38:30.019分	INFO	org.apache.zookeeper.server.ZooKeeperServer	</div><div class="line">Established session 0x25c62548f45168a with negotiated timeout 60000 for client /172.16.70.43:41978</div><div class="line">6月 7, 下午1点38:30.205分	INFO	org.apache.zookeeper.server.NIOServerCnxn	</div><div class="line">Closed socket connection for client /172.16.70.43:41978 which had sessionid 0x25c62548f45168a</div><div class="line">6月 7, 下午1点38:30.211分	WARN	org.apache.zookeeper.server.NIOServerCnxnFactory	</div><div class="line">Too many connections from /10.200.60.123 - max is 60</div><div class="line">6月 7, 下午1点38:30.399分	WARN	org.apache.zookeeper.server.NIOServerCnxnFactory	</div><div class="line">Too many connections from /10.200.60.123 - max is 60</div><div class="line">6月 7, 下午1点38:31.321分	WARN	org.apache.zookeeper.server.NIOServerCnxnFactory	</div><div class="line">Too many connections from /10.200.60.123 - max is 60</div><div class="line">6月 7, 下午1点38:32.097分	WARN	org.apache.zookeeper.server.NIOServerCnxnFactory	</div><div class="line">Too many connections from /10.200.60.123 - max is 60</div><div class="line">6月 7, 下午1点38:32.314分	WARN	org.apache.zookeeper.server.NIOServerCnxnFactory	</div><div class="line">Too many connections from /10.200.60.123 - max is 60</div></pre></td></tr></table></figure></p>
<p>这个问题 前几天一直有报错误但是没有表明哪一台连接数特别多 今天达到max后才报出来</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">6月 7, 上午9点37:02.713分    INFO    org.apache.zookeeper.server.ZooKeeperServer </div><div class="line">Client attempting to establish new session at /10.200.65.40:52131</div><div class="line">6月 7, 上午9点37:02.717分    INFO    org.apache.zookeeper.server.ZooKeeperServer </div><div class="line">Established session 0x25c62548f450748 with negotiated timeout 60000 for client /10.200.65.40:52131</div><div class="line">6月 7, 上午9点37:02.731分    WARN    org.apache.zookeeper.server.NIOServerCnxnFactory    </div><div class="line">Too many connections from /10.200.60.123 - max is 60</div><div class="line">6月 7, 上午9点37:02.862分    INFO    org.apache.zookeeper.server.NIOServerCnxnFactory    </div><div class="line">Accepted socket connection from /10.200.65.40:52369</div><div class="line">6月 7, 上午9点37:02.862分    INFO    org.apache.zookeeper.server.ZooKeeperServer </div><div class="line">Client attempting to establish new session at /10.200.65.40:52369</div><div class="line">6月 7, 上午9点37:02.874分    INFO    org.apache.zookeeper.server.ZooKeeperServer </div><div class="line">Established session 0x25c62548f450749 with negotiated timeout 60000 for client /10.200.65.40:52369</div></pre></td></tr></table></figure>
</p>
<p>123 </p>
<p>在123这台机器上看到与145的连接全部的端口都是2181</p>
<table>
<thead>
<tr>
<th style="text-align:left">Component</th>
<th style="text-align:left">Service</th>
<th style="text-align:left">Qualifier</th>
<th style="text-align:left">Port</th>
<th style="text-align:left">Access Requirement</th>
<th>Configuration</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Hadoop HDFS</td>
<td style="text-align:left">HQuorumPeer</td>
<td style="text-align:left">2181</td>
<td style="text-align:left">Internal</td>
<td style="text-align:left">hbase. zookeeper. property. clientPort</td>
<td>HBase-managed ZooKeeper mode</td>
</tr>
</tbody>
</table>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">ddp-dn-041:~ # netstat -lantp|grep 2181  </div><div class="line">tcp        0      0 10.200.60.123:34306     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56126     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:47177     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57633     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:32828     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57625     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48795     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:47189     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57635     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:52033     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:53245     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57591     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48781     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48779     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56177     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:47183     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56165     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:39211     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:34249     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:47164     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48857     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56148     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57610     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57615     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48612     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:34291     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57686     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:34300     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57623     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56172     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56168     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:47170     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:32904     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:32817     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57590     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48615     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48792     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56371     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57589     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56163     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56123     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48646     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56178     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:34280     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48633     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56180     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56152     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56162     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57594     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:51789     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57628     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56375     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:32819     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48651     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:47172     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57616     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56127     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56149     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48640     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56396     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56380     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56160     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:34293     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48620     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57618     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:47185     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48638     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57620     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57592     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57595     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56173     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:51992     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56158     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56171     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56167     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48785     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57602     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:32851     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57609     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:53145     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:34549     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56154     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56391     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56170     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48790     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57772     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57606     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:34297     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:32830     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56142     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:47168     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:51980     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56146     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57599     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:47158     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57603     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57587     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57612     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:47312     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:32844     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:32836     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56138     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48783     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:34308     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56179     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56145     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:47166     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:47338     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57583     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:34359     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:32908     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:34282     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56175     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56137     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56366     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57614     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:48787     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:56399     10.200.60.144:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:34284     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">tcp        0      0 10.200.60.123:57593     10.200.60.145:2181      ESTABLISHED 32710/java          </div><div class="line">ddp-dn-041:~ # ps aux|grep 32710</div><div class="line">root       475  0.0  0.0   4532   564 pts/7    S+   13:47   0:00 grep 32710</div><div class="line">root     32710  0.0  3.2 33279488 4239192 ?    Sl   May12  19:45 /usr/java/jdk1.7.0_67-cloudera/bin/java -Djava.util.logging.config.file=/home/hadoop/bin/apache-tomcat-7.0.73/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djdk.tls.ephemeralDHKeySize=2048 -Djava.endorsed.dirs=/home/hadoop/bin/apache-tomcat-7.0.73/endorsed -classpath /home/hadoop/bin/apache-tomcat-7.0.73/bin/bootstrap.jar:/home/hadoop/bin/apache-tomcat-7.0.73/bin/tomcat-juli.jar -Dcatalina.base=/home/hadoop/bin/apache-tomcat-7.0.73 -Dcatalina.home=/home/hadoop/bin/apache-tomcat-7.0.73 -Djava.io.tmpdir=/home/hadoop/bin/apache-tomcat-7.0.73/temp org.apache.catalina.startup.Bootstrap start</div></pre></td></tr></table></figure>
</p>
<p>145<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">ddp-hb-178:~ #  netstat -lantp|grep 2181</div><div class="line">tcp        0      0 0.0.0.0:2181            0.0.0.0:*               LISTEN      18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.16:42563      TIME_WAIT   -                   </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57625     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:34359     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.155:35202     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:34291     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48781     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.147:47393     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.34:10906      ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57606     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48615     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.24:39053      TIME_WAIT   -                   </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.24:39081      TIME_WAIT   -                   </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:34297     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:34280     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:45361     10.200.60.144:2181      ESTABLISHED 15492/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.151:36084     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:45352     10.200.60.144:2181      ESTABLISHED 15492/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:53245     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.24:39062      TIME_WAIT   -                   </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48790     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57612     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.148:58812     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.155:35191     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.147:47384     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48795     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48646     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:34308     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:45351     10.200.60.144:2181      ESTABLISHED 15492/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57614     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48779     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.47:51835      ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57592     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.145:59735     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.34:10903      ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:34306     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57620     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.24:39085      TIME_WAIT   -                   </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.34:10905      ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.144:51915     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57602     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48640     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:34282     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.16:42535      TIME_WAIT   -                   </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57583     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48620     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57603     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.16:42534      TIME_WAIT   -                   </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48783     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48612     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:34293     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:34300     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.156:44113     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57599     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57594     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57615     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.16:49370      ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.34:10904      ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48638     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48651     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.33:18797      ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57609     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57590     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57623     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48633     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57633     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.16:42558      TIME_WAIT   -                   </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57589     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57616     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:34549     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:34284     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57618     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57591     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.144:51909     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48857     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48785     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48792     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:45358     10.200.60.144:2181      ESTABLISHED 15007/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.148:58809     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.24.54:36651      ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57628     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57587     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57610     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57686     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57593     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:38108     10.200.60.147:2181      ESTABLISHED 15492/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57595     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:53145     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:34249     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.114:54498     TIME_WAIT   -                   </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:48787     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.16:42543      TIME_WAIT   -                   </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.24:39071      TIME_WAIT   -                   </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57772     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:39211     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.146:50729     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.144:51912     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.16:49368      ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.60.123:57635     ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:2181      10.200.65.33:18798      ESTABLISHED 18867/java          </div><div class="line">tcp        0      0 10.200.60.145:59735     10.200.60.145:2181      ESTABLISHED 17996/java          </div><div class="line">ddp-hb-178:~ # ps aux|grep 18867</div><div class="line">root      1402  0.0  0.0   4532   560 pts/1    S+   13:51   0:00 grep 18867</div><div class="line">112      18867  0.5  0.4 1546620 596552 ?      Sl   Jun01  45:48 /usr/java/jdk1.7.0_67-cloudera/bin/java -cp /var/run/cloudera-scm-agent/process/47146-zookeeper-server:/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/zookeeper/lib/log4j.jar:/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/zookeeper/build/*:/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/zookeeper/build/lib/*:/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/zookeeper/*:/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/zookeeper/lib/*:/usr/share/cmf/lib/plugins/tt-instrumentation-5.10.0.jar:/usr/share/cmf/lib/plugins/event-publish-5.10.0-shaded.jar -Djava.net.preferIPv4Stack=true -Dzookeeper.log.file=zookeeper-cmf-zookeeper2-SERVER-ddp-hb-178.cmdmp.com.log -Dzookeeper.log.dir=/var/log/zookeeper -Dcom.sun.management.jmxremote.port=9010 -Dcom.sun.management.jmxremote.rmi.port=9010 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false -Djute.maxbuffer=4194304 -Dzookeeper.datadir.autocreate=false -Xms1073741824 -Xmx1073741824 -XX:OnOutOfMemoryError=/usr/lib64/cmf/service/common/killparent.sh org.apache.zookeeper.server.quorum.QuorumPeerMain /var/run/cloudera-scm-agent/process/47146-zookeeper-server/zoo.cfg</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Notes/hive impala  培训.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Notes/hive impala  培训.html" itemprop="url">hive impala  培训</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-23T00:00:00+08:00">
                2017-06-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/" itemprop="url" rel="index">
                    <span itemprop="name">CDH</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/Notes/" itemprop="url" rel="index">
                    <span itemprop="name">Notes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>$ADIR is a shortcut that points to the /home/training/training_materials/<br>analyst directory</p>
<p>Click Select files to bring up a file browser. By default, the<br>/home/training/Desktop folder displays. Click the home directory button<br>(training) then navigate to the course data directory:<br>training_materials/analyst/data.</p>
<p>Note the /dualcore directory. Most of your work in this course will be in that<br>directory. Try creating a temporary subdirectory in /dualcore:</p>
<hr>
<p>hive 默认路径warehouse</p>
<p>创建xx表后 会在warehouse下创建xx.db</p>
<p>让hive管理整个结构</p>
<p>partition建议每个分区的数据保证一定的量(不要有很多小数据)</p>
<p>beeline set方法打开partition 参数</p>
<p>orcfile 文件 优于rcfile </p>
<p>impala 推荐使用parquet 文件format<br>CDH 对parquet 支持比较好</p>
<hr>
<p>partition<br>冷数据 热数据 上线流文件兼容性</p>
<p>impala join 大表放在第一个 会</p>
<p>profile impala调优</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Hive/hive create table.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Hive/hive create table.html" itemprop="url">hive create table</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-23T00:00:00+08:00">
                2017-06-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/" itemprop="url" rel="index">
                    <span itemprop="name">CDH</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/Hive/" itemprop="url" rel="index">
                    <span itemprop="name">Hive</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="创建表的语句："><a href="#创建表的语句：" class="headerlink" title="创建表的语句："></a>创建表的语句：</h2><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">Create [EXTERNAL] TABLE [IF NOT EXISTS] table_name </div><div class="line">[(col_name data_type [COMMENT col_comment], ...)] </div><div class="line">[COMMENT table_comment] </div><div class="line">[PARTITIONED BY (col_name data_type [COMMENT col_comment], ...)] </div><div class="line">[CLUSTERED BY (col_name, col_name, ...) [SORTED BY (col_name [ASC|DESC],...)]INTO num_buckets BUCKETS]</div><div class="line">[ROW FORMAT row_format] </div><div class="line">[STORED AS file_format] </div><div class="line">[LOCATION hdfs_path]</div></pre></td></tr></table></figure>
</p>
<p>CREATE TABLE 创建一个指定名字的表。如果相同名字的表已经存在，则抛出异常；用户可以用 IF NOT EXIST 选项来忽略这个异常。<br>EXTERNAL 关键字可以让用户创建一个外部表，在建表的同时指定一个指向实际数据的路径（LOCATION），Hive创建内部表时，会将数据移动到数据仓库指向的路径；若创建外部表，仅记录数据所在的路径，不对数据的位置做任何改变。在删除表的时候，内部表的元数据和数据会被一起删除，而外部表只删除元数据，不删除数据。<br>如果文件数据是纯文本，可以使用 STORED AS TEXTFILE。如果数据需要压缩，使用 STORED AS SEQUENCE 。<br>有分区的表可以在创建的时候使用 PARTITIONED BY 语句。一个表可以拥有一个或者多个分区，每一个分区单独存在一个目录下。而且，表和分区都可以对某个列进行 CLUSTERED BY 操作，将若干个列放入一个桶（bucket）中。也可以利用SORT BY 对数据进行排序。这样可以为特定应用提高性能。</p>
<h3 id="创建普通的表："><a href="#创建普通的表：" class="headerlink" title="创建普通的表："></a>创建普通的表：</h3><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">create table test_table (</div><div class="line">id int,</div><div class="line">name string,</div><div class="line">no int) </div><div class="line">row formatdelimited </div><div class="line">fieldsterminated by &apos;,&apos; </div><div class="line">stored astextfile;//指定了字段的分隔符，hive只支持单个字符的分隔符。hive默认的分隔符是\001</div></pre></td></tr></table></figure>
</p>
<h3 id="创建带有partition的表："><a href="#创建带有partition的表：" class="headerlink" title="创建带有partition的表："></a>创建带有partition的表：</h3><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">create table test_partition (</div><div class="line">id int,</div><div class="line">name string,</div><div class="line">no int)</div><div class="line">partitioned by(dt string) </div><div class="line">row formatdelimited </div><div class="line">fieldsterminated by &apos;,&apos; </div><div class="line">stored astextfile;</div><div class="line">load data local inpath &apos;/home/zhangxin/hive/test_hive.txt&apos; overwrite intotabletest_partition partition (dt=&apos;2012-03-05&apos;);</div></pre></td></tr></table></figure>
</p>
<h3 id="创建带有Bucket的表："><a href="#创建带有Bucket的表：" class="headerlink" title="创建带有Bucket的表："></a>创建带有Bucket的表：</h3><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">create table test_bucket (</div><div class="line">id int,</div><div class="line">name string,</div><div class="line">no int)</div><div class="line">partitioned by(dt string) </div><div class="line">clustered by(id) into 10 buckets --将id这一列分到10个桶中。</div><div class="line">row formatdelimited </div><div class="line">fieldsterminated by &apos;,&apos; </div><div class="line">stored astextfile;</div></pre></td></tr></table></figure>
</p>
<p>关于分桶：对列进行分桶，本质上，在进行reduce的时候，会对列的值进行hash，然后将hash的值放到特定的桶中（有点像distribute by）。<br>注意在写入分桶数据的时候，需要指定：<br><code>sethive.enforce.bucketing=true;</code></p>
<h3 id="创建external表："><a href="#创建external表：" class="headerlink" title="创建external表："></a>创建external表：</h3><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">create external table test_external (</div><div class="line">id int,</div><div class="line">name string,</div><div class="line">no int)</div><div class="line">row formatdelimited </div><div class="line">fieldsterminated by &apos;,&apos; </div><div class="line">location&apos;/home/zhangxin/hive/test_hive.txt&apos;;</div></pre></td></tr></table></figure>
</p>
<h3 id="创建与已知表相同结构的表Like："><a href="#创建与已知表相同结构的表Like：" class="headerlink" title="创建与已知表相同结构的表Like："></a>创建与已知表相同结构的表Like：</h3><p>只复制表的结构，而不复制表的内容。<br><code>create table test_like_table like test_bucket;</code></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/python/Python文件处理.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/python/Python文件处理.html" itemprop="url">Python文件处理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-15T00:00:00+08:00">
                2017-06-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Python文件处理"><a href="#Python文件处理" class="headerlink" title="Python文件处理"></a>Python文件处理</h1><p>文件打开方法: open(name[,mode[buf]])<br>name: 文件路径<br>mode: 打开方式<br>buf: 缓冲buffering大小</p>
<ul>
<li>文件读取方式:<ul>
<li>read([size]):读取文件(读取size个字节,默认读取全部)</li>
<li>readline([size]):读取一行</li>
<li>readlines([size]):读取完文件,返回每一行所组成的列表</li>
</ul>
</li>
<li>文件写入方式:<ul>
<li>write(str):将字符串写入文件</li>
<li>writelines(sequence_of_strings):写多行到文件</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Error/[Linux]lrzsz大文件传输.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Error/[Linux]lrzsz大文件传输.html" itemprop="url">lrzsz大文件传输</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-05T00:00:00+08:00">
                2017-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/" itemprop="url" rel="index">
                    <span itemprop="name">CDH</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/Error/" itemprop="url" rel="index">
                    <span itemprop="name">Error</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>rz、sz命令结合方便的上下传文件，但经过跳板机之后直接rz、sz一个稍大的文件会在上传一部分后退出并显示一堆乱码，这是因为这中间有控制字符的原因。 </p>
<p><strong>解决办法：</strong> 加参数-e忽略控制字符：rz -e和sz -e</p>
<p>rz，sz是Linux/Unix同Windows进行ZModem文件传输的命令行工具。</p>
<p>windows端需要支持ZModem的telnet/ssh客户端（比如SecureCRT），运行命令rz即是接收文件，SecureCRT就会弹出文件选择对话框，选好文件之后关闭对话框，文件就会上传到当前目录。注意：单独用rz会有两个问题：上传中断、上传文件变化（md5不同），解决办法是上传时用rz -be，并且去掉弹出的对话框中“Upload files as ASCII”前的勾选。-a, –ascii -b, –binary ，用binary的方式上传下载，不解释字符为ascii，-e, –escape 强制escape 所有控制字符，比如Ctrl+x，DEL等rar,gif等文件。采用 -b 用binary的方式上传。文件比较大而上传出错的话，采用参数 -e。如果用不带参数的rz命令上传大文件时，常常上传一半就断掉了，很可能是rz以为上传的流中包含某些特殊控制字符，造成rz提前退出</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Notes/介绍.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Notes/介绍.html" itemprop="url">介绍</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-02T00:00:00+08:00">
                2017-06-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/" itemprop="url" rel="index">
                    <span itemprop="name">CDH</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/Notes/" itemprop="url" rel="index">
                    <span itemprop="name">Notes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="host"><a href="#host" class="headerlink" title="host"></a>host</h2><ul>
<li>hostname </li>
<li>ntp </li>
<li>/etc/hosts</li>
<li>cloudera-angent <ul>
<li>服务安装</li>
<li>上报日志</li>
<li>角色状态检查</li>
</ul>
</li>
</ul>
<h2 id="HDFS"><a href="#HDFS" class="headerlink" title="HDFS"></a>HDFS</h2><ul>
<li>本质也是一个文件系统 不过是把单个文件的块大小放大.同时一份数据会备份两次在不同的host上</li>
<li>权限 <ul>
<li>Sentry HDFS同步 需要解除hive metastroe HA</li>
<li>同时需要开启ACL权限认证</li>
</ul>
</li>
<li>磁盘损坏<ul>
<li>先判断该主机的host能否暂停服务</li>
<li>停止该host的所有角色</li>
<li>在DATANODE角色的配置文件里面删除对应挂载分区</li>
<li>启用该host的所有角色</li>
<li>报障 更换硬盘后</li>
</ul>
</li>
<li><p>Balance</p>
<ul>
<li>可以在不同DATANODE节点中做负载均衡</li>
<li>也可以在单个DATANODE上做不同挂载盘的负载均衡</li>
</ul>
</li>
<li><p>NameNode</p>
<ul>
<li>NameNode管理文件系统的命名空间。它维护着文件系统树及整棵树内所有的文件和目录。这些信息以两个文件形式永久保存在本地磁盘上：命名空间镜像文件和编辑日志文件。</li>
<li></li>
</ul>
</li>
<li><p>JournalNode</p>
<ul>
<li>两个NameNode为了数据同步，会通过一组称作JournalNodes的独立进程进行相互通信。当active状态的NameNode的命名空间有任何修改时，会告知大部分的JournalNodes进程。standby状态的NameNode有能力读取JNs中的变更信息，并且一直监控edit log的变化，把变化应用于自己的命名空间。standby可以确保在集群出错时，命名空间状态已经完全同步了。</li>
</ul>
</li>
<li><p>Failover Controller</p>
</li>
<li>Gateway</li>
<li><p>HttpFS</p>
<ul>
<li>httpfs是cloudera公司提供的一个hadoop hdfs的一个http接口，通过WebHDFS REST API 可以对hdfs进行读写等访问</li>
</ul>
</li>
<li><p>kerberos</p>
</li>
</ul>
<h2 id="hive"><a href="#hive" class="headerlink" title="hive"></a>hive</h2><ul>
<li>hive是基于Hadoop的一个数据仓库工具，可以将结构化的数据文件映射为一张数据库表，并提供简单的sql查询功能，可以将sql语句转换为MapReduce任务进行运行。</li>
<li>元数据库用的是两个MySQL</li>
<li><p>HiveServer2 </p>
<ul>
<li>支持sentry</li>
<li>过多连接会导致JVM heap 过大,造成GC时间过长,最后导致该角色拒绝服务</li>
</ul>
</li>
<li><p>Hive cli</p>
<ul>
<li>不支持sentry 不受权限管控 </li>
</ul>
</li>
<li>UDF 自定义函数 <ul>
<li>5.7 以后create function 方式有改动 禁止使用add jar语法<ul>
<li>不写location 默认读取AUX 下也就是 hiverserver2 和 metastore 所在主机上必须创建相同路径且文件保持一致的jar包</li>
<li>写location是读取HDFS上的jar包</li>
</ul>
</li>
</ul>
</li>
<li>Gateway</li>
</ul>
<h2 id="Hue"><a href="#Hue" class="headerlink" title="Hue"></a>Hue</h2><ul>
<li>是一个开源的Apache Hadoop UI系统,最早是由Cloudera Desktop演化而来,由Cloudera贡献给开源社区,它是基于Python Web框架Django实现的。</li>
<li>基于文件浏览器（File Browser）访问HDFS</li>
<li>基于Hive编辑器来开发和运行Hive查询</li>
<li>支持基于Solr进行搜索的应用，并提供可视化的数据视图，以及仪表板（Dashboard）</li>
<li>支持基于Impala的应用进行交互式查询</li>
<li>支持Spark编辑器和仪表板（Dashboard）</li>
<li>支持Pig编辑器，并能够提交脚本任务</li>
<li>支持Oozie编辑器，可以通过仪表板提交和监控Workflow、Coordinator和Bundle</li>
<li>支持HBase浏览器，能够可视化数据、查询数据、修改HBase表</li>
<li>支持Metastore浏览器，可以访问Hive的元数据，以及HCatalog</li>
<li>支持Job浏览器，能够访问MapReduce Job（MR1/MR2-YARN）</li>
<li>支持Job设计器，能够创建MapReduce/Streaming/Java Job</li>
<li>支持Sqoop 2编辑器和仪表板（Dashboard）</li>
<li>支持ZooKeeper浏览器和编辑器</li>
<li>支持MySql、PostGresql、Sqlite和Oracle数据库查询编辑器</li>
</ul>
<h2 id="impala"><a href="#impala" class="headerlink" title="impala"></a>impala</h2><ul>
<li>Impala是Cloudera公司主导开发的新型查询系统，它提供SQL语义，能查询存储在Hadoop的HDFS和HBase中的PB级大数据。已有的Hive系统虽然也提供了SQL语义，但由于Hive底层执行使用的是MapReduce引擎，仍然是一个批处理过程，难以满足查询的交互性。相比之下，Impala的最大特点也是最大卖点就是它的快速。但是不稳定</li>
<li>过度频繁的访问会导致impala daemon 的端口无法正常释放 导致不同host上的端口互相阻塞,导致查询失败</li>
<li>同时没有容错机制,由namenode获取文件路径后,如果该节点文件所在的磁盘损坏但刚刚修复但是,也会导致</li>
<li>Impala不需要把中间结果写入磁盘，省掉了大量的I/O开销。</li>
<li>省掉了MapReduce作业启动的开销。MapReduce启动task的速度很慢（默认每个心跳间隔是3秒钟），Impala直接通过相应的服务进程来进行作业调度，速度快了很多。</li>
<li>Impala完全抛弃了MapReduce这个不太适合做SQL查询的范式，而是像Dremel一样借鉴了MPP并行数据库的思想另起炉灶，因此可做更多的查询优化，从而省掉不必要的shuffle、sort等开销。</li>
<li>通过使用LLVM来统一编译运行时代码，避免了为支持通用编译而带来的不必要开销。</li>
<li>用C++实现，做了很多有针对性的硬件优化，例如使用SSE指令。</li>
<li>使用了支持Data locality的I/O调度机制，尽可能地将数据和计算分配在同一台机器上进行，减少了网络开销</li>
<li>因为公用同一个元数据库,所以hive上对表做了修改后,需要impala在</li>
<li>资源池监控控制不了 refresh 语句</li>
</ul>
<h2 id="Oozie"><a href="#Oozie" class="headerlink" title="Oozie"></a>Oozie</h2><p>-Oozie是一种Java Web应用程序，它运行在Java servlet容器——即Tomcat——中，并使用数据库来存储以下内容:<br>-工作流定义<br>-当前运行的工作流实例，包括实例的状态和变量<br>-Oozie工作流是放置在控制依赖DAG（有向无环图 Direct Acyclic Graph）中的一组动作（例如，Hadoop的Map/Reduce作业、Pig作业等），其中指定了动作执行的顺序。我们会使用hPDL（一种XML流程定义语言）来描述这个图。</p>
<h2 id="Sentry"><a href="#Sentry" class="headerlink" title="Sentry"></a>Sentry</h2><ul>
<li>Sentry Server 用的是元数据库</li>
<li>如果用JDBC的连接的话 需要在sentry SERVER 里配上 sentry.service.admin.group 和sentry.service.allow.connect</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Error/[HUE]Hue隧道访问失效.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Error/[HUE]Hue隧道访问失效.html" itemprop="url">Hue隧道访问失效</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-02T00:00:00+08:00">
                2017-06-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/" itemprop="url" rel="index">
                    <span itemprop="name">CDH</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/Error/" itemprop="url" rel="index">
                    <span itemprop="name">Error</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>判断应该是Django框架中,发送报文的MIME有问题<br><a href="https://github.com/cloudera/hue/commit/34388da14712497b685c6b97497c698e720b1a16" target="_blank" rel="noopener">path地址</a></p>
</blockquote>
<h1 id="HUE通过隧道访问"><a href="#HUE通过隧道访问" class="headerlink" title="HUE通过隧道访问"></a>HUE通过隧道访问</h1><p>HUE通过隧道映射到本地后发现所有的JavaScript文件解析有问题:</p>
<p><code>Refused to execute script from &#39;http://127.0.0.1:18888/static/desktop/js/jquery.tablescroller.038d8a8feae9.js&#39; because its MIME type (&#39;text/x-js&#39;) is not executable, and strict MIME type checking is enabled.</code></p>
<p>问题在于cloudera中Django的配置文件具体在哪,后来终于终于找到了</p>
<h2 id="HUE文件路径"><a href="#HUE文件路径" class="headerlink" title="HUE文件路径:"></a>HUE文件路径:</h2><p><code>/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop</code></p>
<h3 id="desktop-core-src-desktop-middleware-py"><a href="#desktop-core-src-desktop-middleware-py" class="headerlink" title="desktop/core/src/desktop/middleware.py"></a>desktop/core/src/desktop/middleware.py</h3><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line"> import inspect</div><div class="line"> import json</div><div class="line"> import logging</div><div class="line">+import mimetypes</div><div class="line"> import os.path</div><div class="line"> import re</div><div class="line"> import tempfile</div><div class="line">@@ -683,4 +684,22 @@ def process_response(self, request, response):</div><div class="line">     if self.secure_content_security_policy and not &apos;Content-Security-Policy&apos; in response:</div><div class="line">       response[&quot;Content-Security-Policy&quot;] = self.secure_content_security_policy</div><div class="line"> </div><div class="line">-    return response </div><div class="line">+    return response</div><div class="line">+</div><div class="line">+</div><div class="line">+class MimeTypeJSFileFixStreamingMiddleware(object):</div><div class="line">+  &quot;&quot;&quot;</div><div class="line">+  Middleware to detect and fix &quot;.js&quot; mimetype. SLES 11SP4 as example OS which detect js file</div><div class="line">+  as &quot;text/x-js&quot; and if strict X-Content-Type-Options=nosniff is set then browser fails to</div><div class="line">+  execute javascript file.</div><div class="line">+  &quot;&quot;&quot;</div><div class="line">+  def __init__(self):</div><div class="line">+    jsmimetypes = [&apos;application/javascript&apos;, &apos;application/ecmascript&apos;]</div><div class="line">+    if mimetypes.guess_type(&quot;dummy.js&quot;)[0] in jsmimetypes:</div><div class="line">+      LOG.info(&apos;Unloading MimeTypeJSFileFixStreamingMiddleware&apos;)</div><div class="line">+      raise exceptions.MiddlewareNotUsed</div><div class="line">+</div><div class="line">+  def process_response(self, request, response):</div><div class="line">+    if request.path_info.endswith(&apos;.js&apos;):</div><div class="line">+      response[&apos;Content-Type&apos;] = &quot;application/javascript&quot;</div><div class="line">+    return response</div></pre></td></tr></table></figure>
</p>
<h3 id="desktop-core-src-desktop-settings-py"><a href="#desktop-core-src-desktop-settings-py" class="headerlink" title="desktop/core/src/desktop/settings.py"></a>desktop/core/src/desktop/settings.py</h3><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">    &apos;django.middleware.http.ConditionalGetMiddleware&apos;,</div><div class="line">     &apos;axes.middleware.FailedLoginMiddleware&apos;,</div><div class="line">+    &apos;desktop.middleware.MimeTypeJSFileFixStreamingMiddleware&apos;,</div><div class="line"> ]</div><div class="line"> </div><div class="line"> # if os.environ.get(ENV_DESKTOP_DEBUG):</div></pre></td></tr></table></figure>
</p>
<h3 id="cloudera-HUE配置文件路径"><a href="#cloudera-HUE配置文件路径" class="headerlink" title="cloudera HUE配置文件路径"></a>cloudera HUE配置文件路径</h3><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">ddp-cm:~ # vi /opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/</div><div class="line">LICENSE.txt         Makefile.buildvars  Makefile.vars       NOTICE.txt          VERSION             apps/               cloudera/           ext/                </div><div class="line">Makefile            Makefile.sdk        Makefile.vars.priv  README              app.reg             build/              desktop/            tools/              </div><div class="line">ddp-cm:~ # vi /opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/app</div><div class="line">app.reg  apps/    </div><div class="line">ddp-cm:~ # vi /opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/apps/</div><div class="line">Makefile     beeswax/     hbase/       impala/      jobsub/      oozie/       proxy/       search/      spark/       useradmin/   </div><div class="line">about/       filebrowser/ help/        jobbrowser/  metastore/   pig/         rdbms/       security/    sqoop/       zookeeper/   </div><div class="line">ddp-cm:~ # vi /opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/</div><div class="line">Makefile    conf/       core/       desktop.db  libs/       logs/       </div><div class="line">ddp-cm:~ # vi /opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/core/src/desktop</div><div class="line">desktop/          desktop.egg-info/ </div><div class="line">ddp-cm:~ # vi /opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/core/src/desktop/mi</div><div class="line">middleware.py       middleware_test.py  migrations/         </div><div class="line">ddp-cm:~ # cd  /opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/core/src/desktop/</div><div class="line">ddp-cm:/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/core/src/desktop # cp middleware.py middleware.py.bak</div><div class="line">ddp-cm:/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/core/src/desktop # vi middleware.py</div><div class="line">ddp-cm:/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/core/src/desktop # vi settings.py</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Kafka/kafka的相关概念.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Kafka/kafka的相关概念.html" itemprop="url">kafka的相关概念</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-24T00:00:00+08:00">
                2017-05-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kafka/" itemprop="url" rel="index">
                    <span itemprop="name">Kafka</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="kafka的相关概念"><a href="#kafka的相关概念" class="headerlink" title="kafka的相关概念"></a>kafka的相关概念</h2><h3 id="AMPQ协议"><a href="#AMPQ协议" class="headerlink" title="AMPQ协议"></a>AMPQ协议</h3><p>一些基本的概念:</p>
<ul>
<li>消费者(Consumer):从消息队列中请求消息的客户端应用程序</li>
<li>生产者(Producer):向broker发布消息的客户端应用程序</li>
<li>AMQP服务器端(broker):用来接收生产者发送的消息并将这些消息路由给服务器中的队列</li>
</ul>
<h3 id="kafka支持的客户端语言"><a href="#kafka支持的客户端语言" class="headerlink" title="kafka支持的客户端语言"></a>kafka支持的客户端语言</h3><p>支持当前大部分主流语言(变形自己的consumer和producer程序)</p>
<h3 id="kafka架构"><a href="#kafka架构" class="headerlink" title="kafka架构"></a>kafka架构</h3><p>一些基本的概念:</p>
<ul>
<li>主题(Topic):一个主题类似新闻中的体育,娱乐,教育等分类概念,在实际工程中通常一个业务一个主题</li>
<li>分区(Partition):一个topic钟的消息数据按照多个分区组织,分区是kafka消息队列组织的最小单位,一个分区可以看做是一个FIFO的队列</li>
</ul>
<hr>
<h2 id="Zookeeper集群搭建"><a href="#Zookeeper集群搭建" class="headerlink" title="Zookeeper集群搭建"></a>Zookeeper集群搭建</h2><ul>
<li>集群搭建</li>
<li>集群配置参数介绍<ul>
<li>myid文件 和server.myid</li>
<li>zoo.cfg文件</li>
<li>log4j.properties文件</li>
<li>zkEnv.sh和zkServer.sh</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/MySQL/SQL基础.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/MySQL/SQL基础.html" itemprop="url">SQL基础</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-24T00:00:00+08:00">
                2017-05-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MySQL/" itemprop="url" rel="index">
                    <span itemprop="name">MySQL</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="SQL基础"><a href="#SQL基础" class="headerlink" title="SQL基础"></a>SQL基础</h1><ul>
<li>DDL (Data Definition Languages):数据定义语音,这些语句定义了不同的数据段,数据库,表,列,索引等数据库对象.常用的语句关键字主要包括create,drop,alter等;</li>
<li>DML (Data Manipulation Languages): 数据操纵语句,用于添加,删除,更新和查询数据库记录,并检查数据完整性,常用的语句关键字主要包括 insert,delete,update,select等;</li>
<li>DCL (Data Control Language): 数据控制语句,用于控制不同数据段直接的许可和访问级别的语句.这些语句定义了数据库,表,字段,用户的访问权限和安全级别.主要的语句关键字包括grant,revoke<h2 id="DDL"><a href="#DDL" class="headerlink" title="DDL"></a>DDL</h2>对数据库内部的对象进行创建.删除,修改等操作的语音.和DML最大的差别是DML只是对表内部数据操作,而不涉及表的定义,结构的修改,更不涉及其他对象,DDL语句更多地由数据库管理员(DBA)使用<h3 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h3><code>create database test1;</code><h3 id="删除数据库"><a href="#删除数据库" class="headerlink" title="删除数据库"></a>删除数据库</h3><code>drop database test1;</code><br>drop操作语句的结果都显示’0 rows affected’<h3 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h3><code>create table emp(ename varchar(10),hiredate date,sal decimal(10,2),deptno int(2));</code><h4 id="查看表"><a href="#查看表" class="headerlink" title="查看表"></a>查看表</h4><code>desc emp;</code><h4 id="查看创建表的SQL语句"><a href="#查看创建表的SQL语句" class="headerlink" title="查看创建表的SQL语句"></a>查看创建表的SQL语句</h4><code>show create table emp \G;</code><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">MariaDB [test1]&gt; show create table emp \G;</div><div class="line">*************************** 1. row ***************************</div><div class="line">       Table: emp</div><div class="line">Create Table: CREATE TABLE `emp` (</div><div class="line">  `ename` varchar(20) DEFAULT NULL,</div><div class="line">  `hiredate` date DEFAULT NULL,</div><div class="line">  `sal` decimal(10,2) DEFAULT NULL,</div><div class="line">  `deptno` int(2) DEFAULT NULL</div><div class="line">) ENGINE=InnoDB DEFAULT CHARSET=latin1</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">ERROR: No query specified</div></pre></td></tr></table></figure>
</p>
</li>
</ul>
<hr>
<p>除了可以看到表定义以外,还可以看到表的engine(存储引擎)和charset(字符集)等信息.”\G”选项的含义是使得记录能够按照字段竖向排列,以便更好地显示内容较长的记录.</p>
<h3 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h3><p><code>drop table emp;</code></p>
<h3 id="修改表"><a href="#修改表" class="headerlink" title="修改表"></a>修改表</h3><h4 id="1-修改表类型"><a href="#1-修改表类型" class="headerlink" title="1. 修改表类型:"></a>1. 修改表类型:</h4><p><code>ALTER TABLE tablename MODIFY [COLUMN] column_definition [FIRST|AFTER col_name]</code></p>
<p><code>alter table emp modify ename varchar(20);</code></p>
<h4 id="2-增加表字段"><a href="#2-增加表字段" class="headerlink" title="2. 增加表字段:"></a>2. 增加表字段:</h4><p><code>ALTER TABLE tablename ADD [COLUMN] column_definition [FIRST|AFTER col_name]</code></p>
<p><code>alter table emp add [column] age int(3);</code></p>
<h4 id="3-删除表字段"><a href="#3-删除表字段" class="headerlink" title="3. 删除表字段"></a>3. 删除表字段</h4><p><code>ALTER TABLE tablename DROP[COLUMN] column_name</code></p>
<p><code>alter table emp drop [column] age;</code></p>
<h4 id="4-字段改名"><a href="#4-字段改名" class="headerlink" title="4. 字段改名"></a>4. 字段改名</h4><p><code>ALTER TABLE tablename CHANGE [COLUMN] old_col_name column_definition  [FIRST|AFTER col_name]</code></p>
<p><code>alter table emp change age age1 int(4);</code></p>
<p>change和modify都可以修改表的定义,不同的是change后面需要两次列名,不方便,但是change的优点是可以修改列名称,modify则不能.</p>
<h4 id="5-修改字段排列顺序"><a href="#5-修改字段排列顺序" class="headerlink" title="5. 修改字段排列顺序"></a>5. 修改字段排列顺序</h4><p>  前面介绍的极端增加和修改语法(ADD/CHANGE/MODIFY)中,都有一个可选项first|after column name,这个选项可以用来修改字段在表中的位置,ADD增加的新字段默认是加载标的最后位置,而CHANGE/MODIFY 默认不会改变字段的位置.</p>
<p>将新增的字段birth date 加在ename之后:</p>
<p><code>alter table emp add birth date after ename;</code></p>
<p>修改字段age,将他放在最前面:</p>
<p><code>alter table emp modify age int(3) first;</code></p>
<h4 id="6-更改表名"><a href="#6-更改表名" class="headerlink" title="6. 更改表名"></a>6. 更改表名</h4><p><code>ALTER TABLE tablename RENAME [TO] new_tablename</code><br>将<br><code>alter table emp rename emp1</code></p>
<h2 id="DML"><a href="#DML" class="headerlink" title="DML"></a>DML</h2><p>DML操作是指对数据库中表记录的操作,主要包括表记录的插入(insert),更新(update),删除(delete)和查询(select),是开发人员日常使用最为频繁的操作.</p>
<h3 id="插入记录"><a href="#插入记录" class="headerlink" title="插入记录"></a>插入记录</h3><p><code>INSERT INTO tablename(field1,field2,...fieldn) VALUES(value1,value2,...,valuen);</code></p>
<p><code>insert into emp(ename,hiredate,sal,deptno) values(&#39;zzzx1&#39;,&#39;2000-01-01&#39;,&#39;2000&#39;,1);</code></p>
<p><code>insert into dept values(5,&#39;dept5&#39;),(6,&#39;dept6&#39;);</code></p>
<h3 id="更新记录"><a href="#更新记录" class="headerlink" title="更新记录"></a>更新记录</h3><p><code>UPDATE tablename SET field1=value1,field2=value2,...,fieldn=valuen [WHERE CONDITION]</code></p>
<p>将wmp表中ename 为’lisa’的薪水(sal)从3000改为4000:</p>
<p><code>update emp set sal=4000 where ename=&#39;lisa&#39;;</code></p>
<h3 id="删除记录"><a href="#删除记录" class="headerlink" title="删除记录"></a>删除记录</h3><p><code>DELETE FROM tablename [WHERE CONDITION]</code></p>
<p>在MySQL中可以一次删除多个表的数据,</p>
<p><code>DELETE t1,t2,...,tn FROM t1,t2,...tn [WHERE CONDITION]</code></p>
<p>同时删除表emp和dept中deptno为3的记录:</p>
<p><code>delete a,b from emp a,dept b where a.deptno=b.deptno and a.deptno=3;</code></p>
<h3 id="查询记录"><a href="#查询记录" class="headerlink" title="查询记录"></a>查询记录</h3><p><code>SELECT * FROM tablename [WHERE CONDITION]</code></p>
<h4 id="1-查询不重复的记录"><a href="#1-查询不重复的记录" class="headerlink" title="1 查询不重复的记录"></a>1 查询不重复的记录</h4><p><code>select distinct deptno from emp;</code></p>
<h4 id="2-条件查询"><a href="#2-条件查询" class="headerlink" title="2 条件查询"></a>2 条件查询</h4><p><code>select * from emp where deptno=1;</code></p>
<p>上面例子中,where后面的条件是一个字段的=比较,除了=之外,还可以使用&lt;,&gt;,&gt;=,&lt;=,!=等比较运算符;多个条件之间还可以使用<em>or,and</em>等逻辑运算符进行多条件联合查询.</p>
<pre><code>MariaDB [test1]&gt; select * from emp where deptno=1 and sal&lt;3000;
+-------+------------+---------+--------+
| ename | hiredate   | sal     | deptno |
+-------+------------+---------+--------+
| zzx   | 2000-01-01 | 2000.00 |      1 |
+-------+------------+---------+--------+
1 row in set (0.00 sec)


</code></pre><h4 id="排序和限制"><a href="#排序和限制" class="headerlink" title="排序和限制"></a>排序和限制</h4><p>取出按照某个字段进行排序后的记录结果集,用到了数据库的排序操作,用关键字<em>ORDER BY</em>来实现</p>
<p><code>SELECT * FROM tablename [WHERE CONDITION] [ORDER BY field1 [DESC|ASC],field2 [DESC|ASC],...,fieldn[DESC|ASC]]</code></p>
<p>其中DESC和ASC是排序顺序关键字,DESV表示按照字段进行降序排列,ASC则表示升序序列，如果不写此关键字默认是升序排列．ORDER BY 后面可以跟多个不同的排序字段，并且每个排序字段可以有不同的排序顺序．</p>
<p>例如，把emp表中的记录按照工资高低进行显示:</p>
<pre><code>MariaDB [test1]&gt; select * from emp order by sal;
+--------+------------+---------+--------+
| ename  | hiredate   | sal     | deptno |
+--------+------------+---------+--------+
| zzx    | 2000-01-01 | 2000.00 |      1 |
| dony   | 2005-02-05 | 2000.00 |      4 |
| lisa   | 2003-02-01 | 4000.00 |      2 |
| bjguan | 2004-04-02 | 5000.00 |      1 |
+--------+------------+---------+--------+

</code></pre><p>如果排序字段的值一样,则值相同的字段按照第二个排序字段进行排序,依次类推.如果只有一个排序字段,则这些字段相同的记录将会无序排列</p>
<pre><code>MariaDB [test1]&gt; select * from emp order by deptno;
+--------+------------+---------+--------+
| ename  | hiredate   | sal     | deptno |
+--------+------------+---------+--------+
| zzx    | 2000-01-01 | 2000.00 |      1 |
| bjguan | 2004-04-02 | 5000.00 |      1 |
| lisa   | 2003-02-01 | 4000.00 |      2 |
| dony   | 2005-02-05 | 2000.00 |      4 |
+--------+------------+---------+--------+

</code></pre><p>对于deptno相同的前两条记录,如果要按照工资由高到低排序,可以使用以下命令:</p>
<pre><code>MariaDB [test1]&gt; select * from emp order by deptno,sal desc;
+--------+------------+---------+--------+
| ename  | hiredate   | sal     | deptno |
+--------+------------+---------+--------+
| bjguan | 2004-04-02 | 5000.00 |      1 |
| zzx    | 2000-01-01 | 2000.00 |      1 |
| lisa   | 2003-02-01 | 4000.00 |      2 |
| dony   | 2005-02-05 | 2000.00 |      4 |
+--------+------------+---------+--------+

</code></pre><p>对于排序后的记录,如果希望只显示一部分,而不是全部,这时,就可以使用LIMIT关键字来实现</p>
<p><code>SELECT ...[LIMIT offset_start,roe_count]</code></p>
<p>其中<em>offset_start</em>表示记录的起始偏移量,<em>row_count</em>表示显示的行数.在默认情况下,起始偏移量为0,只需要写记录行数就可以,这时实际显示的是前n条记录.例如显示emp表中按照sal排序后的前3条记录:</p>
<pre><code>MariaDB [test1]&gt; select * from emp order by sal limit 3;
+-------+------------+---------+--------+
| ename | hiredate   | sal     | deptno |
+-------+------------+---------+--------+
| zzx   | 2000-01-01 | 2000.00 |      1 |
| dony  | 2005-02-05 | 2000.00 |      4 |
| lisa  | 2003-02-01 | 4000.00 |      2 |
+-------+------------+---------+--------+

</code></pre><p>如果要显示emp表中按照sal排序后从第二条记录开始的3条记录</p>
<pre><code>MariaDB [test1]&gt; select * from emp order by sal limit 1,3;
+--------+------------+---------+--------+
| ename  | hiredate   | sal     | deptno |
+--------+------------+---------+--------+
| dony   | 2005-02-05 | 2000.00 |      4 |
| lisa   | 2003-02-01 | 4000.00 |      2 |
| bjguan | 2004-04-02 | 5000.00 |      1 |
+--------+------------+---------+--------+

</code></pre><h4 id="聚合"><a href="#聚合" class="headerlink" title="聚合"></a>聚合</h4><p><code>SELECT [field1,field2,...,fieldn] fun_name FROM tablename [WHERE where_contition] [GROUP BY field1,field2,...,fieldn [WITH ROLLUP]][HAVING where_contition]</code></p>
<ul>
<li>fun_name 表示要做的聚合操作,也就是聚合函数,常用的有sum(求和),count(*)(记录数),max(最大值),min(最小值).</li>
<li>GROUP BY 关键字表示要进行分类聚合的字段,比如要按照部门分类统计员工数量,部门就应该写在group by后面.</li>
<li>WITH ROLLUP [可选语法] 表明是否分类聚合后的结果进行在汇总.</li>
<li>HAVING 关键字表示对分类后的结果再进行条件的过滤.</li>
</ul>
<p>having 和 where 的区别在于,having是对聚合后的结果进行条件的过滤,而where实在聚合前就对记录进行过滤,如果逻辑允许,我们尽可能用where先过滤记录,这样因为结果集减小,将对聚合的效率大大提高,最后在根据逻辑看是否用having进行再过滤.</p>
<p>在emp表中统计公司总人数:</p>
<pre><code>MariaDB [test1]&gt; select count(1) from emp;
+----------+
| count(1) |
+----------+
|        4 |
+----------+

</code></pre><p>在此基础上要统计各个部门人数:</p>
<pre><code>MariaDB [test1]&gt; select deptno,count(1) from emp group by deptno;
+--------+----------+
| deptno | count(1) |
+--------+----------+
|      1 |        2 |
|      2 |        1 |
|      4 |        1 |
+--------+----------+

</code></pre><p>既要统计各部门人数,又要统计总人数:</p>
<pre><code>MariaDB [test1]&gt; select deptno,count(1) from emp group by deptno with rollup;
+--------+----------+
| deptno | count(1) |
+--------+----------+
|      1 |        2 |
|      2 |        1 |
|      4 |        1 |
|   NULL |        4 |
+--------+----------+


</code></pre><p>统计人数大于1的部门:</p>
<pre><code>MariaDB [test1]&gt; select deptno,count(1) from  emp group by deptno having count(1)&gt;1;
+--------+----------+
| deptno | count(1) |
+--------+----------+
|      1 |        2 |
+--------+----------+

</code></pre><p>统计公司所有员工的薪水总额,最高和最低薪水:</p>
<pre><code>MariaDB [test1]&gt; select sum(sal),max(sal),min(sal) from emp;
+----------+----------+----------+
| sum(sal) | max(sal) | min(sal) |
+----------+----------+----------+
| 13000.00 |  5000.00 |  2000.00 |
+----------+----------+----------+

</code></pre><h3 id="表连接"><a href="#表连接" class="headerlink" title="表连接"></a>表连接</h3><p>当需要同时显示多个表中的字段时,就可以用表连接来实现这样的功能.从大类上分,表连接分为内连接和外连接,他们之间的最主要区别是,内连接仅选出两张表中互相匹配的记录,而外连接胡选出其他不匹配的记录.我们最常用的是内连接.</p>
<p>查询出所有雇员的名字和所在部门名称,因为雇员名称和部门分别存放在表emp和dept中,因此,需要使用表连接来查询:</p>
<pre><code>MariaDB [test1]&gt; select ename,deptname from emp,dept where emp.deptno=dept.deptno;
+--------+----------+
| ename  | deptname |
+--------+----------+
| zzx    | tech     |
| lisa   | sale     |
| bjguan | tech     |
| dony   | hr       |
+--------+----------+


</code></pre><p>外连接又分为<strong>左连接</strong>和<strong>右连接</strong></p>
<ul>
<li>左连接:包含所有的左边表中的记录甚至是右边表中没有和它匹配的记录;</li>
<li><p>右连接:包含所有的右边表中的记录甚至是左边表中没有和它匹配的记录;<br>查询emp中所有用户名和所在部门名称:</p>
<pre><code>MariaDB [test1]&gt; select ename,deptname from emp left join dept on emp.deptno=dept.deptno;
+--------+----------+
| ename  | deptname |
+--------+----------+
| zzx    | tech     |
| bjguan | tech     |
| lisa   | sale     |
| dzshen | hr       |
| dony   | NULL     |
+--------+----------+

MariaDB [test1]&gt; select ename,deptname from dept right join emp on dept.deptno=emp.deptno;
+--------+----------+
| ename  | deptname |
+--------+----------+
| zzx    | tech     |
| bjguan | tech     |
| lisa   | sale     |
| dzshen | hr       |
| dony   | NULL     |
+--------+----------+

</code></pre><p>比较这个查询和上例中的查询,都是查询用户名和部门名,两者的区别在于本例中列出来所有的用户名,即使有的用户名(dony)并不存在合法的部门名称;而上例中仅仅列出了存在合法部门的用户名和部门名称.</p>
<h4 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h4><p>某些情况下,当进行查询的时候,需要的条件是另外一个select语句的结果,这个时候就要用到子查询.用于子查询的关键字主要包括in,not in,=,!=,exitst,not exists等.</p>
<pre><code>MariaDB [test1]&gt; select * from emp where deptno in(select deptno from dept);
+--------+------------+---------+--------+
| ename  | hiredate   | sal     | deptno |
+--------+------------+---------+--------+
| zzx    | 2000-01-01 | 2000.00 |      1 |
| lisa   | 2003-02-01 | 4000.00 |      2 |
| bjguan | 2004-04-02 | 5000.00 |      1 |
| dzshen | 2005-04-01 | 4000.00 |      3 |
+--------+------------+---------+--------+

</code></pre><p>如果子查询记录数唯一,还可以用=代替in:</p>
<pre><code>MariaDB [test1]&gt; select * from emp where deptno = (select deptno from dept limit 1);
+--------+------------+---------+--------+
| ename  | hiredate   | sal     | deptno |
+--------+------------+---------+--------+
| zzx    | 2000-01-01 | 2000.00 |      1 |
| bjguan | 2004-04-02 | 5000.00 |      1 |
+--------+------------+---------+--------+

</code></pre><p>某些情况下子查询可以转化(等效)为表连接,</p>
<pre><code>MariaDB [test1]&gt; select * from emp where deptno in(select deptno from dept);
+--------+------------+---------+--------+
| ename  | hiredate   | sal     | deptno |
+--------+------------+---------+--------+
| zzx    | 2000-01-01 | 2000.00 |      1 |
| lisa   | 2003-02-01 | 4000.00 |      2 |
| bjguan | 2004-04-02 | 5000.00 |      1 |
| dzshen | 2005-04-01 | 4000.00 |      3 |
+--------+------------+---------+--------+

</code></pre><p>转化为表连接后:</p>
<pre><code>MariaDB [test1]&gt; select emp.* from emp,dept where emp.deptno=dept.deptno;
+--------+------------+---------+--------+
| ename  | hiredate   | sal     | deptno |
+--------+------------+---------+--------+
| zzx    | 2000-01-01 | 2000.00 |      1 |
| lisa   | 2003-02-01 | 4000.00 |      2 |
| bjguan | 2004-04-02 | 5000.00 |      1 |
| dzshen | 2005-04-01 | 4000.00 |      3 |
+--------+------------+---------+--------+

</code></pre><p>子查询和表连接之间的转换主要应用在两个方面</p>
</li>
<li>MySQL 4.1 以前的版本不支持子查询,需要用表连接来实现子查询的功能</li>
<li>表连接在很多情况下用于优化子查询</li>
</ul>
<h4 id="记录联合"><a href="#记录联合" class="headerlink" title="记录联合"></a>记录联合</h4><p>将两个表的数据按照一定的查询条件查询出来后,将结果合并到一起显示出来,这个时候就需要union和union all 关键字来实现这样的功能</p>
<p><code>SELECT * FROM t1  UNION|UNION ALL  SELECT * FROM t2 ...UNION|UNION ALL SELECT * FROM tn;</code></p>
<pre><code>MariaDB [test1]&gt; select deptno from emp
    -&gt; union all
    -&gt; select deptno from dept;
+--------+
| deptno |
+--------+
|      1 |
|      2 |
|      1 |
|      4 |
|      3 |
|      1 |
|      2 |
|      3 |
|      5 |
+--------+

</code></pre><p>将结果去掉重复记录后显示如下:</p>
<pre><code>MariaDB [test1]&gt; select deptno from emp union  select deptno from dept;
+--------+
| deptno |
+--------+
|      1 |
|      2 |
|      4 |
|      3 |
|      5 |
+--------+


</code></pre><h2 id="DCL"><a href="#DCL" class="headerlink" title="DCL"></a>DCL</h2><p>DCL主要是DBA用来管理系统中的对象权限时使用</p>
<p>创建一个数据库用户z1,具有对sakila数据库中所有表的SELECT/INSERT权限:</p>
<pre><code>MariaDB [test1]&gt; grant select,insert on sakila.* to &apos;z1&apos;@&apos;localhost&apos; identified by &apos;123&apos;;
Query OK, 0 rows affected (0.00 sec)

MariaDB [test1]&gt; exit
Bye
[root@CentOS3 bin]# mysql -uz1 -p


</code></pre><p>收回z1,INSERT,只能对数据进行SELECT操作:</p>
<pre><code>MariaDB [(none)]&gt; revoke insert on sakila.* from &apos;z1&apos;@&apos;localhost&apos;;
Query OK, 0 rows affected (0.00 sec)



</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Error/[Linux]磁盘inode满导致数据无法写入.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Error/[Linux]磁盘inode满导致数据无法写入.html" itemprop="url">磁盘inode满导致数据无法写入</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-24T00:00:00+08:00">
                2017-05-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/" itemprop="url" rel="index">
                    <span itemprop="name">CDH</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/Error/" itemprop="url" rel="index">
                    <span itemprop="name">Error</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="磁盘inode满导致数据无法写入"><a href="#磁盘inode满导致数据无法写入" class="headerlink" title="磁盘inode满导致数据无法写入"></a>磁盘inode满导致数据无法写入</h1><p>BDI的一个工作节点,报错数据没有空间写入,但是通过命令df查看磁盘空间还有剩余,当前目录文件数目也没有超过最大限制,<br>最后发现是分区inode满了导致</p>
<p>同时bdi的调度,虽然服务停止了之前的调度任务被分配到该节点的话就不会自动选择其他正常工作的节点了<br><a href="https://www.ibm.com/developerworks/cn/aix/library/au-speakingunix14/" target="_blank" rel="noopener">参考文档</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/8/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/10/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Nameless13" />
          <p class="site-author-name" itemprop="name">Nameless13</p>
           
              <p class="site-description motion-element" itemprop="description">90后，桶装水保洁工程狮，ಥ_ಥ</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">164</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">33</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        

      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Nameless13</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
