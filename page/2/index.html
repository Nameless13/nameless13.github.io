<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: 'J3OX6892F7',
      apiKey: '38852eb9095216f8f2ada575a06a9cfc',
      indexName: 'Blog',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
<meta property="og:type" content="website">
<meta property="og:title" content="Nameless13">
<meta property="og:url" content="https://nameless13.github.io/page/2/index.html">
<meta property="og:site_name" content="Nameless13">
<meta property="og:description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Nameless13">
<meta name="twitter:description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">






  <link rel="canonical" href="https://nameless13.github.io/page/2/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Nameless13</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Nameless13</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Kerberos MIT/kt_renewer.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Kerberos MIT/kt_renewer.html" itemprop="url">
                  kt_renewer
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 10:31:24 / 修改时间：23:12:06" itemprop="dateCreated datePublished" datetime="2018-05-23T10:31:24+08:00">2018-05-23</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Kerberos-MIT/" itemprop="url" rel="index"><span itemprop="name">Kerberos MIT</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="HUE-kt-renewer"><a href="#HUE-kt-renewer" class="headerlink" title="HUE kt_renewer"></a>HUE kt_renewer</h1><p>[29/Jul/2017 17:04:21 ] kt_renewer   INFO     Reinitting kerberos from keytab: /usr/bin/kinit -k -t /var/run/cloudera-scm-agent/process/56353-hue-KT_RENEWER/hue.keytab -c /tmp/hue_krb5_ccache hue/ddp-dn-062.cmdmp.com@CMDMP.COM<br>[29/Jul/2017 18:04:21 ] kt_renewer   INFO     Reinitting kerberos from keytab: /usr/bin/kinit -k -t /var/run/cloudera-scm-agent/process/56353-hue-KT_RENEWER/hue.keytab -c /tmp/hue_krb5_ccache hue/ddp-dn-062.cmdmp.com@CMDMP.COM</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Installation/操作系统镜像初始化(openstack).html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Installation/操作系统镜像初始化(openstack).html" itemprop="url">
                  操作系统镜像初始化(openstack)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:35" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">2018-05-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-05-29 23:19:59" itemprop="dateModified" datetime="2018-05-29T23:19:59+08:00">2018-05-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Installation/" itemprop="url" rel="index"><span itemprop="name">Installation</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="资源池环境搭建"><a href="#资源池环境搭建" class="headerlink" title="资源池环境搭建"></a>资源池环境搭建</h1><blockquote>
<p>Nameless13</p>
</blockquote>
<h2 id="操作系统配置准备"><a href="#操作系统配置准备" class="headerlink" title="操作系统配置准备"></a>操作系统配置准备</h2><ol>
<li><p>建议对操作系统盘做RAID1[无法满足]</p>
</li>
<li><p>需要配置OS的repository，以便yum可以访问OS镜像[需要 createrepo httpd postgresql91 python-psycopg2 ]</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">Usage: Local YUM  [Adept for RHEL/CentOS]</div><div class="line"></div><div class="line">1. Backup repository. </div><div class="line">find /etc/yum.repos.d/ -name &quot;*.repo&quot; -exec mv &#123;&#125; &#123;&#125;.bak \; </div><div class="line"></div><div class="line">2. Install </div><div class="line">For CentOS6/RHEL6: rpm -ivh --force --nodeps http://10.200.40.49/pub/centos-release-el6.noarch.rpm</div><div class="line">For CentOS7/RHEL7: rpm -ivh --force --nodeps http://10.200.40.49/pub/centos-release-el7.noarch.rpm</div><div class="line"></div><div class="line">3. Update cache </div><div class="line">yum clean all</div><div class="line">yum makecache</div><div class="line"></div><div class="line"></div><div class="line"># Description</div><div class="line"></div><div class="line">系统安全加固:     curl -s http://10.200.40.49/pub/install | bash </div><div class="line">SA安装:   curl -s http://10.200.40.49/pub/sa | bash </div><div class="line">YUM源配置:     curl -s http://10.200.40.49/pub/yum | bash </div><div class="line">OpenSSH升级:  curl -s http://10.200.40.49/pub/ssh7.5 | bash</div></pre></td></tr></table></figure>
</p>
</li>
<li><p>配置静态IP地址[无法满足,DHCP]</p>
</li>
<li><p>需要所有主机/etc/hosts内容一致确保静态DNS解析[相互包含]<br>由于hostname会<br>hostname规范 </p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">nm-1   10.150.4.88     10.151.0.185    mysql,hive metastore</div><div class="line">nm-2   10.150.4.96     10.151.0.193    mysql,hive metastore</div><div class="line">nm-3   10.150.4.97     10.151.0.194    [namenode,failover controller,HttpFS,JobHistory Server],ResourceManager</div><div class="line">nm-4   10.150.4.98     10.151.0.195    [namenode,failover controller,HttpFS],ResourceManager</div><div class="line">nm-5   10.150.4.90     10.151.0.187    spark1 history server,(NodeManager)</div><div class="line">nm-6   10.150.4.92     10.151.0.189    impala catalog server,impala statestore,(NodeManager)</div><div class="line">nm-7   10.150.4.89     10.151.0.186    [hue,kerberos ticket renewer],sqoop,ooize,hiveserver2</div><div class="line">nm-8   10.150.4.95     10.151.0.192    spark2 history server,(NodeManager)</div><div class="line">nm-9   10.150.4.94     10.151.0.191    [DataNode],(NodeManager,impala deamon)</div><div class="line">nm-10  10.150.4.93     10.151.0.190    [DataNode],(NodeManager,impala deamon)</div><div class="line">nm-11  10.150.4.86     10.151.0.183    [DataNode],(NodeManager,impala deamon)</div><div class="line">zk-1   10.150.4.85     10.151.0.182    Zookeeper,kerberos server,(NodeManager)</div><div class="line">zk-2   10.150.4.84     10.151.0.181    Zookeeper,kerberos server,(NodeManager) </div><div class="line">zk-3   10.150.4.83     10.151.0.180    Zookeeper,(NodeManager)</div><div class="line">sj-cm  10.150.4.81     10.151.0.147    cm,sentry,haproxy,(NodeManager)</div></pre></td></tr></table></figure>
</p>
</li>
<li><p>需要使用root用户 或者无密码使用sudo权限的其他用户[uid必须保持一致]</p>
</li>
<li><p>关闭并禁用iptables[无需操作]<br>提供的KVM Centos7 的镜像源默认没有开启防火墙</p>
</li>
<li><p>关闭SELinux<br><code>echo &quot;SELINUX=disabled&quot; &gt; /etc/sysconfig/selinux;</code></p>
</li>
<li><p>重启网络服务，并初始化网络[无需操作]<br>由于网络由openstack那边配好所以不需要    <code>/etc/init.d/network restart</code></p>
</li>
<li><p>修改transparent_hugepage参数，这一参数默认值可能会导致CDH性能下降<br><code>echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled</code><br><code>echo never &gt; /sys/kernel/mm/transparent_hugepage/defrag</code><br>同时确保开机自动关闭transparent_hugepage<br><code>vi /etc/rc.d/rc.local</code></p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line"># THIS FILE IS ADDED FOR COMPATIBILITY PURPOSES</div><div class="line">#</div><div class="line"># It is highly advisable to create own systemd services or udev rules</div><div class="line"># to run scripts during boot instead of using this file.</div><div class="line">#</div><div class="line"># In contrast to previous versions due to parallel execution during boot</div><div class="line"># this script will NOT be run after all other services.</div><div class="line">#</div><div class="line"># Please note that you must run &apos;chmod +x /etc/rc.d/rc.local&apos; to ensure</div><div class="line"># that this script will be executed during boot.</div><div class="line"></div><div class="line">touch /var/lock/subsys/local</div><div class="line"></div><div class="line">if test -f /sys/kernel/mm/transparent_hugepage/enabled; then</div><div class="line">echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled</div><div class="line">fi</div><div class="line">if test -f /sys/kernel/mm/transparent_hugepage/defrag; then</div><div class="line">echo never &gt; /sys/kernel/mm/transparent_hugepage/defrag</div><div class="line">fi</div></pre></td></tr></table></figure>
</p>
<p>最后给rc.local赋予执行权限 <code>chmod +x /etc/rc.d/rc.local</code></p>
</li>
<li><p>禁用交换内存<br><code>vi /etc/sysctl.conf</code><br>增加一行：vm.swappiness=0<br><code>sudo sysctl vm.swappiness=0</code></p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">echo 0 &gt;/proc/sys/vm/swappiness</div><div class="line">echo &apos;vm.swappiness=0&apos;&gt;&gt; /etc/sysctl.conf</div><div class="line">cat /proc/sys/vm/swappiness</div></pre></td></tr></table></figure>
</p>
</li>
<li><p>修改/etc/security/limits.conf或者在/etc/security/limits.d下增加相应的配置文件 </p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">* soft noproc 11000</div><div class="line">* hard noproc 11000</div><div class="line">* soft nofile 65535</div><div class="line">* hard nofile 65535</div></pre></td></tr></table></figure>
</p>
</li>
<li><p>需要统一开启ntp服务,并且开机启动<br>在集群中选择一台机器作为ntp服务器，剩余的作为ntp客户端。所有客户端时间与ntp服务器保持同步。<br><code>vi /etc/ntp.conf</code><br>ntp同步ip地址和鹏博士的保持一致:<br>server 64.113.32.5<br>server 216.229.0.179</p>
<p>systemctl start ntpd.service<br>systemctl enable ntpd.service</p>
<p>[root@nm-2 ~]# ntpq -p</p>
<pre><code>remote           refid      st t when poll reach   delay   offset  jitter

</code></pre><p>==============================================================================<br> nist.netservice .ACTS.           1 u    7   64    1  238.736   -7.477   0.000<br> nist1-lnk.binar .ACTS.           1 u    6   64    1  234.281   -6.177   0.000</p>
<p>systemctl disable chronyd 会影响ntp服务的开机启动所以禁用掉了</p>
</li>
</ol>
<ol>
<li><p>同时配置spark2.2需要java8环境+特定的jce包<br>JAVA_HOME=/usr/java/jdk1.8.0_144/<br>创建JDBC存放目录<code>mkdir -p /usr/share/java/</code><br>同时替换为cdh的jce</p>
</li>
<li><p>配置路由连通鹏博士IDC以及Ceph的RGW<br>route add -net 10.200.0.0/16 gw 10.151.0.1<br>route add -net 10.125.137.0/24 gw 10.151.0.1<br>(删除路由 route del -net 10.125.137.0/24 gw 10.150.4.1<br>显示路由 netstat -rn)    </p>
</li>
<li><p>disable ipv6,同时需要配置4个网卡<br>ifcfg-eth1、ifcfg-ens5、ifcfg-ens6，这几个文件的内容与ifcfg-eth0一样，只是里面的device名字不同，取-后面的</p>
</li>
<li><p>RHEL 7 &amp; CentOS 7禁用IPV6<br><a href="http://blog.csdn.net/bluishglc/article/details/41390785" target="_blank" rel="noopener">http://blog.csdn.net/bluishglc/article/details/41390785</a></p>
</li>
<li><p>准备jdbc连接mysql的jar包<br>[root@sj-cm ~]# scp /usr/share/java/mysql-connector-java-5.1.38-bin.jar 10.150.4.89:/usr/share/java/<br>[root@nm-7 ~]# mkdir /usr/share/java<br>[root@nm-7 ~]# ln -s /usr/share/java/mysql-connector-java-5.1.38-bin.jar /usr/share/java/mysql-connector-java.jar</p>
</li>
<li><p>检查文件完整性</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[root@cm cdh5.13]# ll</div><div class="line">total 1889332</div><div class="line">-rw-r--r-- 1 root root 1934590563 Oct 18 16:13 CDH-5.13.0-1.cdh5.13.0.p0.29-el7.parcel</div><div class="line">-rw-r--r-- 1 root root         41 Oct 18 16:13 CDH-5.13.0-1.cdh5.13.0.p0.29-el7.parcel.sha1</div><div class="line">-rw-r--r-- 1 root root      74072 Oct 18 16:13 manifest.json</div><div class="line">[root@cm cdh5.13]# sha1sum CDH-5.13.0-1.cdh5.13.0.p0.29-el7.parcel</div><div class="line">bef6f3f074e0a88cd79d6d37abc6698471e3d279  CDH-5.13.0-1.cdh5.13.0.p0.29-el7.parcel</div><div class="line">[root@cm cdh5.13]# cat CDH-5.13.0-1.cdh5.13.0.p0.29-el7.parcel.sha1 </div><div class="line">bef6f3f074e0a88cd79d6d37abc6698471e3d279</div></pre></td></tr></table></figure>
</p>
</li>
<li><p>route配置</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[root@tddp-zk-2 ~]# route</div><div class="line">Kernel IP routing table</div><div class="line">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</div><div class="line">default         host-10-150-4-1 0.0.0.0         UG    0      0        0 eth1</div><div class="line">10.125.137.0    .               255.255.255.0   UG    0      0        0 ens6</div><div class="line">10.150.4.0      0.0.0.0         255.255.255.0   U     0      0        0 eth1</div><div class="line">10.151.0.0      0.0.0.0         255.255.252.0   U     0      0        0 ens6</div><div class="line">10.200.0.0      .               255.255.0.0     UG    0      0        0 ens6</div><div class="line">169.254.169.254 host-10-150-4-4 255.255.255.255 UGH   0      0        0 eth1</div></pre></td></tr></table></figure>
</p>
</li>
</ol>
<h3 id="节点配置"><a href="#节点配置" class="headerlink" title="节点配置"></a>节点配置</h3><p>CPU    8<br>Memory    64GB<br>Disk    100G<br>Network    2*10Gbits，主备模式绑定</p>
<hr>
<h2 id="mysql-主从配置"><a href="#mysql-主从配置" class="headerlink" title="mysql 主从配置"></a>mysql 主从配置</h2><p>yum install -y wget<br>wget <a href="http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm" target="_blank" rel="noopener">http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm</a><br>sudo rpm -ivh mysql-community-release-el7-5.noarch.rpm<br>yum -y update<br>sudo yum install -y mysql-server<br>sudo systemctl start mysqld<br>sudo /usr/bin/mysql_secure_installation</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">CREATE USER &apos;hive&apos;@&apos;%&apos; IDENTIFIED BY &apos;Cloudera@123&apos;;</div><div class="line">create database metastore_test default character set utf8;</div><div class="line">GRANT ALL PRIVILEGES ON metastore_test. * TO &apos;hive&apos;@&apos;%&apos;;</div><div class="line"></div><div class="line">create user &apos;amon&apos;@&apos;%&apos; identified by &apos;Cloudera@123&apos;</div><div class="line">create database amon_test default character set utf8;</div><div class="line">grant all privileges on amon_test.* to &apos;amon&apos;@&apos;%&apos;;</div><div class="line"></div><div class="line">create user &apos;rman&apos;@&apos;%&apos; identified by &apos;Cloudera@123&apos;;</div><div class="line">create database rman_test default character set utf8;</div><div class="line">grant all privileges on rman_test.* to &apos;rman&apos;@&apos;%&apos;;</div><div class="line"></div><div class="line">create user &apos;sentry&apos;@&apos;%&apos; identified by &apos;Cloudera@123&apos;;</div><div class="line">create database sentry_test default character set utf8;</div><div class="line">grant all privileges on sentry_test.* to &apos;sentry&apos;@&apos;%&apos;;</div><div class="line"></div><div class="line">create user &apos;nav&apos;@&apos;%&apos; identified by &apos;Cloudera@123&apos;;</div><div class="line">create database nav_test default character set utf8;</div><div class="line">grant all privileges on nav_test.* to &apos;nav&apos;@&apos;%&apos;;</div><div class="line"></div><div class="line">create user &apos;navms&apos;@&apos;%&apos; identified by &apos;Cloudera@123&apos;;</div><div class="line">create database navms_test default character set utf8;</div><div class="line">grant all privileges on navms_test.* to &apos;navms&apos;@&apos;%&apos;;</div><div class="line"></div><div class="line">create user &apos;cm&apos;@&apos;%&apos; identified by &apos;Cloudera@123&apos;;</div><div class="line">create database cm_test default character set utf8;</div><div class="line">grant all privileges on cm_test.* to &apos;cm&apos;@&apos;%&apos;;</div><div class="line"></div><div class="line">CREATE USER &apos;hue&apos;@&apos;%&apos; IDENTIFIED BY &apos;Cloudera@123&apos;; </div><div class="line">create database hue_test default character set utf8;</div><div class="line">GRANT ALL PRIVILEGES ON hue_test.* TO &apos;hue&apos;@&apos;%&apos;; </div><div class="line"></div><div class="line">CREATE USER &apos;oozie&apos;@&apos;%&apos; IDENTIFIED BY &apos;Cloudera@123&apos;; </div><div class="line">create database oozie_test default character set utf8;</div><div class="line">GRANT ALL PRIVILEGES ON oozie_test.* TO &apos;oozie&apos;@&apos;%&apos;; </div><div class="line">FLUSH PRIVILEGES;</div></pre></td></tr></table></figure>
</p>
<p>[root@nm-1 ~]# vi /etc/my.cnf<br>log-bin=mysql-bin<br>server-id=88<br>binlog_format=MIXED<br>[root@nm-2 ~]# vi /etc/my.cnf</p>
<p>[root@nm-1 ~]# systemctl restart mysqld</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">在Master(172.31.10.118) 主MySQL上创建一个mysnc用户</div><div class="line">用户名：mysync   密码：mysync</div><div class="line">GRANT REPLICATION SLAVE ON *.* TO &apos;mysync&apos;@&apos;%&apos;;</div><div class="line">FLUSH PRIVILEGES;</div></pre></td></tr></table></figure>
</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">CREATE USER &apos;mysync&apos;@&apos;%&apos; IDENTIFIED BY &apos;Cloudera@123&apos;;</div><div class="line">change master to</div><div class="line">master_host=&apos;10.150.4.88&apos;,</div><div class="line">master_user=&apos;mysync&apos;,</div><div class="line">master_password=&apos;mysync&apos;,</div><div class="line">master_log_file=&apos;mysql-bin.000001&apos;,</div><div class="line">master_log_pos=987;</div></pre></td></tr></table></figure>
</p>
<h2 id="CDH软件下载与配置（Cloudera管理器节点）"><a href="#CDH软件下载与配置（Cloudera管理器节点）" class="headerlink" title="CDH软件下载与配置（Cloudera管理器节点）"></a>CDH软件下载与配置（Cloudera管理器节点）</h2><ol>
<li>下载Cloudera管理器需要的rpm包</li>
<li>下载Parcel包（包含了CDH中的Hadoop组件）</li>
<li><p>创建repo文件以支持本地yum的操作</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[root@cm 5.13.0]# pwd</div><div class="line">/var/www/html/cloudera/cm5/redhat/7/5.13.0</div><div class="line">[root@cm 5.13.0]# ll</div><div class="line">total 1101380</div><div class="line">-rw-r--r-- 1 root root   9787192 Oct 18 16:10 cloudera-manager-agent-5.13.0-1.cm5130.p0.55.el7.x86_64.rpm</div><div class="line">-rw-r--r-- 1 root root 699978252 Oct 18 16:10 cloudera-manager-daemons-5.13.0-1.cm5130.p0.55.el7.x86_64.rpm</div><div class="line">-rw-r--r-- 1 root root      8716 Oct 18 16:10 cloudera-manager-server-5.13.0-1.cm5130.p0.55.el7.x86_64.rpm</div><div class="line">-rw-r--r-- 1 root root     10604 Oct 18 16:10 cloudera-manager-server-db-2-5.13.0-1.cm5130.p0.55.el7.x86_64.rpm</div><div class="line">-rw-r--r-- 1 root root  30604232 Oct 18 16:10 enterprise-debuginfo-5.13.0-1.cm5130.p0.55.el7.x86_64.rpm</div><div class="line">-rw-r--r-- 1 root root  71204325 Oct 18 16:10 jdk-6u31-linux-amd64.rpm</div><div class="line">-rw-r--r-- 1 root root 174163338 Oct 19 15:04 jdk-8u151-linux-x64.rpm</div><div class="line">-rw-r--r-- 1 root root 142039186 Oct 18 16:10 oracle-j2sdk1.7-1.7.0+update67-1.x86_64.rpm</div><div class="line">[root@cm 5.13.0]# createrepo .</div><div class="line">Spawning worker 0 with 1 pkgs</div><div class="line">Spawning worker 1 with 1 pkgs</div><div class="line">Spawning worker 2 with 1 pkgs</div><div class="line">Spawning worker 3 with 1 pkgs</div><div class="line">Spawning worker 4 with 1 pkgs</div><div class="line">Spawning worker 5 with 1 pkgs</div><div class="line">Spawning worker 6 with 1 pkgs</div><div class="line">Spawning worker 7 with 1 pkgs</div><div class="line">Workers Finished</div><div class="line">Saving Primary metadata</div><div class="line">Saving file lists metadata</div><div class="line">Saving other metadata</div><div class="line">Generating sqlite DBs</div><div class="line">Sqlite DBs complete</div></pre></td></tr></table></figure>
</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[root@cm 5.13.0]# cat /etc/yum.repos.d/cm513.repo </div><div class="line">[cm513]</div><div class="line">name=cm513</div><div class="line">baseurl=http://10.150.4.47/cloudera/cm5/redhat/7/5.13.0/</div><div class="line">enabled=true</div><div class="line">gpgcheck=false</div></pre></td></tr></table></figure>
</p>
</li>
</ol>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[root@sj-cm ~]# mkdir /usr/share/java</div><div class="line">[root@sj-cm ~]# ln -s /usr/share/java/mysql-connector-java-5.1.38-bin.jar /usr/share/java/mysql-connector-java.jar</div></pre></td></tr></table></figure>
</p>
<p>Storage: Use S3 for storage of input data and final output, and use HDFS for storage of intermediate data.<br>Compress all data to improve performance.<br>Avoid small files when defining your partitioning strategy.<br>Use Parquet columnar data format on S3.<br>Impala block size: 256 MB<br>Change S3A to “fs.s3a.block.size” to match block size.<br>For information about configuring Hive ETL jobs to use Amazon S3, see Configuring Transient Hive ETL Jobs to Use the Amazon S3 Filesystem in the Cloudera Enterprise documentation.</p>
<p>rgw地址:</p>
<p>10.125.137.30:8080<br>10.125.137.31:8080<br>10.125.137.32:8080</p>
<p>之后做了haproxy</p>
<p>测试用户信息<br>“user”: “umtest2”,<br>“access_key”: “BBBA74VJ69J8I4N0GW3O”,<br>“secret_key”: “eNKTsutRmHR8HHM03Mx3xT6ctaW3Fd+PX75KGatk”</p>
<p>将所有的数据同步到s3上后 替换Defaultfs</p>
<p>检查 hive spark yarn 以及 mapreduce的使用</p>
<p>启用yarn的ha</p>
<h2 id="CDH-core-xml-配置"><a href="#CDH-core-xml-配置" class="headerlink" title="CDH core.xml 配置"></a>CDH core.xml 配置</h2><p>&lt;property&gt;<br>  &lt;name&gt;fs.s3a.access.key&lt;/name&gt;<br>  &lt;value&gt;BBBA74VJ69J8I4N0GW3O&lt;/value&gt;<br>  &lt;description&gt;AWS access key ID. Omit for Role-based authentication.&lt;/description&gt;<br>&lt;/property&gt;

</p>
<p>&lt;property&gt;<br>  &lt;name&gt;fs.s3a.secret.key&lt;/name&gt;<br>  &lt;value&gt;eNKTsutRmHR8HHM03Mx3xT6ctaW3Fd+PX75KGatk&lt;/value&gt;<br>  &lt;description&gt;AWS secret key&lt;/description&gt;<br>&lt;/property&gt;

</p>
<p>&lt;property&gt;<br>  &lt;name&gt;fs.s3a.endpoint&lt;/name&gt;<br>  &lt;value&gt;10.125.137.200:8000&lt;/value&gt;<br>  &lt;description&gt;AWS S3 endpoint to connect to. An up-to-date list is<br>    provided in the AWS Documentation: regions and endpoints. Without this<br>    property, the standard region (s3.amazonaws.com) is assumed.<br>  &lt;/description&gt;<br>&lt;/property&gt;

</p>
<p>&lt;property&gt;<br>  &lt;name&gt;fs.s3a.connection.ssl.enabled&lt;/name&gt;<br>  &lt;value&gt;false&lt;/value&gt;<br>  &lt;description&gt;Enables or disables SSL connections to S3.&lt;/description&gt;<br>&lt;/property&gt;<br>&lt;property&gt;<br>  &lt;name&gt;fs.defaultFS&lt;/name&gt;<br>  &lt;value&gt;s3a://mybucket/&lt;/value&gt;<br>&lt;/property&gt;


</p>
<p>hadoop fs -ls s3a://migu001/</p>
<hr>
<h2 id="问题记录"><a href="#问题记录" class="headerlink" title="问题记录"></a>问题记录</h2><h4 id="用root账户启动spark报错"><a href="#用root账户启动spark报错" class="headerlink" title="用root账户启动spark报错"></a>用root账户启动spark报错</h4><p>&lt;console&gt;:16: error: not found: value sqlContext<br>         import sqlContext.implicits._<br>                ^</p>
<p>&lt;console&gt;:16: error: not found: value sqlContext<br>         import sqlContext.sql<br>                ^</p>
<p>找不到文件系统上对应jar包导致</p>
<p>需要配上JAVA_HOME gateway</p>
<h4 id="用admin账户登入hue测试创建表报错"><a href="#用admin账户登入hue测试创建表报错" class="headerlink" title="用admin账户登入hue测试创建表报错"></a>用admin账户登入hue测试创建表报错</h4><p>[HiveServer2-Handler-Pool: Thread-35]: unable to return groups for user admin<br>PartialGroupNameException The user name ‘admin’ is not found. id: admin: no such user<br>id: admin: no such user</p>
<p>HUE 通过hive 建表 ddl语句成功却没能见到新建的表,因为使用的是admin用户登入 集群中没有admin用户</p>
<h4 id="Oozie缺少js库"><a href="#Oozie缺少js库" class="headerlink" title="Oozie缺少js库"></a>Oozie缺少js库</h4><p>To enable Oozie web console install the Ext JS library.</p>
<p>需要单独去安装这个js library</p>
<h4 id="hue与s3对接"><a href="#hue与s3对接" class="headerlink" title="hue与s3对接"></a>hue与s3对接</h4><p>由于cloudera的hue,我查了源码后发现他们boto的调用根本没有获取port参数 所以私有s3的访问得首先改ini配置文件使得其在web上能显示,至于调用我是直接修改源码写死在代码里</p>
<p>hue_safety_valve_server.ini 的 Hue Server 高级配置代码段（安全阀）</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[aws]</div><div class="line">[[aws_accounts]]</div><div class="line">[[[default]]]</div><div class="line">#access_key_id_script=&lt;/path/to/access_key_script&gt;</div><div class="line">#secret_access_key_script=&lt;/path/to/secret_key_script&gt;</div><div class="line">#security_token=&lt;your AWS security token&gt;</div><div class="line">allow_environment_credentials=false</div><div class="line">region=&lt;your region, such as us-east-1&gt; </div><div class="line">access_key_id=&lt;your_access_key_id&gt;</div><div class="line">secret_access_key=&lt;your_secret_access_key&gt;</div></pre></td></tr></table></figure>
</p>
<p>CDH5.13版本才有host参数但是依旧没有port<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[aws]</div><div class="line">[[aws_accounts]]</div><div class="line">[[[default]]]</div><div class="line">host=10.125.137.200:8000</div><div class="line">access_key_id=&apos;BBBA74VJ69J8I4N0GW3O&apos;</div><div class="line">secret_access_key=&apos;eNKTsutRmHR8HHM03Mx3xT6ctaW3Fd+PX75KGatk&apos;</div></pre></td></tr></table></figure></p>
<p><a href="https://www.cloudera.com/documentation/enterprise/release-notes/topics/cm_vd_cdh_package_tarball_513.html#cm_vd_cdh_package_tarball_513" target="_blank" rel="noopener">https://www.cloudera.com/documentation/enterprise/release-notes/topics/cm_vd_cdh_package_tarball_513.html#cm_vd_cdh_package_tarball_513</a><br>[HUE-6539] - [aws] Update AWS config check to connect to endpoint and avoid region check<br>[HUE-6515] - [aws] Do not use a default region if not configured, fallback to standard S3 endpoint</p>
<p>Support the new S3 regions<br><a href="https://issues.cloudera.org/browse/HUE-5851" target="_blank" rel="noopener">https://issues.cloudera.org/browse/HUE-5851</a></p>
<p>仅仅只配置了host会报region_name错误,因为他最后还是会去调用region的连接方式,报错如下:</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">S3 filesystem exception.</div><div class="line">Failed to initialize bucket cache: local variable &apos;region_name&apos; referenced before assignment</div><div class="line"></div><div class="line">INFO Configuration.deprecation: fs.s3a.server-side-encryption-key is deprecated. Instead, use fs.s3a.server-side-encryption.key</div></pre></td></tr></table></figure>
</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">S3 filesystem exception.</div><div class="line"></div><div class="line">The AWS Access Key Id you provided does not exist in our records.</div><div class="line"></div><div class="line"> More Info   View Logs </div><div class="line"></div><div class="line">File Name   Line Number Function Name</div><div class="line">/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/apps/filebrowser/src/filebrowser/views.py    188 view</div><div class="line">/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/apps/filebrowser/src/filebrowser/views.py    415 listdir_paged</div><div class="line">/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/core/src/desktop/lib/fs/proxyfs.py   101 do_as_user</div><div class="line">/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/core/src/desktop/lib/fs/proxyfs.py   120 listdir_stats</div><div class="line">/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/libs/aws/src/aws/s3/__init__.py  52  wrapped</div><div class="line">/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/libs/aws/src/aws/s3/s3fs.py  256 listdir_stats</div><div class="line">/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/libs/aws/src/aws/s3/s3fs.py  80  _init_bucket_cache</div></pre></td></tr></table></figure>
</p>
<h4 id="OOZIE-错误"><a href="#OOZIE-错误" class="headerlink" title="OOZIE 错误"></a>OOZIE 错误</h4><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[11/Oct/2017 18:49:38 -0700] middleware   INFO     Processing exception: HTTPConnectionPool(host=&apos;tddp-nm-2&apos;, port=14000): Max retries exceeded with url: /webhdfs/v1/user/hue/oozie/deployments/_%24USER_-oozie-%24JOBID-%24TIME?op=GETFILESTATUS&amp;user.name=hue&amp;doas=hue (Caused by NewConnectionError(&apos;&lt;requests.packages.urllib3.connection.HTTPConnection object at 0x7f42fc0bcd50&gt;: Failed to establish a new connection: [Errno 111] Connection refused&apos;,)): Traceback (most recent call last):</div><div class="line">  File &quot;/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/build/env/lib64/python2.7/site-packages/Django-1.6.10-py2.7.egg/django/core/handlers/base.py&quot;, line 112, in get_response</div><div class="line">    response = wrapped_callback(request, *callback_args, **callback_kwargs)</div><div class="line">  File &quot;/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/build/env/lib64/python2.7/site-packages/Django-1.6.10-py2.7.egg/django/db/transaction.py&quot;, line 371, in inner</div><div class="line">    return func(*args, **kwargs)</div><div class="line">  File &quot;/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/apps/oozie/src/oozie/decorators.py&quot;, line 110, in decorate</div><div class="line">    return view_func(request, *args, **kwargs)</div><div class="line">  File &quot;/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/apps/oozie/src/oozie/views/editor2.py&quot;, line 136, in new_workflow</div><div class="line">    workflow.check_workspace(request.fs, request.user)</div><div class="line">  File &quot;/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/apps/oozie/src/oozie/models2.py&quot;, line 93, in check_workspace</div><div class="line">    create_directories(fs, [REMOTE_SAMPLE_DIR.get()])</div><div class="line">  File &quot;/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/libs/liboozie/src/liboozie/submission2.py&quot;, line 436, in create_directories</div><div class="line">    if not fs.do_as_user(fs.DEFAULT_USER, fs.exists, directory):</div><div class="line">  File &quot;/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/core/src/desktop/lib/fs/proxyfs.py&quot;, line 101, in do_as_user</div><div class="line">    return fn(*args, **kwargs)</div><div class="line">  File &quot;/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/core/src/desktop/lib/fs/proxyfs.py&quot;, line 132, in exists</div><div class="line">    return self._get_fs(path).exists(path)</div><div class="line">  File &quot;/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/libs/hadoop/src/hadoop/fs/webhdfs.py&quot;, line 253, in exists</div><div class="line">    return self._stats(path) is not None</div><div class="line">  File &quot;/opt/cloudera/parcels/CDH-5.10.0-1.cdh5.10.0.p0.41/lib/hue/desktop/libs/hadoop/src/hadoop/fs/webhdfs.py&quot;, line 241, in _stats</div><div class="line">    raise ex</div><div class="line">WebHdfsException: HTTPConnectionPool(host=&apos;tddp-nm-2&apos;, port=14000): Max retries exceeded with url: /webhdfs/v1/user/hue/oozie/deployments/_%24USER_-oozie-%24JOBID-%24TIME?op=GETFILESTATUS&amp;user.name=hue&amp;doas=hue (Caused by NewConnectionError(&apos;&lt;requests.packages.urllib3.connection.HTTPConnection object at 0x7f42fc0bcd50&gt;: Failed to establish a new connection: [Errno 111] Connection refused&apos;,))</div></pre></td></tr></table></figure>
</p>
<p>因为之前HDFS是旧版本的,我是干掉重新拷到s3上面去</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Linux/setfacl提示 Operation not supported.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Linux/setfacl提示 Operation not supported.html" itemprop="url">
                  setfacl提示 Operation not supported
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:35 / 修改时间：23:12:06" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">2018-05-23</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="setfacl提示-Operation-not-supported"><a href="#setfacl提示-Operation-not-supported" class="headerlink" title="setfacl提示 Operation not supported"></a>setfacl提示 Operation not supported</h1><p>问题：/mnt/bak为硬盘的一个分区，在fstab做了defaults挂载，当我需要配置acl权限时</p>
<p>命令为：setfacl -m u:luo:rwx /mnt/bak的时候提示</p>
<p>setfacl: /mnt/bak: Operation not supported 错误</p>
<p>解决方法：重新修改/etc/fstab文件，加入acl选项</p>
<p>/dev/vg/bak             /mnt/bak                ext3    defaults,acl    0 0</p>
<p>然后：mount -o remount /mnt/bak 重新挂载，再执行上面的命令，成功！</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Linux/关于tar解压重命名的问题.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Linux/关于tar解压重命名的问题.html" itemprop="url">
                  关于tar解压重命名的问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:35 / 修改时间：23:12:06" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">2018-05-23</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="关于tar解压重命名的问题"><a href="#关于tar解压重命名的问题" class="headerlink" title="关于tar解压重命名的问题"></a>关于tar解压重命名的问题</h1><h2 id="问题描述："><a href="#问题描述：" class="headerlink" title="问题描述："></a>问题描述：</h2><p><code>wget http://oss.aliyuncs.com/aliyunecs/onekey/mysql/mysql-5.6.15-linux-glibc2.5-i686.tar.gz</code><br>显然下载下来的文件就是：mysql-5.6.15-linux-glibc2.5-i686.tar.gz</p>
<p>有时候这样的文件名不便于shell脚本的自动化操作，在特定条件下你希望将“mysql-5.6.15-linux-glibc2.5-i686.tar.gz” 变为 “mysql-5.6.15.tar.gz”，于是大家都会像下面这样做：</p>
<p><code>wget -O mysql-5.6.15.tar.gz  http://oss.aliyuncs.com/aliyunecs/onekey/mysql/mysql-5.6.15-linux-glibc2.5-i686.tar.gz</code><br>好，现在已经得到了是“mysql-5.6.15.tar.gz”这样的文件名了。但是，接着你将“mysql-5.6.15.tar.gz”解压后就会发现好像不是你想要的，如下：</p>
<p><code>tar -zxvf mysql-5.6.15.tar.gz</code><br>mysql-5.6.15-linux-glibc2.5-i686 （这就是解压后的文件名）</p>
<p>如何保证“mysql-5.6.15.tar.gz”解压后的文件名就是“mysql-5.6.15”呢？</p>
<p>完整解决过程：</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">wget -O mysql-5.6.15.tar.gz  http://oss.aliyuncs.com/aliyunecs/onekey/mysql/mysql-5.6.15-linux-glibc2.5-i686.tar.gz</div><div class="line"></div><div class="line">mkdir ./mysql-5.6.15 &amp;&amp; tar -xzvf mysql-5.6.15.tar.gz -C ./mysql-5.6.15 --strip-components 1</div></pre></td></tr></table></figure>
</p>
<p>这样就得到了“mysql-5.6.15”命名的解压文件。</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Linux/OpenLDAP,AD,Samba,FreeIPA介绍.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Linux/OpenLDAP,AD,Samba,FreeIPA介绍.html" itemprop="url">
                  OpenLDAP,AD,Samba,FreeIPA介绍
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:35 / 修改时间：23:12:06" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">2018-05-23</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>OpenLDAP is a decent product, but it’s really just a bare-bones LDAP server, and something you might integrate into a more complete product or service. For example, even the schemas that it ships with have not changed in a long time and would need to be augmented with at least rfc2307bis. It also doesn’t ship with any management tools. Apache Directory Studio is decent, but quite low-level.</p>
<p>Active Directory is a suite of services that include LDAP and some schemas, but also a Kerberos service, a certificate authority, and a DNS service. The (Windows based) AD user and group management tools are OK, and slightly more convenient than Apache Directory Studio, although they only run on Windows. The integration between everything is very good. Binding Linux machines to AD is pretty simple these days with sssd.</p>
<p>Samba 4 is the open source implementation of Active Directory, and is what Amazon use to power their Active Directory compatible Simple AD service.</p>
<p>FreeIPA is an open source alternative to AD that combines LDAP, Kerberos, CA services and management tools, and ships with its own schemas.</p>
<p>To echo other commenters, if most of your users are running Windows, I would recommend deploying Active Directory or Samba 4, and look into binding your Linux machines to it with SSSD.</p>
<p>(Migration from openldap to freeipa.)[<a href="https://www.reddit.com/r/linuxadmin/comments/7979e3/migration_from_openldap_to_freeipa/" target="_blank" rel="noopener">https://www.reddit.com/r/linuxadmin/comments/7979e3/migration_from_openldap_to_freeipa/</a>]</p>
<p><code>ldapsearch -Z -h oldldap.company.com -D &quot;uid=admin,ou=people,DC=company,DC=com&quot; -W -b &quot;dc=company,dc=com&quot; &gt; /tmp/ldapdump</code></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Notes/松江资源池云主机cdh环境准备.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Notes/松江资源池云主机cdh环境准备.html" itemprop="url">
                  松江资源池云主机cdh环境准备
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:35 / 修改时间：23:12:06" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">2018-05-23</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Notes/" itemprop="url" rel="index"><span itemprop="name">Notes</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="松江资源池云主机cdh环境准备"><a href="#松江资源池云主机cdh环境准备" class="headerlink" title="松江资源池云主机cdh环境准备"></a>松江资源池云主机cdh环境准备</h1><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">  1  reboot</div><div class="line">  2  ping 114.114.114.114</div><div class="line">  3  reboot</div><div class="line">  4  ls</div><div class="line">  5  cat /etc/issue</div><div class="line">  6  top</div><div class="line">  7  yum --help</div><div class="line">  8  ifconfig </div><div class="line">  9  chkconfig --list</div><div class="line"> 10  cat /etc/sysconfig/selinux </div><div class="line"> 11  echo &quot;SELINUX=disabled&quot; &gt; /etc/sysconfig/selinux </div><div class="line"> 12  cat /etc/sysconfig/selinux </div><div class="line"> 13  cat /sys/kernel/mm/transparent_hugepage/defrag </div><div class="line"> 14  echo never &gt; /sys/kernel/mm/transparent_hugepage/defrag </div><div class="line"> 15  cat /sys/kernel/mm/transparent_hugepage/defrag </div><div class="line"> 16  cat /etc/sysctl.conf </div><div class="line"> 17  echo 0 &gt;/proc/sys/vm/swappiness </div><div class="line"> 18  echo &apos;vm.swqppiness=0&apos;&gt;&gt; /etc/sysctl.conf </div><div class="line"> 19  cat /proc/sys/vm/swappiness </div><div class="line"> 20  cat /etc/sysctl.conf </div><div class="line"> 21  cat /etc/security/limits.conf </div><div class="line"> 22  vo /etc/security/limits.conf </div><div class="line"> 23  vi /etc/security/limits.conf </div><div class="line"> 24  yum install ntp</div><div class="line"> 25  ifconfig </div><div class="line"> 26  ip a</div><div class="line"> 27  yum install tree</div><div class="line"> 28  yum install lrzsz</div><div class="line"> 29  free -g</div><div class="line"> 30  systemctl stop firewalld.service</div><div class="line"> 31  chkconfig --list</div><div class="line"> 32  yum install createrop</div><div class="line"> 33  yum install createrepo</div><div class="line"> 34  yum install -y postgresql91</div><div class="line"> 35  yum install -y python-psycopg2</div><div class="line"> 36  vi /etc/rc.local </div><div class="line"> 37  cat /etc/rc.local </div><div class="line"> 38  cat /sys/kernel/mm/transparent_hugepage/</div><div class="line"> 39  cat /sys/kernel/mm/transparent_hugepage/defrag </div><div class="line"> 40  ll /etc/rc.local </div><div class="line"> 41  hostname</div><div class="line"> 42  hostname -f</div><div class="line"> 43  view /etc/ssh/ssh_config </div><div class="line"> 44  chkconfig ntp on</div><div class="line"> 45  chkconfig ntpd on</div><div class="line"> 46  chkconfig --lis</div><div class="line"> 47  chkconfig --list</div><div class="line"> 48  systemctl enable ntpd.service</div><div class="line"> 49  chkconfig --list</div><div class="line"> 50  systemctl list-unit-files</div><div class="line"> 51  systemctl list-unit-files |grep ntp</div><div class="line"> 52  systemctl list-unit-files |grep fire</div><div class="line"> 53  systemctl list-unit-files |grep ip</div><div class="line"> 54  systemctl list-unit-files |grep wall</div><div class="line"> 55  yum install gcc</div><div class="line"> 56  systemctl list-unit-files |grep firewall</div><div class="line"> 57  systemctl list-unit-files |grep ipta</div><div class="line"> 58  iptables -C</div><div class="line"> 59  iptables -V</div><div class="line"> 60  systemctl list-unit-files |grep iptables</div><div class="line"> 61  whereis iptables</div><div class="line"> 62  ll /usr/bin/iptables-xml </div><div class="line"> 63  systat</div><div class="line"> 64  sysstat</div><div class="line"> 65  yum install -y sysstat</div><div class="line"> 66  firewalls -v</div><div class="line"> 67  firewalld -v</div><div class="line"> 68  systemctl stop firewalld.service</div><div class="line"> 69  whereis firewalld</div><div class="line"> 70  ll /usr/lib/firewalld/ipsets/</div><div class="line"> 71  ll /etc/firewalld/zones/public.xml</div><div class="line"> 72  systemctl disable firewalld.service</div><div class="line"> 73  cat /etc/sysctl.conf </div><div class="line"> 74  systemctl list-unit-files |Net</div><div class="line"> 75  systemctl list-unit-files |grep Net</div><div class="line"> 76  systemctl list-unit-files |grep net</div><div class="line"> 77  systemctl --help</div><div class="line"> 78  systemctl list -units --type=service</div><div class="line"> 79  sudo systemctl status firewalld.service</div><div class="line"> 80  systemctl enable ntpd.service</div><div class="line"> 81  chkconfig --list</div><div class="line"> 82  systemctl list-unit-files |grep ntpd</div><div class="line"> 83  reboot</div><div class="line"> 84  df -h</div><div class="line"> 85  firewalld</div><div class="line"> 86  whereis firewalld</div><div class="line"> 87  systemctl status firewalld</div><div class="line"> 88  cat /etc/issue</div><div class="line"> 89  uname -a</div><div class="line"> 90  cat /etc/*release</div><div class="line"> 91  ping 8.8.8.8</div><div class="line"> 92  vi /etc/ntp.conf </div><div class="line"> 93  /etc/init.d/ntpd restart</div><div class="line"> 94  service ntpd restart</div><div class="line"> 95  ntpq -p</div><div class="line"> 96  date</div><div class="line"> 97  reboot </div><div class="line"> 98  vi /etc/ssh/sshd_config </div><div class="line"> 99  systemctl restart sshd.service</div><div class="line">100  history &gt; 1.log</div><div class="line"></div><div class="line"></div><div class="line">  1  systemctl --hlep</div><div class="line">  2  systemctl --help</div><div class="line">  3  systemctl stop firewalld.service</div><div class="line">  4  ssh 10.150.4.5</div><div class="line">  5  ssh 10.150.4.5 -p 10022</div><div class="line">  6  ssh 10.150.4.5 </div><div class="line">  7  head 1.log </div><div class="line">  8  head 15 1.log </div><div class="line">  9  head -15 1.log </div><div class="line"> 10  cat /etc/sysconfig/selinux </div><div class="line"> 11  echo &quot;SELINUX=disabled&quot; &gt; /etc/sysconfig/selinux </div><div class="line"> 12  cat /etc/sysconfig/selinux </div><div class="line"> 13  cat /sys/kernel/mm/transparent_hugepage/defrag </div><div class="line"> 14  echo never &gt; /sys/kernel/mm/transparent_hugepage/defrag </div><div class="line"> 15  cat /sys/kernel/mm/transparent_hugepage/defrag </div><div class="line"> 16  head -20 1.log |tail -5</div><div class="line"> 17  cat /etc/sysctl.conf </div><div class="line"> 18  free</div><div class="line"> 19  echo 0 &gt; /proc/sys/vm/swappiness </div><div class="line"> 20  echo &apos;vm.swappiness=0&apos; &gt;&gt; /etc/sysctl.conf </div><div class="line"> 21  cat /etc/sysctl.conf </div><div class="line"> 22  cat /proc/sys/vm/swappiness </div><div class="line"> 23  head -25 1.log |tail -5</div><div class="line"> 24  cat /etc/security/limits.conf </div><div class="line"> 25  ll</div><div class="line"> 26  cat /etc/security/limits.conf </div><div class="line"> 27  ll /etc/security/limits.conf </div><div class="line"> 28  scp root@10.150.4.5:/etc/security/limits.conf /etc/security/limits.conf </div><div class="line"> 29  vi /etc/security/limits.conf </div><div class="line"> 30  head -25 1.log |tail -5</div><div class="line"> 31  yum install ntp</div><div class="line"> 32  head -25 1.log |tail -5</div><div class="line"> 33  head -30 1.log |tail -5</div><div class="line"> 34  yum install tree</div><div class="line"> 35  yum install -y lrzsz</div><div class="line"> 36  yum install -y bash-completion</div><div class="line"> 37  head -30 1.log |tail -5</div><div class="line"> 38  head -35 1.log |tail -5</div><div class="line"> 39  head -33 1.log |tail -1 | sh</div><div class="line"> 40  yum install -y createrepo python-psycopg2</div><div class="line"> 41  yum instal -y httpd</div><div class="line"> 42  yum install -y httpd</div><div class="line"> 43  vi /etc/ntp.conf </div><div class="line"> 44  ssh 10.150.4.5</div><div class="line"> 45  head -40 1.log |tail -5</div><div class="line"> 46  vi /etc/rc.local </div><div class="line"> 47  scp root@10.150.4.5:/etc/rc.local /etc/rc.local </div><div class="line"> 48  head -40 1.log |tail -5</div><div class="line"> 49  cat /etc/rc.local </div><div class="line"> 50  head -45 1.log |tail -5</div><div class="line"> 51  chkconfig ntpd on</div><div class="line"> 52  ntpq -p</div><div class="line"> 53  systemctl enable ntpd.service</div><div class="line"> 54  systemctl start ntpd.service</div><div class="line"> 55  ntpq -p</div><div class="line"> 56  date</div><div class="line"> 57  ssh 10.150.4.5</div><div class="line"> 58  scp root@10.150.4.5:/etc/ntp.conf /etc/ntp.conf </div><div class="line"> 59  systemctl restart ntpd.service</div><div class="line"> 60  ntpq -p</div><div class="line"> 61  date</div><div class="line"> 62  ntpq -p</div><div class="line"> 63  timedatectl </div><div class="line"> 64  timedatectl set-timezone Asia/Shanghai</div><div class="line"> 65  timedatectl </div><div class="line"> 66  date</div><div class="line"> 67  head -45 1.log |tail -5</div><div class="line"> 68  head -50 1.log |tail -5</div><div class="line"> 69  head -50 1.log |tail -10</div><div class="line"> 70  head -60 1.log |tail -10</div><div class="line"> 71  head -70 1.log |tail -10</div><div class="line"> 72  yum install -y gcc sysstat</div><div class="line"> 73  head -70 1.log |tail -10</div><div class="line"> 74  head -80 1.log |tail -10</div><div class="line"> 75  systemctl list-unit-file |grep ntp</div><div class="line"> 76  systemctl list-unit-files |grep ntp</div><div class="line"> 77  ntpq -p</div><div class="line"> 78  yum install httpd</div><div class="line"> 79  ulimit -a</div><div class="line"> 80  reboot</div><div class="line"> 81  cat /etc/issue</div><div class="line"> 82  root</div><div class="line"> 83  reboot </div><div class="line"> 84  ifconfig </div><div class="line"> 85  python --version</div><div class="line"> 86  yum update python</div><div class="line"> 87  yum upgrade python</div><div class="line"> 88  ifconfig</div><div class="line"> 89  vi /etc/default/grub </div><div class="line"> 90  grub2-mkconfig -0 /boot/grub2/grub.cfg </div><div class="line"> 91  grub2-mkconfig -o /boot/grub2/grub.cfg </div><div class="line"> 92  lsmod |grep ipv6</div><div class="line"> 93  reboot </div><div class="line"> 94  pinh 8.8.8.8</div><div class="line"> 95  ping 8.8.8.8</div><div class="line"> 96  route -n</div><div class="line"> 97  ifconfig </div><div class="line"> 98  lsblk</div><div class="line"> 99  cat /sys/kernel/mm/transparent_hugepage/defrag </div><div class="line">100  cat /etc/rc.local </div><div class="line">101  echo never &gt; /sys/kernel/mm/transparent_hugepage/defrag </div><div class="line">102  cat /sys/kernel/mm/transparent_hugepage/defrag </div><div class="line">103  df -h</div><div class="line">104  cd /opt/</div><div class="line">105  ll</div><div class="line">106  cat /sys/kernel/mm/transparent_hugepage/defrag </div><div class="line">107  vi /etc/rc.d/rc.local </div><div class="line">108  ll /etc/rc.d/rc.local </div><div class="line">109  chmod  +x /etc/rc.d/rc.local </div><div class="line">110  reboot </div><div class="line">111  echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled</div><div class="line">112  echo never &gt; /sys/kernel/mm/transparent_hugepage/defrag</div><div class="line">113  vi /etc/rc.d/rc.local</div><div class="line">114  chmod +x /etc/rc.d/rc.local</div><div class="line">115  route add -net 10.200.0.0/16 gw 10.151.0.1</div><div class="line">116  history </div><div class="line">117  ll</div><div class="line">118  sz 1.log </div><div class="line">119  history &gt; 2.log</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Notes/openstack部署cdh初始化同步脚本.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Notes/openstack部署cdh初始化同步脚本.html" itemprop="url">
                  openstack部署cdh初始化同步脚本
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:35" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">2018-05-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-05-29 23:19:59" itemprop="dateModified" datetime="2018-05-29T23:19:59+08:00">2018-05-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Notes/" itemprop="url" rel="index"><span itemprop="name">Notes</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `cat ~/servers.txt`</div><div class="line"><span class="keyword">do</span></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to sync ntp.conf to <span class="variable">$i</span>--------------"</span></div><div class="line">    scp /etc/ntp.conf <span class="variable">$i</span>:/etc/ntp.conf</div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'systemctl restart ntpd.service'</span></div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to change ntpd to <span class="variable">$i</span>--------------"</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'systemctl enable ntpd.service'</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'systemctl start ntpd.service'</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'systemctl disable chronyd'</span></div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to change hugepage to <span class="variable">$i</span>--------------"</span></div><div class="line">    scp /etc/rc.d/rc.local <span class="variable">$i</span>:/etc/rc.d/rc.local</div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'chmod +x /etc/rc.d/rc.local'</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled'</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'echo never &gt; /sys/kernel/mm/transparent_hugepage/defrag'</span></div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to sync hosts to <span class="variable">$i</span>--------------"</span></div><div class="line">    scp /etc/hosts <span class="variable">$i</span>:/etc/hosts</div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to add route to <span class="variable">$i</span>--------------"</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'route add -net 10.200.0.0/16 gw 10.151.0.1'</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'route add -net 10.125.137.0/24 gw 10.151.0.1'</span></div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to restart agent to <span class="variable">$i</span>--------------"</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'systemctl restart cloudera-scm-agent.service'</span></div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to restart agent to <span class="variable">$i</span>--------------"</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'service cloudera-scm-agent restart'</span></div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to rm cloudera to <span class="variable">$i</span>--------------"</span></div><div class="line">    scp /root/rmall.sh <span class="variable">$i</span>:/root/</div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'sh /root/rmall.sh'</span></div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to sync disable ens6 to default-route  <span class="variable">$i</span>--------------"</span></div><div class="line">    scp /etc/sysconfig/network-scripts/ifcfg-ens6 <span class="variable">$i</span>:/etc/sysconfig/network-scripts/ifcfg-ens6</div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to sync wget to <span class="variable">$i</span>--------------"</span></div><div class="line">    ssh  <span class="variable">$i</span> <span class="string">'yum -y install wget'</span></div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure>
</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Linux/OpenLDAP使用手册.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Linux/OpenLDAP使用手册.html" itemprop="url">
                  OpenLDAP使用手册
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:35 / 修改时间：23:12:06" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">2018-05-23</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="OpenLDAP使用手册"><a href="#OpenLDAP使用手册" class="headerlink" title="OpenLDAP使用手册"></a>OpenLDAP使用手册</h1><hr>
<h2 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h2><p>当前的LDAP服务器部署在dsj-ddp-ad-kdc-01上,管理员先以root登录 到dsj-ddp-ad-kdc-01节点上,为一个新的用户创建一个LDIF文件(其中uid,uidNumber,gidNumber,homeDirectory可以自行定义)<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">#cat adduser.ldif</div><div class="line">dn: uid=ldaptest,ou=People,dc=sjad,dc=com</div><div class="line">objectClass: account</div><div class="line">objectClass: posixAccount</div><div class="line">objectClass: top</div><div class="line">objectClass: shadowAccount</div><div class="line">uid: ldaptest</div><div class="line">cn: ldaptest</div><div class="line">loginShell: /bin/bash</div><div class="line">userPassword: &#123;crypt&#125;x</div><div class="line">uidNumber: 2004</div><div class="line">gidNumber: 100</div><div class="line">homeDirectory: /home/ldaptest</div></pre></td></tr></table></figure></p>
<p>使用ladpadd添加用户,终端会提示输入ladpadm密码:<br>ldapadd -x -W -D “cn=ldapadm,dc=sjad,dc=com” -f adduser.ldif</p>
<p>为ladptest用户设置密码:<br>ldappasswd -s password123 -W -D “cn=ldapadm,dc=sjad,dc=com” -x<br>“uid=ldaptest,ou=People,dc=sjad,dc=com”</p>
<p>也可以在开始ldif文件中指定用户密码,根据需要灵活配置</p>
<h2 id="创建组"><a href="#创建组" class="headerlink" title="创建组"></a>创建组</h2><p>创建一个ldif文件<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">#cat addgroup.ldif</div><div class="line">dn: cn=group2,ou=Group,dc=sjad,dc=com</div><div class="line">objectClass: posixGroup</div><div class="line">objectClass: top</div><div class="line">cn: group2</div><div class="line">gidNumber: 2345</div></pre></td></tr></table></figure></p>
<h2 id="使用ldapadd添加组"><a href="#使用ldapadd添加组" class="headerlink" title="使用ldapadd添加组"></a>使用ldapadd添加组</h2><p>ldapadd -x -W -D “cn=ldapadm,dc=sjad,dc=com” -f addgroup.ldif</p>
<h2 id="把用户添加到组中"><a href="#把用户添加到组中" class="headerlink" title="把用户添加到组中"></a>把用户添加到组中</h2><p>把ladptest添加到用户组<strong>group4</strong>中,创建一个LDIF文件<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">#cat u2g.ldif</div><div class="line">dn: cn=group4,ou=Group,dc=sjad,dc=com</div><div class="line">changetype: modify</div><div class="line">add: memberuid</div><div class="line">memberuid: ldaptest</div></pre></td></tr></table></figure></p>
<p>使用<strong>ladpmodify</strong>将user添加到group<br><code>ldapmodify -x -W -D &quot;cn=ldapadm,dc=sjad,dc=com&quot; -f u2g.ldif</code></p>
<h2 id="列出当前用户和组"><a href="#列出当前用户和组" class="headerlink" title="列出当前用户和组"></a>列出当前用户和组</h2><p>ldapsearch -x</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[root@dsj-ddp-ad-kdc-01 cn=config]# ldapsearch -x</div><div class="line"># extended LDIF</div><div class="line">#</div><div class="line"># LDAPv3</div><div class="line"># base &lt;dc=sjad,dc=com&gt; (default) with scope subtree</div><div class="line"># filter: (objectclass=*)</div><div class="line"># requesting: ALL</div><div class="line">#</div><div class="line"></div><div class="line"># sjad.com</div><div class="line">dn: dc=sjad,dc=com</div><div class="line">dc: sjad</div><div class="line">objectClass: top</div><div class="line">objectClass: domain</div><div class="line"></div><div class="line"># ldapadm, sjad.com</div><div class="line">dn: cn=ldapadm,dc=sjad,dc=com</div><div class="line">objectClass: organizationalRole</div><div class="line">cn: ldapadm</div><div class="line">description: LDAP Manager</div><div class="line"></div><div class="line"># People, sjad.com</div><div class="line">dn: ou=People,dc=sjad,dc=com</div><div class="line">objectClass: organizationalUnit</div><div class="line">ou: People</div><div class="line"></div><div class="line"># Group, sjad.com</div><div class="line">dn: ou=Group,dc=sjad,dc=com</div><div class="line">objectClass: organizationalUnit</div><div class="line">ou: Group</div><div class="line"></div><div class="line"># ldaptest, People, sjad.com</div><div class="line">dn: uid=ldaptest,ou=People,dc=sjad,dc=com</div><div class="line">objectClass: top</div><div class="line">objectClass: account</div><div class="line">objectClass: posixAccount</div><div class="line">objectClass: shadowAccount</div><div class="line">cn: ldaptest</div><div class="line">uid: ldaptest</div><div class="line">uidNumber: 9988</div><div class="line">gidNumber: 100</div><div class="line">homeDirectory: /home/ldaptest</div><div class="line">loginShell: /bin/bash</div><div class="line">gecos: LDAP Replication Test User</div><div class="line">shadowLastChange: 17058</div><div class="line">shadowMin: 0</div><div class="line">shadowMax: 99999</div><div class="line">shadowWarning: 7</div><div class="line"></div><div class="line"># ldaptestgroup, Group, sjad.com</div><div class="line">dn: cn=ldaptestgroup,ou=Group,dc=sjad,dc=com</div><div class="line">objectClass: posixGroup</div><div class="line">objectClass: top</div><div class="line">cn: ldaptestgroup</div><div class="line">gidNumber: 100</div><div class="line">memberUid: ldaptest</div><div class="line"></div><div class="line"># ldaptest1, People, sjad.com</div><div class="line">dn: uid=ldaptest1,ou=People,dc=sjad,dc=com</div><div class="line">objectClass: top</div><div class="line">objectClass: account</div><div class="line">objectClass: posixAccount</div><div class="line">objectClass: shadowAccount</div><div class="line">cn: ldaptest1</div><div class="line">uid: ldaptest1</div><div class="line">uidNumber: 9989</div><div class="line">gidNumber: 101</div><div class="line">homeDirectory: /home/ldaptest1</div><div class="line">loginShell: /bin/bash</div><div class="line">gecos: LDAP Replication Test User</div><div class="line">shadowLastChange: 17058</div><div class="line">shadowMin: 0</div><div class="line">shadowMax: 99999</div><div class="line">shadowWarning: 7</div><div class="line"></div><div class="line"># ldaptest2, People, sjad.com</div><div class="line">dn: uid=ldaptest2,ou=People,dc=sjad,dc=com</div><div class="line">objectClass: top</div><div class="line">objectClass: account</div><div class="line">objectClass: posixAccount</div><div class="line">objectClass: shadowAccount</div><div class="line">cn: ldaptest2</div><div class="line">uid: ldaptest2</div><div class="line">uidNumber: 9990</div><div class="line">gidNumber: 1500</div><div class="line">homeDirectory: /home/ldaptest2</div><div class="line">loginShell: /bin/bash</div><div class="line">gecos: LDAP Replication Test User</div><div class="line">shadowLastChange: 17058</div><div class="line">shadowMin: 0</div><div class="line">shadowMax: 99999</div><div class="line">shadowWarning: 7</div><div class="line"></div><div class="line"># ldaptestgroup2, Group, sjad.com</div><div class="line">dn: cn=ldaptestgroup2,ou=Group,dc=sjad,dc=com</div><div class="line">objectClass: posixGroup</div><div class="line">objectClass: top</div><div class="line">cn: ldaptestgroup</div><div class="line">cn: ldaptestgroup2</div><div class="line">gidNumber: 1500</div><div class="line">memberUid: ldaptest2</div><div class="line"></div><div class="line"># ldaptestgroup3, Group, sjad.com</div><div class="line">dn: cn=ldaptestgroup3,ou=Group,dc=sjad,dc=com</div><div class="line">objectClass: posixGroup</div><div class="line">objectClass: top</div><div class="line">cn: ldaptestgroup</div><div class="line">cn: ldaptestgroup3</div><div class="line">gidNumber: 1501</div><div class="line">memberUid: ldaptest2</div><div class="line">memberUid: ldaptest</div><div class="line"></div><div class="line"># hadoop, People, sjad.com</div><div class="line">dn: uid=hadoop,ou=People,dc=sjad,dc=com</div><div class="line">objectClass: top</div><div class="line">objectClass: account</div><div class="line">objectClass: posixAccount</div><div class="line">objectClass: shadowAccount</div><div class="line">cn: hadoop</div><div class="line">uid: hadoop</div><div class="line">uidNumber: 6606</div><div class="line">gidNumber: 991</div><div class="line">homeDirectory: /home/hadoop</div><div class="line">loginShell: /bin/bash</div><div class="line">gecos: LDAP Replication Test User</div><div class="line">shadowLastChange: 17058</div><div class="line">shadowMin: 0</div><div class="line">shadowMax: 99999</div><div class="line">shadowWarning: 7</div><div class="line"></div><div class="line"># hadoop, Group, sjad.com</div><div class="line">dn: cn=hadoop,ou=Group,dc=sjad,dc=com</div><div class="line">objectClass: posixGroup</div><div class="line">objectClass: top</div><div class="line">cn: hadoop</div><div class="line">gidNumber: 991</div><div class="line">memberUid: hadoop</div><div class="line"></div><div class="line"># addata, People, sjad.com</div><div class="line">dn: uid=addata,ou=People,dc=sjad,dc=com</div><div class="line">objectClass: top</div><div class="line">objectClass: account</div><div class="line">objectClass: posixAccount</div><div class="line">objectClass: shadowAccount</div><div class="line">cn: addata</div><div class="line">uid: addata</div><div class="line">uidNumber: 1504</div><div class="line">gidNumber: 1504</div><div class="line">homeDirectory: /home/addata</div><div class="line">loginShell: /bin/bash</div><div class="line">gecos: LDAP Replication Test User</div><div class="line">shadowLastChange: 17058</div><div class="line">shadowMin: 0</div><div class="line">shadowMax: 99999</div><div class="line">shadowWarning: 7</div><div class="line"></div><div class="line"># addata, Group, sjad.com</div><div class="line">dn: cn=addata,ou=Group,dc=sjad,dc=com</div><div class="line">objectClass: posixGroup</div><div class="line">objectClass: top</div><div class="line">cn: addata</div><div class="line">gidNumber: 1504</div><div class="line">memberUid: addata</div><div class="line"></div><div class="line"># search result</div><div class="line">search: 2</div><div class="line">result: 0 Success</div><div class="line"></div><div class="line"># numResponses: 15</div><div class="line"># numEntries: 14</div></pre></td></tr></table></figure>
</p>
<p>FreeIPA 迁移工具<strong>ipa migrate-ds</strong>,有-shema参数,您可以使用它来指定您正在从中迁移的是什么属性 (values are RFC2307 and RFC2307bis)</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Tips/hexo.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Tips/hexo.html" itemprop="url">
                  hexo
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:35" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">2018-05-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-05-29 23:19:59" itemprop="dateModified" datetime="2018-05-29T23:19:59+08:00">2018-05-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tips/" itemprop="url" rel="index"><span itemprop="name">Tips</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="hexo"><a href="#hexo" class="headerlink" title="hexo"></a>hexo</h1><blockquote>
<p><a href="https://hexo.io/zh-cn/docs/index.html" target="_blank" rel="noopener">官方文档</a></p>
</blockquote>
<h3 id="安装前提"><a href="#安装前提" class="headerlink" title="安装前提"></a>安装前提</h3><ul>
<li>node.js</li>
<li>git</li>
</ul>
<p><code>$ npm install -g hexo-cli</code></p>
<p>具体文件作用见官方文档<br> C:\Users\Nameless13\AppData\Roaming\npm\hexo clean<br> C:\Users\Nameless13\AppData\Roaming\npm\hexo generate<br> C:\Users\Nameless13\AppData\Roaming\npm\hexo server</p>
<h2 id="Algolia"><a href="#Algolia" class="headerlink" title="Algolia"></a>Algolia</h2><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">node:9751) [DEP0061] DeprecationWarning: fs.SyncWriteStream is deprecated.</div><div class="line">FATAL Something&apos;s wrong. Maybe you can find the solution here: http://hexo.io/docs/troubleshooting.html</div><div class="line">AlgoliaSearchError: Please provide an API key. Usage: algoliasearch(applicationID, apiKey, opts)</div><div class="line">    at AlgoliaSearchNodeJS.AlgoliaSearchCore (/Users/hechangtong/Projects/blog/node_modules/algoliasearch/src/AlgoliaSearchCore.js:55:11)</div><div class="line">    at AlgoliaSearchNodeJS.AlgoliaSearch (/Users/hechangtong/Projects/blog/node_modules/algoliasearch/src/AlgoliaSearch.js:11:21)</div><div class="line">    at AlgoliaSearchNodeJS.AlgoliaSearchServer (/Users/hechangtong/Projects/blog/node_modules/algoliasearch/src/server/builds/AlgoliaSearchServer.js:17:17)</div><div class="line">    at new AlgoliaSearchNodeJS (/Users/hechangtong/Projects/blog/node_modules/algoliasearch/src/server/builds/node.js:79:23)</div><div class="line">    at algoliasearch (/Users/hechangtong/Projects/blog/node_modules/algoliasearch/src/server/builds/node.js:68:10)</div><div class="line">    at Hexo.module.exports (/Users/hechangtong/Projects/blog/node_modules/hexo-algolia/lib/command.js:22:16)</div><div class="line">    at Hexo.tryCatcher (/Users/hechangtong/Projects/blog/node_modules/bluebird/js/release/util.js:16:23)</div><div class="line">    at Hexo.ret (eval at makeNodePromisifiedEval (/usr/local/lib/node_modules/hexo-cli/node_modules/bluebird/js/release/promisify.js:184:12), &lt;anonymous&gt;:13:39)</div><div class="line">    at /Users/hechangtong/Projects/blog/node_modules/hexo/lib/hexo/index.js:195:9</div><div class="line">    at Promise._execute (/Users/hechangtong/Projects/blog/node_modules/bluebird/js/release/debuggability.js:300:9)</div><div class="line">    at Promise._resolveFromExecutor (/Users/hechangtong/Projects/blog/node_modules/bluebird/js/release/promise.js:483:18)</div><div class="line">    at new Promise (/Users/hechangtong/Projects/blog/node_modules/bluebird/js/release/promise.js:79:10)</div><div class="line">    at Hexo.call (/Users/hechangtong/Projects/blog/node_modules/hexo/lib/hexo/index.js:191:10)</div><div class="line">    at /usr/local/lib/node_modules/hexo-cli/lib/hexo.js:66:17</div><div class="line">    at tryCatcher (/usr/local/lib/node_modules/hexo-cli/node_modules/bluebird/js/release/util.js:16:23)</div><div class="line">    at Promise._settlePromiseFromHandler (/usr/local/lib/node_modules/hexo-cli/node_modules/bluebird/js/release/promise.js:512:31)</div><div class="line">    at Promise._settlePromise (/usr/local/lib/node_modules/hexo-cli/node_modules/bluebird/js/release/promise.js:569:18)</div><div class="line">    at Promise._settlePromise0 (/usr/local/lib/node_modules/hexo-cli/node_modules/bluebird/js/release/promise.js:614:10)</div><div class="line">    at Promise._settlePromises (/usr/local/lib/node_modules/hexo-cli/node_modules/bluebird/js/release/promise.js:693:18)</div><div class="line">    at Async._drainQueue (/usr/local/lib/node_modules/hexo-cli/node_modules/bluebird/js/release/async.js:133:16)</div><div class="line">    at Async._drainQueues (/usr/local/lib/node_modules/hexo-cli/node_modules/bluebird/js/release/async.js:143:10)</div><div class="line">    at Immediate.Async.drainQueues (/usr/local/lib/node_modules/hexo-cli/node_modules/bluebird/js/release/async.js:17:14)</div><div class="line">➜  blog export HEXO_ALGOLIA_INDEXING_KEY=xxxxxxxxxxxxx</div><div class="line">➜  blog hexo algolia</div><div class="line">(node:9765) [DEP0061] DeprecationWarning: fs.SyncWriteStream is deprecated.</div><div class="line">INFO  [Algolia] Testing HEXO_ALGOLIA_INDEXING_KEY permissions.</div><div class="line">INFO  Start processing</div><div class="line">INFO  [Algolia] Identified 153 posts to index.</div><div class="line">INFO  [Algolia] Start indexing...</div></pre></td></tr></table></figure>
</p>
<h2 id="Theme"><a href="#Theme" class="headerlink" title="Theme"></a>Theme</h2><p>主题我选择github上Star数最高的(hexo-theme-next)[<a href="https://github.com/theme-next" target="_blank" rel="noopener">https://github.com/theme-next</a>]</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">    modified:   _config.yml</div><div class="line">    modified:   layout/_custom/sidebar.swig</div><div class="line">    modified:   source/css/_custom/custom.styl</div><div class="line">Untracked files:</div><div class="line">  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</div><div class="line">    source/images/avatar.jpg</div></pre></td></tr></table></figure>
</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Document/CentOS 7 修改时区.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Document/CentOS 7 修改时区.html" itemprop="url">
                  CentOS 7 修改时区
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:35 / 修改时间：23:12:06" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">2018-05-23</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Document/" itemprop="url" rel="index"><span itemprop="name">Document</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Linux 系统(我特指发行版, 没说内核) 下大部分软件的风格就是不会仔细去考虑向后 的兼容性, 比如你上个版本能用这种程序配置, 没准到了下一个版本, 该程序已经不见了. 比如 sysvinit 这种东西.<br>设置时区同样, 在 CentOS 7 中, 引入了一个叫 timedatectl 的设置设置程序.<br>用法很简单:<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line"># timedatectl # 查看系统时间方面的各种状态</div><div class="line">      Local time: 四 2014-12-25 10:52:10 CST</div><div class="line">  Universal time: 四 2014-12-25 02:52:10 UTC</div><div class="line">        RTC time: 四 2014-12-25 02:52:10</div><div class="line">        Timezone: Asia/Shanghai (CST, +0800)</div><div class="line">     NTP enabled: yes</div><div class="line">NTP synchronized: yes</div><div class="line"> RTC in local TZ: no</div><div class="line">      DST active: n/a</div><div class="line"># timedatectl list-timezones # 列出所有时区</div><div class="line"># timedatectl set-local-rtc 1 # 将硬件时钟调整为与本地时钟一致, 0 为设置为 UTC 时间</div><div class="line"># timedatectl set-timezone Asia/Shanghai # 设置系统时区为上海</div></pre></td></tr></table></figure></p>
<p>其实不考虑各个发行版的差异化, 从更底层出发的话, 修改时间时区比想象中要简单:<br><code># cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</code></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="Nameless13" />
            
              <p class="site-author-name" itemprop="name">Nameless13</p>
              <p class="site-description motion-element" itemprop="description">─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">164</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">33</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Nameless13</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动 v3.4.3</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Mist</a> v6.3.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



	





  





  










  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=6.3.0"></script>



  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
