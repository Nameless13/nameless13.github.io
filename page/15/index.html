<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: 'J3OX6892F7',
      apiKey: '38852eb9095216f8f2ada575a06a9cfc',
      indexName: 'Blog',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
<meta property="og:type" content="website">
<meta property="og:title" content="Nameless13">
<meta property="og:url" content="https://nameless13.github.io/page/15/index.html">
<meta property="og:site_name" content="Nameless13">
<meta property="og:description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Nameless13">
<meta name="twitter:description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">






  <link rel="canonical" href="https://nameless13.github.io/page/15/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Nameless13</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Nameless13</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Shell/SUSE开机启动脚本配置文件.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Shell/SUSE开机启动脚本配置文件.html" itemprop="url">
                  SUSE开机启动脚本配置文件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-05-24 00:00:00" itemprop="dateCreated datePublished" datetime="2017-05-24T00:00:00+08:00">2017-05-24</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2017-09-24 13:58:04" itemprop="dateModified" datetime="2017-09-24T13:58:04+08:00">2017-09-24</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Shell/" itemprop="url" rel="index"><span itemprop="name">Shell</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="SUSE开机启动脚本配置文件"><a href="#SUSE开机启动脚本配置文件" class="headerlink" title="SUSE开机启动脚本配置文件"></a>SUSE开机启动脚本配置文件</h1><p>关于开机启动脚本配置文件  SUSE与其它Linux设置不一样</p>
<p>那就是 /etc/init.d 下的几个档案</p>
<ol>
<li>boot.local –&gt; 这个开机启动档案会在 rc5.d 前就有动作</li>
<li>halt.local –&gt; 这个关机启动档案会在最后有动作</li>
<li>before.local –&gt; 这个档案比较用不到所以不需多做解释</li>
<li>after.local –&gt; 这个档案会在 rc5.d 之后有动作 , 就是最重要的开机启动档 ， 没有的话 新建一个</li>
</ol>
<p>上面第三及第四个档案预设是不存在的喔!!<br>当你看过 /etc/init.d/rc 这个档案就知道为什幺了<br>所以当你要使用第三或第四个档案时请自己建立, 就像你写个shell一样很简单</p>
<p>例:<br><code>vi /etc/init.d/after.local</code><br><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line"><span class="meta">#! /bin/sh</span></div><div class="line">/usr/tem/run.sh</div><div class="line"> </div><div class="line">:wq</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Error/[Spark]spark-streaming 与kafka的结合.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Error/[Spark]spark-streaming 与kafka的结合.html" itemprop="url">
                  spark-streaming 与kafka的结合
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-05-24 00:00:00" itemprop="dateCreated datePublished" datetime="2017-05-24T00:00:00+08:00">2017-05-24</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-05-23 01:22:01" itemprop="dateModified" datetime="2018-05-23T01:22:01+08:00">2018-05-23</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Error/" itemprop="url" rel="index"><span itemprop="name">Error</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="spark-streaming-与kafka的结合"><a href="#spark-streaming-与kafka的结合" class="headerlink" title="spark-streaming 与kafka的结合"></a>spark-streaming 与kafka的结合</h1><p>升级CDH到5.10后 spark-steaming 从kafka获取消息就报错</p>
<p><strong>原因:高版本的kafka从低版本的kafka server端连接不兼容</strong></p>
<p>因为在使用spark-streaming调用kafka的时候,会由cloudera来调用相应的组件,其中就有kafka的客户端,并且优先级较高,继而不会调用我们自己的kafka客户端,导致报错<br>后来原厂的人重新编译路径指向后解决</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Error/[Hive]hive LZO压缩格式支持.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Error/[Hive]hive LZO压缩格式支持.html" itemprop="url">
                  hive LZO压缩格式支持
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-05-24 00:00:00" itemprop="dateCreated datePublished" datetime="2017-05-24T00:00:00+08:00">2017-05-24</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-05-23 01:22:01" itemprop="dateModified" datetime="2018-05-23T01:22:01+08:00">2018-05-23</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Error/" itemprop="url" rel="index"><span itemprop="name">Error</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p><a href="https://www.cloudera.com/documentation/enterprise/latest/topics/admin_data_compression_performance.html" target="_blank" rel="noopener">LZO配置</a></p>
</blockquote>
<h2 id="hive-因为仅仅添加了LZO压缩格式的配置路径-却没有导入"><a href="#hive-因为仅仅添加了LZO压缩格式的配置路径-却没有导入" class="headerlink" title="hive 因为仅仅添加了LZO压缩格式的配置路径,却没有导入"></a>hive 因为仅仅添加了LZO压缩格式的配置路径,却没有导入</h2><p>暂时先删除LZO配置<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">ddp-hb-01:~ # beeline -u &apos;jdbc:hive2://10.200.60.99:10000/yanfa;principal=hive/ddp-hb-01.cmdmp.com@CMDMP.COM&apos;</div><div class="line">scan complete in 3ms</div><div class="line">Connecting to jdbc:hive2://10.200.60.99:10000/yanfa;principal=hive/ddp-hb-01.cmdmp.com@CMDMP.COM</div><div class="line">Connected to: Apache Hive (version 1.1.0-cdh5.4.7)</div><div class="line">Driver: Hive JDBC (version 1.1.0-cdh5.4.7)</div><div class="line">Transaction isolation: TRANSACTION_REPEATABLE_READ</div><div class="line">Beeline version 1.1.0-cdh5.4.7 by Apache Hive</div><div class="line">[INFO] Unable to bind key for unsupported operation: backward-delete-word</div><div class="line">[INFO] Unable to bind key for unsupported operation: backward-delete-word</div><div class="line">[INFO] Unable to bind key for unsupported operation: down-history</div><div class="line">[INFO] Unable to bind key for unsupported operation: up-history</div><div class="line">[INFO] Unable to bind key for unsupported operation: up-history</div><div class="line">[INFO] Unable to bind key for unsupported operation: down-history</div><div class="line">[INFO] Unable to bind key for unsupported operation: up-history</div><div class="line">[INFO] Unable to bind key for unsupported operation: down-history</div><div class="line">[INFO] Unable to bind key for unsupported operation: up-history</div><div class="line">[INFO] Unable to bind key for unsupported operation: down-history</div><div class="line">[INFO] Unable to bind key for unsupported operation: up-history</div><div class="line">[INFO] Unable to bind key for unsupported operation: down-history</div><div class="line">0: jdbc:hive2://10.200.60.99:10000/yanfa&gt; show databases;</div><div class="line">0: jdbc:hive2://10.200.60.99:10000/yanfa&gt; show tables;</div><div class="line">0: jdbc:hive2://10.200.60.99:10000/yanfa&gt; select * from tk_user_his limit 10;</div></pre></td></tr></table></figure></p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">11	11	</div><div class="line">     &lt;value&gt;1&lt;/value&gt;</div><div class="line">12	12	</div><div class="line">   &lt;/property&gt;</div><div class="line">13	13	</div><div class="line">   &lt;property&gt;</div><div class="line">14	14	</div><div class="line">     &lt;name&gt;io.compression.codecs&lt;/name&gt;</div><div class="line">15		</div><div class="line">-    &lt;value&gt;org.apache.hadoop.io.compress.DefaultCodec,org.apache.hadoop.io.compress.GzipCodec,org.apache.hadoop.io.compress.BZip2Codec,org.apache.hadoop.io.compress.DeflateCodec,org.apache.hadoop.io.compress.SnappyCodec,org.apache.hadoop.io.compress.Lz4Codec&lt;/value&gt;</div><div class="line">15	</div><div class="line">+    &lt;value&gt;org.apache.hadoop.io.compress.DefaultCodec,org.apache.hadoop.io.compress.GzipCodec,org.apache.hadoop.io.compress.BZip2Codec,org.apache.hadoop.io.compress.DeflateCodec,org.apache.hadoop.io.compress.SnappyCodec,org.apache.hadoop.io.compress.Lz4Codec,com.hadoop.compression.lzo.LzoCodec,com.hadoop.compression.lzo.LzopCodec&lt;/value&gt;</div><div class="line">16	16	</div><div class="line">   &lt;/property&gt;</div><div class="line">17	17	</div><div class="line">   &lt;property&gt;</div><div class="line">18	18	</div><div class="line">     &lt;name&gt;hadoop.security.authentication&lt;/name&gt;</div><div class="line">19	19	</div><div class="line">     &lt;value&gt;kerberos&lt;/value&gt;</div></pre></td></tr></table></figure>
</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">93	93	</div><div class="line">   &lt;node name=&quot;ddp-dn-041.cmdmp.com&quot; rack=&quot;/A21&quot;/&gt;</div><div class="line">94	94	</div><div class="line">   &lt;node name=&quot;10.200.60.123&quot; rack=&quot;/A21&quot;/&gt;</div><div class="line">95	95	</div><div class="line">   &lt;node name=&quot;ddp-dn-042.cmdmp.com&quot; rack=&quot;/A21&quot;/&gt;</div><div class="line">96	96	</div><div class="line">   &lt;node name=&quot;10.200.60.124&quot; rack=&quot;/A21&quot;/&gt;</div><div class="line">97		</div><div class="line">-  &lt;node name=&quot;ddp-dn-043.cmdmp.com&quot; rack=&quot;/A21&quot;/&gt;</div><div class="line">98		</div><div class="line">-  &lt;node name=&quot;10.200.60.125&quot; rack=&quot;/A21&quot;/&gt;</div><div class="line">99	97	</div><div class="line">   &lt;node name=&quot;ddp-dn-044.cmdmp.com&quot; rack=&quot;/A21&quot;/&gt;</div><div class="line">100	98	</div><div class="line">   &lt;node name=&quot;10.200.60.126&quot; rack=&quot;/A21&quot;/&gt;</div><div class="line">101	99	</div><div class="line">   &lt;node name=&quot;ddp-dn-045.cmdmp.com&quot; rack=&quot;/A21&quot;/&gt;</div><div class="line">102	100	</div><div class="line">   &lt;node name=&quot;10.200.60.127&quot; rack=&quot;/A21&quot;/&gt;</div><div class="line">...	...	</div><div class="line">@@ -339,8 +337,10 @@</div><div class="line">339	337	</div><div class="line">   &lt;node name=&quot;ddp-dn-170.cmdmp.com&quot; rack=&quot;/A15&quot;/&gt;</div><div class="line">340	338	</div><div class="line">   &lt;node name=&quot;10.200.60.81&quot; rack=&quot;/A15&quot;/&gt;</div><div class="line">341	339	</div><div class="line">   &lt;node name=&quot;ddp-dn-171.cmdmp.com&quot; rack=&quot;/A15&quot;/&gt;</div><div class="line">342	340	</div><div class="line">   &lt;node name=&quot;10.200.60.82&quot; rack=&quot;/A15&quot;/&gt;</div><div class="line">341	</div><div class="line">+  &lt;node name=&quot;ddp-dn-172.cmdmp.com&quot; rack=&quot;/default&quot;/&gt;</div><div class="line">342	</div><div class="line">+  &lt;node name=&quot;10.200.60.83&quot; rack=&quot;/default&quot;/&gt;</div><div class="line">343	343	</div><div class="line">   &lt;node name=&quot;ddp-dn-173.cmdmp.com&quot; rack=&quot;/A15&quot;/&gt;</div><div class="line">344	344	</div><div class="line">   &lt;node name=&quot;10.200.60.84&quot; rack=&quot;/A15&quot;/&gt;</div><div class="line">345	345	</div><div class="line">   &lt;node name=&quot;ddp-dn-174.cmdmp.com&quot; rack=&quot;/A15&quot;/&gt;</div><div class="line">346	346	</div><div class="line">   &lt;node name=&quot;10.200.60.85&quot; rack=&quot;/A15&quot;/&gt;</div><div class="line">```     </div><div class="line"></div><div class="line">3月 22, 下午2点53:37.282	WARN	org.apache.hive.service.cli.thrift.ThriftCLIService	</div><div class="line">Error fetching results: </div><div class="line">org.apache.hive.service.cli.HiveSQLException: java.io.IOException: java.lang.RuntimeException: Error in configuring object</div><div class="line">	at org.apache.hive.service.cli.operation.SQLOperation.getNextRowSet(SQLOperation.java:329)</div><div class="line">	at org.apache.hive.service.cli.operation.OperationManager.getOperationNextRowSet(OperationManager.java:250)</div><div class="line">	at org.apache.hive.service.cli.session.HiveSessionImpl.fetchResults(HiveSessionImpl.java:699)</div><div class="line">	at sun.reflect.GeneratedMethodAccessor10.invoke(Unknown Source)</div><div class="line">	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</div><div class="line">	at java.lang.reflect.Method.invoke(Method.java:606)</div><div class="line">	at org.apache.hive.service.cli.session.HiveSessionProxy.invoke(HiveSessionProxy.java:78)</div><div class="line">	at org.apache.hive.service.cli.session.HiveSessionProxy.access$000(HiveSessionProxy.java:36)</div><div class="line">	at org.apache.hive.service.cli.session.HiveSessionProxy$1.run(HiveSessionProxy.java:63)</div><div class="line">	at java.security.AccessController.doPrivileged(Native Method)</div><div class="line">	at javax.security.auth.Subject.doAs(Subject.java:415)</div><div class="line">	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1671)</div><div class="line">	at org.apache.hive.service.cli.session.HiveSessionProxy.invoke(HiveSessionProxy.java:59)</div><div class="line">	at com.sun.proxy.$Proxy23.fetchResults(Unknown Source)</div><div class="line">	at org.apache.hive.service.cli.CLIService.fetchResults(CLIService.java:438)</div><div class="line">	at org.apache.hive.service.cli.thrift.ThriftCLIService.FetchResults(ThriftCLIService.java:676)</div><div class="line">	at org.apache.hive.service.cli.thrift.TCLIService$Processor$FetchResults.getResult(TCLIService.java:1553)</div><div class="line">	at org.apache.hive.service.cli.thrift.TCLIService$Processor$FetchResults.getResult(TCLIService.java:1538)</div><div class="line">	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:39)</div><div class="line">	at org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:39)</div><div class="line">	at org.apache.hadoop.hive.thrift.HadoopThriftAuthBridge$Server$TUGIAssumingProcessor.process(HadoopThriftAuthBridge.java:692)</div><div class="line">	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:285)</div><div class="line">	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)</div><div class="line">	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)</div><div class="line">	at java.lang.Thread.run(Thread.java:745)</div><div class="line">Caused by: java.io.IOException: java.lang.RuntimeException: Error in configuring object</div><div class="line">	at org.apache.hadoop.hive.ql.exec.FetchOperator.getNextRow(FetchOperator.java:507)</div><div class="line">	at org.apache.hadoop.hive.ql.exec.FetchOperator.pushRow(FetchOperator.java:414)</div><div class="line">	at org.apache.hadoop.hive.ql.exec.FetchTask.fetch(FetchTask.java:138)</div><div class="line">	at org.apache.hadoop.hive.ql.Driver.getResults(Driver.java:1655)</div><div class="line">	at org.apache.hive.service.cli.operation.SQLOperation.getNextRowSet(SQLOperation.java:324)</div><div class="line">	... 24 more</div><div class="line">Caused by: java.lang.RuntimeException: Error in configuring object</div><div class="line">	at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:109)</div><div class="line">	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:75)</div><div class="line">	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:133)</div><div class="line">	at org.apache.hadoop.hive.ql.exec.FetchOperator.getInputFormatFromCache(FetchOperator.java:206)</div><div class="line">	at org.apache.hadoop.hive.ql.exec.FetchOperator.getNextSplits(FetchOperator.java:360)</div><div class="line">	at org.apache.hadoop.hive.ql.exec.FetchOperator.getRecordReader(FetchOperator.java:294)</div><div class="line">	at org.apache.hadoop.hive.ql.exec.FetchOperator.getNextRow(FetchOperator.java:445)</div><div class="line">	... 28 more</div><div class="line">Caused by: java.lang.reflect.InvocationTargetException</div><div class="line">	at sun.reflect.GeneratedMethodAccessor43.invoke(Unknown Source)</div><div class="line">	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</div><div class="line">	at java.lang.reflect.Method.invoke(Method.java:606)</div><div class="line">	at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:106)</div><div class="line">	... 34 more</div><div class="line">Caused by: java.lang.IllegalArgumentException: Compression codec com.hadoop.compression.lzo.LzoCodec not found.</div><div class="line">	at org.apache.hadoop.io.compress.CompressionCodecFactory.getCodecClasses(CompressionCodecFactory.java:135)</div><div class="line">	at org.apache.hadoop.io.compress.CompressionCodecFactory.&lt;init&gt;(CompressionCodecFactory.java:175)</div><div class="line">	at org.apache.hadoop.mapred.TextInputFormat.configure(TextInputFormat.java:45)</div><div class="line">	... 38 more</div><div class="line">Caused by: java.lang.ClassNotFoundException: Class com.hadoop.compression.lzo.LzoCodec not found</div><div class="line">	at org.apache.hadoop.conf.Configuration.getClassByName(Configuration.java:2018)</div><div class="line">	at org.apache.hadoop.io.compress.CompressionCodecFactory.getCodecClasses(CompressionCodecFactory.java:128)</div><div class="line">	... 40 more</div></pre></td></tr></table></figure>
</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Error/[HDFS]执行数据节点的磁盘热插拔.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Error/[HDFS]执行数据节点的磁盘热插拔.html" itemprop="url">
                  执行数据节点的磁盘热插拔
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-04-01 00:00:00" itemprop="dateCreated datePublished" datetime="2017-04-01T00:00:00+08:00">2017-04-01</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-05-29 23:19:59" itemprop="dateModified" datetime="2018-05-29T23:19:59+08:00">2018-05-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Error/" itemprop="url" rel="index"><span itemprop="name">Error</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="执行数据节点的磁盘热插拔"><a href="#执行数据节点的磁盘热插拔" class="headerlink" title="执行数据节点的磁盘热插拔"></a>执行数据节点的磁盘热插拔</h1><blockquote>
<p><strong>v1.0</strong> updated:2017-04-01 Nameless13</p>
</blockquote>
<p><a href="https://www.cloudera.com/documentation/enterprise/latest/topics/admin_dn_swap.html" target="_blank" rel="noopener">在不关闭DataNode的情况下替换HDFS磁盘,这被称为热插拔</a></p>
<h4 id="警告-要求和限制"><a href="#警告-要求和限制" class="headerlink" title="警告:要求和限制"></a>警告:要求和限制</h4><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">CDH 5.4及更高版本支持热插拔。</div><div class="line">热插拔只能添加带有空数据目录的磁盘。</div><div class="line">删除磁盘不会将数据移出磁盘，这可能会导致数据丢失。</div><div class="line">不要同时在多台主机上执行热插拔。</div></pre></td></tr></table></figure>
</p>
<h2 id="使用Cloudera-Manager执行数据节点的磁盘热插拔"><a href="#使用Cloudera-Manager执行数据节点的磁盘热插拔" class="headerlink" title="使用Cloudera Manager执行数据节点的磁盘热插拔"></a>使用Cloudera Manager执行数据节点的磁盘热插拔</h2><p><strong>角色最低要求</strong>：  Cluster Administrator </p>
<ol>
<li><p>配置数据目录以删除要交换的磁盘：</p>
<ol>
<li>选择导航栏上Cluster转到HDFS服务。</li>
<li>单击<strong>Instances</strong>选项卡。</li>
<li>单击受影响的DataNode。</li>
<li>单击<strong>Configuration</strong>选项卡。</li>
<li>选择左侧筛选器中的<strong>Scope</strong> &gt; <strong>DataNode</strong>。</li>
<li>选择左侧筛选器中的<strong>Category</strong> &gt; <strong>Main</strong>。</li>
<li>更改<strong>DataNode Data Directory</strong>属性的值，以删除要删除的磁盘的挂载点的目录。有哪些角色的都要删掉(hdfs,impala,yarn)</li>
</ol>
<p><strong>警告：仅对要计划热插拔磁盘的特定DataNode实例更改此属性的值。不要编辑此属性的</strong>角色组<strong>值。否则会导致数据丢失和角色变更。</strong></p>
</li>
<li><p>单击<strong>Save Changes</strong>以提交更改。</p>
</li>
<li>刷新受影响的DataNode。选择<strong>Actions</strong> &gt; 刷新数据目录。</li>
<li>删除旧磁盘并添加替换磁盘。</li>
<li>更改DataNode Data Directory属性的值以添加作为您添加的磁盘的挂接点的目录。</li>
<li>单击<strong>Save Changes</strong>以提交更改。</li>
<li>刷新受影响的DataNode。选择 <strong>Actions</strong> &gt; <strong>Refresh Data Directories</strong>。</li>
<li>运行HDFS fsck 验证health of HDFS。</li>
</ol>
<h4 id="如果使用Cloudera-Manager-就不要使用命令行来操作磁盘热插拔"><a href="#如果使用Cloudera-Manager-就不要使用命令行来操作磁盘热插拔" class="headerlink" title="如果使用Cloudera Manager,就不要使用命令行来操作磁盘热插拔"></a>如果使用Cloudera Manager,就不要使用命令行来操作磁盘热插拔</h4><hr>
<p>##换盘步骤</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">df -h</div><div class="line">fdisk -l|more</div><div class="line">parted /dev/sdi</div><div class="line"></div><div class="line">parted -s $DEVICE mklabel gpt mkpart primary ext3</div><div class="line">mkfs.ext3 /dev/sdi1</div></pre></td></tr></table></figure>
</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">ddp-dn-121:~ # mkfs.ext3 /dev/sdi</div><div class="line">mke2fs 1.41.9 (22-Aug-2009)</div><div class="line">/dev/sdi is entire device, not just one partition!</div><div class="line">Proceed anyway? (y,n) y</div><div class="line">Filesystem label=</div><div class="line">OS type: Linux</div><div class="line">Block size=4096 (log=2)</div><div class="line">Fragment size=4096 (log=2)</div><div class="line">183107584 inodes, 732421632 blocks</div><div class="line">36621081 blocks (5.00%) reserved for the super user</div><div class="line">First data block=0</div><div class="line">Maximum filesystem blocks=4294967296</div><div class="line">22352 block groups</div><div class="line">32768 blocks per group, 32768 fragments per group</div><div class="line">8192 inodes per group</div><div class="line">Superblock backups stored on blocks: </div><div class="line">  32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, </div><div class="line">  4096000, 7962624, 11239424, 20480000, 23887872, 71663616, 78675968, </div><div class="line">  102400000, 214990848, 512000000, 550731776, 644972544</div><div class="line"></div><div class="line">Writing inode tables: done                            </div><div class="line">Creating journal (32768 blocks): done</div><div class="line">Writing superblocks and filesystem accounting information: </div><div class="line">mount /dev/sdi1 /mnt/sdi1/</div><div class="line">df -h</div></pre></td></tr></table></figure>
</p>
<hr>
<h2 id="根目录数据爆满"><a href="#根目录数据爆满" class="headerlink" title="根目录数据爆满"></a>根目录数据爆满</h2><blockquote>
<p>原因:因为不正确的换盘操作导致,cdh将数据写入系统盘</p>
</blockquote>
<ol>
<li>通过Cm停止该节点所有角色</li>
<li>然后umount掉所有盘 停止角色到能umount之间有时长 需要等待</li>
<li>然后计算每个目录大小  <code>du -hs /mnt/*</code></li>
<li>将数据备份</li>
<li>删除有数据的那个目录</li>
<li><p>接着mount所有盘</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">mount /dev/sdb1 /mnt/sdb1/</div><div class="line">mount /dev/sdc1 /mnt/sdc1/</div><div class="line">mount /dev/sdd1 /mnt/sdd1/</div><div class="line">mount /dev/sde1 /mnt/sde1/</div><div class="line">mount /dev/sdf1 /mnt/sdf1/</div><div class="line">mount /dev/sdg1 /mnt/sdg1/</div><div class="line">mount /dev/sdh1 /mnt/sdh1/</div><div class="line">mount /dev/sdi1 /mnt/sdi1/</div><div class="line">mount /dev/sdj1 /mnt/sdj1/</div><div class="line">mount /dev/sdk1 /mnt/sdk1/</div><div class="line">mount /dev/sdl1 /mnt/sdl1/</div><div class="line">mount /dev/sdm1 /mnt/sdm1/</div></pre></td></tr></table></figure>
</p>
</li>
<li><p>然后重启agent</p>
</li>
</ol>
<hr>
<h2 id="机房换盘步骤"><a href="#机房换盘步骤" class="headerlink" title="机房换盘步骤"></a>机房换盘步骤</h2><ol>
<li>机房打电话提醒换盘后,因为要重启机器,所以要求他们一台台操作</li>
<li>通过CM停止该节点所有角色,后通知机房</li>
<li>机房更换好后,因对新硬盘做分区和格式化 </li>
<li>之后mount对应磁盘</li>
<li>重启cloudera-scm-agent</li>
<li>CM上恢复对应角色</li>
<li>恢复后可能有一段时间连不上namenode节点,过一段时间后告警就会自动消失</li>
</ol>
<hr>
<h2 id="Linux-umount的device-is-busy问题"><a href="#Linux-umount的device-is-busy问题" class="headerlink" title="Linux umount的device is busy问题"></a>Linux umount的device is busy问题</h2><blockquote>
<p>原因：其他进程可能在使用/mnt/vdb目录。</p>
</blockquote>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">[root@dbserver ~]<span class="comment"># df -h</span></div><div class="line">文件系统 容量 已用 可用 已用%% 挂载点</div><div class="line">/dev/vda1 9.9G 3.9G 5.6G 41% /</div><div class="line">tmpfs 3.9G 100K 3.9G 1% /dev/shm</div><div class="line">/dev/sr0 368K 368K 0 100% /media/CDROM</div><div class="line">/dev/vdb 197G 5.9G 181G 4% /mnt</div><div class="line"></div><div class="line">[root@dbserver /]<span class="comment"># umount /mnt/vdb</span></div><div class="line">umount: /mnt: device is busy.</div><div class="line">(In some cases useful info about processes that use</div><div class="line">the device is found by lsof(8) or fuser(1))</div></pre></td></tr></table></figure>
</p>
<p>解决办法：</p>
<p>关闭使用该目录的进程，然后再umount。</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">[root@dbserver /]<span class="comment"># fuser -m /dev/vdb</span></div><div class="line">/dev/vdb: 3052c</div><div class="line"></div><div class="line">[root@dbserver /]<span class="comment"># ps aux |grep 3052</span></div><div class="line">root 2218 0.0 0.0 163052 1648 ? Sl 10:30 0:00 gnome-keyring-daemon --start</div><div class="line">root 3052 0.0 0.0 108328 1732 pts/1 Ss+ 11:12 0:00 -bash</div><div class="line"></div><div class="line">root 3448 0.0 0.0 6384 708 pts/5 S+ 12:59 0:00 grep 3052</div><div class="line"></div><div class="line">[root@dbserver /]<span class="comment"># kill -9 3052</span></div><div class="line">[root@dbserver /]<span class="comment"># ps aux |grep 3052</span></div><div class="line">root 2218 0.0 0.0 163052 1648 ? Sl 10:30 0:00 gnome-keyring-daemon --start</div><div class="line">root 3453 0.0 0.0 6384 704 pts/5 S+ 13:00 0:00 grep 3052</div><div class="line">[root@dbserver /]<span class="comment">#</span></div><div class="line"></div><div class="line">[root@dbserver /]<span class="comment"># umount /dev/vdb</span></div><div class="line">[root@dbserver /]<span class="comment"># df -h</span></div><div class="line">Filesystem Size Used Avail Use% Mounted on</div><div class="line">/dev/vda1 9.9G 1.4G 8.0G 15% /</div><div class="line">tmpfs 3.9G 100K 3.9G 1% /dev/shm</div><div class="line">/dev/sr0 368K 368K 0 100% /media/CDROM</div></pre></td></tr></table></figure>
</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Error/[Impala]Impala复杂查询报错.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Error/[Impala]Impala复杂查询报错.html" itemprop="url">
                  Impala复杂查询报错
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-03-30 00:00:00" itemprop="dateCreated datePublished" datetime="2017-03-30T00:00:00+08:00">2017-03-30</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-05-23 01:22:01" itemprop="dateModified" datetime="2018-05-23T01:22:01+08:00">2018-05-23</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Error/" itemprop="url" rel="index"><span itemprop="name">Error</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Impala-Error-Couldn’t-open-transport-未解决"><a href="#Impala-Error-Couldn’t-open-transport-未解决" class="headerlink" title="Impala Error: Couldn’t open transport(未解决)"></a>Impala Error: Couldn’t open transport(未解决)</h1><blockquote>
<p><strong>v1.0</strong> updated:2017-03-30 何常通<br><a href="https://community.cloudera.com/t5/Interactive-Short-cycle-SQL/Impala-Error-Couldn-t-open-transport/m-p/15916#M366" target="_blank" rel="noopener">原地址</a></p>
</blockquote>
<h2 id="当运行复杂查询的时候会报出这种错误"><a href="#当运行复杂查询的时候会报出这种错误" class="headerlink" title="当运行复杂查询的时候会报出这种错误"></a>当运行复杂查询的时候会报出这种错误</h2><p>When we try to run more complex Impala queries, we often run into the following error:<br>Couldn’t open transport for worker29.ourdomain.com:22000(connect() failed: Connection timed out)</p>
<p>Sometimes there’s only one node with that error message, sometimes there are 2-5.<br>There doesn’t seem to be a network related problem - ping works, telnet to that port works, Impala debug ui works.<br>We tried setting vm.swappiness on the nodes from 60 to 0 - no positive effect. Same with switching vm.overcommit from 0 to 1.</p>
<p>Our setup:</p>
<ul>
<li>around 40 nodes, i7 quad core, 2-3TB, 1Gbit NIC, located in 5 different racks</li>
<li>nodes have around 16-48GB ram, same amount of swap, which they alsmost never use</li>
<li>OS: Ubuntu Linux 12.04</li>
<li>CDH 5.1.0</li>
<li>impalad version 1.4.0-cdh5-INTERNAL RELEASE (build e801bd8c0d134e783c2313c7dd422a5ad06591af)</li>
<li>~100TB HDFS storage</li>
<li>we are using a HA proxy which points to the nodes with &gt;32GB ram</li>
<li>“workerlogs”-table is around 6-7TB big, partitioned by year &gt; month &gt; day and contains apache log-data</li>
<li>almost 100% short circuit reads</li>
</ul>
<hr>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>We found cause for the error - our firewall settings were to restrictive. Interestingly smaller queries without many query fragments worked even with these restrictive settings.</p>
<h3 id="另一种解决方法"><a href="#另一种解决方法" class="headerlink" title="另一种解决方法"></a>另一种解决方法</h3><p>发现impala daemon 进程因为端口不能正常释放导致进程僵死,而且cloudera manage 并不能很好的反应这个问题,只能在重启impala集群的时候,才能统一发现问题节点<br>登入上出问题的节点后,手动kill -9 结束impala daemon 进程等所有端口22000 释放后 重启impala角色</p>
<h3 id="之后怀疑是catalog中java堆栈不足导致"><a href="#之后怀疑是catalog中java堆栈不足导致" class="headerlink" title="之后怀疑是catalog中java堆栈不足导致"></a>之后怀疑是catalog中java堆栈不足导致</h3><p>因为其会存放所有的hive表,调大后问题依旧</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Upgrade/使用Packages升级到CDH 5.10.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Upgrade/使用Packages升级到CDH 5.10.html" itemprop="url">
                  使用Packages升级到CDH 5.10
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-03-22 00:00:00" itemprop="dateCreated datePublished" datetime="2017-03-22T00:00:00+08:00">2017-03-22</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2017-09-24 13:58:04" itemprop="dateModified" datetime="2017-09-24T13:58:04+08:00">2017-09-24</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Upgrade/" itemprop="url" rel="index"><span itemprop="name">Upgrade</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="使用Packages升级到CDH-5-10"><a href="#使用Packages升级到CDH-5-10" class="headerlink" title="使用Packages升级到CDH 5.10"></a>使用Packages升级到CDH 5.10</h1><blockquote>
<p><strong>v1.0</strong> updated:2017-03-22 Nameless13<br>角色最低要求：Cluster Administrator </p>
</blockquote>
<h2 id="步骤1：收集升级信息"><a href="#步骤1：收集升级信息" class="headerlink" title="步骤1：收集升级信息"></a>步骤1：收集升级信息</h2><p>开始升级之前，请收集以下信息：</p>
<ol>
<li>主机凭据。您必须具有SSH访问权限，并且能够使用root帐户或具有无密码sudo权限的帐户登录。</li>
<li>集群中使用的Cloudera Manager版本。转到支持 &gt; 关于。( Cloudera Enterprise 5.4.7)</li>
<li>在集群中部署的JDK的版本。转到支持 &gt; 关于。(Java 版本: 1.7.0_67)</li>
<li>CDH的版本。CDH版本号显示在主页上的集群名称旁边。(CDH 5.10.0, Parcel)</li>
<li>群集是使用Parcels或packages安装的。此信息显示在Cloudera Manager 主页上的CDH版本旁边。</li>
<li>集群中启用的服务。转到 Clusters &gt; Cluster name。</li>
<li>操作系统类型和版本。转到主机并单击列表中的主机名。操作系统类型和版本显示在“ 详细信息”部分的“ 分发”行中。</li>
<li>Sqoop，Oozie，Hue，Hive Metastore和Sentry Server使用的数据库的数据库信息（仅在集群中启用这些服务时才需要信息）。</li>
<li>收集以下信息：<ul>
<li>数据库类型（PostgreSQL，嵌入式PostgreSQL，MySQL，MariaDB或Oracle）</li>
<li>数据库的主机名</li>
<li>数据库的Credentials </li>
</ul>
</li>
</ol>
<p>如何查找数据库信息：</p>
<ul>
<li>Sqoop，Oozie和Hue - 转到群集名称 &gt; 配置 &gt; 数据库设置。</li>
<li>Hive Metastore - 转到Hive服务，选择配置，然后选择Hive Metastore Database类别。</li>
<li>Sentry - 转到Sentry服务，选择配置，然后选择Sentry服务器数据库类别。</li>
</ul>
<h2 id="步骤2：完成升级前步骤"><a href="#步骤2：完成升级前步骤" class="headerlink" title="步骤2：完成升级前步骤"></a>步骤2：完成升级前步骤</h2><ol>
<li>查看要升级到的新版本的CDH 5和Cloudera Manager 5要求和支持的版本。</li>
<li>阅读CDH 5发行说明。</li>
<li>阅读Cloudera安全公告。</li>
<li>确保跨集群安装了Java 1.7或1.8。有关安装说明和建议，请参阅在Cloudera Manager部署中升级到Oracle JDK 1.7或升级到Oracle JDK 1.8，并确保在继续升级之前已阅读Cloudera Manager 5中的已知问题和解决方法。</li>
<li><p>确保Cloudera Manager次要版本等于或大于 CDH次要版本。例如：</p>
<ul>
<li><p>目标CDH版本： 5.0.5<br>最低Cloudera Manager版本： 5.0.x</p>
</li>
<li><p>目标CDH版本： 5.8.2<br>最低Cloudera Manager版本： 5.8.x</p>
</li>
</ul>
</li>
<li><p>如果要从CDH 5.1或更低版本升级，并使用 Hive Date partition columns，则可能需要更新日期格式。请参阅日期分区列。</p>
</li>
<li>如果集群使用Impala，请检查您的SQL与&lt;a href=&quot;https://www.cloudera.com/documentation/enterprise/latest/topics/impala_incompatible_changes.html#incompatible_changes&quot;&gt;不兼容更改文档&lt;/a&gt;中列出的最新保留字冲突。如果在多个版本之间升级或出现任何问题，请检查Impala关键字的完整列表。</li>
<li>运行主机检查器并解决每个问题。转到Cluster &gt; Inspect Hosts。</li>
<li>运行安全检查器，修复错误报告。（转到  Administration &gt; Security，然后单击Security Inspector。）</li>
<li>以hdfs用户身份登录到任何集群节点，运行以下命令，并更正所有的错误报告<br><code>hdfs fsck /</code><br><strong>注意：在fsck 命令可能需要10分钟或更长时间才能完成，具体取决于集群中的文件数。</strong><br><code>hdfs dfsadmin -report</code></li>
<li>以hdfs用户身份登录到任何DataNode，运行以下命令，并更正任何报告的错误<br><code>hbase hbck</code></li>
<li>查看升级过程并保留分配足够时间以执行所有步骤的维护窗口。对于生产集群，Cloudera建议根据主机数量，使用Hadoop和Linux的经验以及您使用的特定硬件，分配一整天的维护时段来执行升级。</li>
<li>为了避免在升级过程中出现不必要的警报，请在开始升级之前在集群上启用维护模式。这会停止发送电子邮件警报和SNMP陷阱，但不会停止检查和配置验证。完成升级后，务必退出维护模式以重新启用Cloudera Manager警报。</li>
<li>如果已将Hue配置为使用TLS / SSL，并且正在从CDH 5.2或更低版本升级到CDH 5.3或更高版本，则Hue会验证CA证书并需要信任库。要创建信任库，请按照Hue中的说明作为TLS / SSL客户端。</li>
<li>如果群集使用Flume Kafka客户端，并且要升级到CDH 5.8.0或CDH 5.8.1，请在使用Flume Kafka Client时执行升级到CDH 5.8.0或CDH 5.8.1中描述的其他步骤，然后继续与本主题中的程序。</li>
<li><p>如果集群使用Impala和Llama，则该角色从CDH 5.9起已被弃用，并且必须在开始升级之前从Impala服务中删除该角色。如果不删除此角色，升级向导将暂停升级。</p>
<p>要确定Impala是否使用Llama：</p>
<ol>
<li>转到Impala服务。</li>
<li>选择实例选项卡。</li>
<li>检查“ 角色类型”列中的角色列表。如果出现Llama，Impala服务正在使用Llama。</li>
</ol>
<p>要删除Llama角色：</p>
<ol>
<li><p>转到Impala服务，选择操作 &gt; 禁用YARN和Impala集成资源管理。</p>
<p>将显示“ 禁用YARN和Impala集成资源管理”向导。</p>
</li>
<li><p>单击继续。</p>
<p>该禁止纱线和Impala的综合资源管理命令页面显示命令的进度禁用的作用。</p>
</li>
<li><p>命令完成后，单击完成。</p>
</li>
</ol>
</li>
</ol>
<h2 id="步骤3：停止群集服务"><a href="#步骤3：停止群集服务" class="headerlink" title="步骤3：停止群集服务"></a>步骤3：停止群集服务</h2><p>本节中的步骤仅需进行以下升级：</p>
<pre><code>CDH 5.0或5.1至5.2或更高
CDH 5.2或5.3至5.4或更高


</code></pre><ol>
<li>在主页 &gt; 状态选项卡上，单击集群名称的右侧，然后选择停止。</li>
<li>在确认屏幕中单击停止。“ 命令详细信息 ”窗口显示停止服务的进度。当所有服务成功停止时，任务完成，您可以关闭“ 命令详细信息 ”窗口。</li>
</ol>
<h2 id="步骤4：备份NameNode上的HDFS元数据"><a href="#步骤4：备份NameNode上的HDFS元数据" class="headerlink" title="步骤4：备份NameNode上的HDFS元数据"></a>步骤4：备份NameNode上的HDFS元数据</h2><p>本节中的步骤仅需进行以下升级：</p>
<pre><code>CDH 5.0或5.1至5.2或更高
CDH 5.2或5.3至5.4或更高


</code></pre><ol>
<li>转到HDFS服务。</li>
<li>单击配置选项卡。</li>
<li>在搜索字段中，搜索“NameNode Data Directories”并记下该值。</li>
<li>在活动的NameNode主机上，备份NameNode Data Directories属性中列出的目录。如果列出了多个目录，请备份一个目录，因为每个目录是完整的副本。例如，如果NameNode数据目录是/ data / dfs / nn，请以root身份执行以下操作：<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line"># cd /data/dfs/nn</div><div class="line"># tar -cvf /root/nn_backup_data.tar .</div></pre></td></tr></table></figure>
</p>
</li>
</ol>
<p>你应该看到这样的输出：<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">./</div><div class="line">./current/</div><div class="line">./current/fsimage</div><div class="line">./current/fstime</div><div class="line">./current/VERSION</div><div class="line">./current/edits</div><div class="line">./image/</div><div class="line">./image/fsimage</div></pre></td></tr></table></figure></p>
<p>如果NameNode数据目录中存在具有 extension <em>lock</em>的文件，则NameNode很有可能仍在运行。重复这些步骤，从关闭NameNode角色开始。</p>
<h2 id="步骤5：备份数据库"><a href="#步骤5：备份数据库" class="headerlink" title="步骤5：备份数据库"></a>步骤5：备份数据库</h2><p><strong>注意：备份数据库需要停止某些服务，这可能会使其在备份期间不可用</strong><br>备份部署在群集中的以下任何服务的数据库：</p>
<table>
<thead>
<tr>
<th>服务</th>
<th>在哪里可以找到数据库信息</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sqoop</td>
<td>转到集群 &gt; 集群名称 &gt; Sqoop服务 &gt; 配置并选择数据库类别。</td>
</tr>
<tr>
<td>HUE</td>
<td>转到集群 &gt; 集群名称 &gt; Hue服务 &gt; 配置并选择数据库类别。</td>
</tr>
<tr>
<td>Oozie</td>
<td>转到群集 &gt; 群集名称 &gt; Oozie服务 &gt; 配置并选择数据库类别。</td>
</tr>
<tr>
<td>Cloudera Navigator Audit Server</td>
<td>转到集群 &gt; Cloudera管理服务 &gt; 配置并选择数据库类别。</td>
</tr>
<tr>
<td>Cloudera Navigator Metadata Server</td>
<td>转到集群 &gt; Cloudera管理服务 &gt; 配置并选择数据库类别。</td>
</tr>
<tr>
<td>Activity Monitor</td>
<td>转到集群 &gt; Cloudera管理服务 &gt; 配置并选择数据库类别。</td>
</tr>
<tr>
<td>Reports Manager</td>
<td>转到集群 &gt; Cloudera管理服务 &gt; 配置并选择数据库类别。</td>
</tr>
<tr>
<td>Sentry Server</td>
<td>转到群集 &gt; 群集名称 &gt; Sentry服务 &gt; 配置并选择Sentry服务器数据库类别。</td>
</tr>
<tr>
<td>Hive Metastore</td>
<td>转到集群 &gt; 集群名称 &gt; Hive服务 &gt; 配置并选择Hive Metastore数据库类别。</td>
</tr>
</tbody>
</table>
<p>备份数据库：</p>
<ol>
<li>如果尚未停止，请停止服务：<ol>
<li>在主页 &gt; 状态选项卡上，单击服务名称的右侧，然后选择停止。</li>
<li>在下一个屏幕中单击停止以确认。当您看到已完成状态时，服务已停止。</li>
</ol>
</li>
<li>备份数据库。有关每种支持的数据库类型的详细说明，请参阅备份数据库。</li>
<li>重新启动服务：<ol>
<li>在主页 &gt; 状态选项卡上，单击服务名称的右侧，然后选择开始。</li>
<li>单击出现在下一屏幕中的开始以确认。当您看到已完成状态时，服务已启动。</li>
</ol>
</li>
</ol>
<h2 id="步骤6：运行升级向导"><a href="#步骤6：运行升级向导" class="headerlink" title="步骤6：运行升级向导"></a>步骤6：运行升级向导</h2><ol>
<li>从主页 &gt; 状态选项卡，单击集群名称旁边的并选择升级集群。<br>此时将显示升级向导的“ 入门”页面。</li>
<li>如果显示在packages and parcels 之间选择的选项，请选择 <strong>Use Parcels</strong>。</li>
<li>在“ 选择CDH版本（Parcels）”字段中，选择CDH版本。如果未列出Parcels，或者要升级到其他版本，请单击“ 修改远程Parcels存储库URL”链接，转到远程Parcels存储库URL的配置页面，并将相应的URL添加到配置。有关输入Parcels存储库的正确URL的信息，请参阅&lt;a href=&quot;https://www.cloudera.com/documentation/enterprise/latest/topics/cm_ig_parcels.html#cmug_topic_7_11_5&quot;&gt;Parcel配置设置&lt;/a&gt;。单击继续。</li>
<li>阅读升级前必须完成的步骤的注意事项，完成步骤后单击 <strong>Yes, I …</strong>复选框，然后单击继续。Cloudera Manager验证主机是否安装了正确的软件。</li>
<li>单击继续。     Host Inspector运行并在主机上显示CDH版本。</li>
<li><p>单击继续。    “ Choose Upgrade Procedure”屏幕显示可用的升级类型：</p>
<ul>
<li>Full Cluster Restart - Cloudera Manager执行所有服务升级并重新启动集群。</li>
<li>Manual upgrade Cloudera Manager将群集配置为指定的CDH版本，但不执行任何升级或服务重新启动。手动升级很困难，只适用于高级用户。要执行手动升级：<ol>
<li>选中”Let me upgrade the cluster”复选框。</li>
<li>单击继续。</li>
<li>有关所需的步骤，请参阅手动执行升级向导操作。</li>
</ol>
</li>
</ul>
</li>
<li><p>选择<strong>Full Cluster Restart</strong>。</p>
</li>
<li><p>单击继续。<br>“Upgrade Cluster Command”屏幕显示向导在关闭所有服务，激活新Parcels，升级服务，部署客户端配置文件和重新启动服务时运行的命令的结果。如果任何步骤失败，请更正所有错误报告，然后单击重试按钮。如果单击“ 中止 ”按钮，则将启用右上方的“ 重试 ”按钮。</p>
<p>单击重试以重试该步骤并继续向导，或单击Cloudera Manager徽标返回<strong>Home</strong> &gt; <strong>Status</strong>选项卡，然后手动执行失败的步骤和所有后续步骤。</p>
</li>
<li><p>单击继续。</p>
<p>向导将报告升级的结果。</p>
<p>如果先前使用packages安装或升级了集群，向导可能会指示某些服务无法启动，因为其Parcels不可用。要下载所需的Parcels：</p>
<pre><code>1. 在另一个浏览器选项卡中，打开Cloudera Manager Admin Console。
1. 选择 Hosts  &gt; Parcels。
1. 找到包含缺少的Parcels的行，然后单击按钮以下载，Distribute，然后激活Parcels。
1. 返回升级向导并单击重试按钮。
1. 升级向导继续升级集群。

</code></pre></li>
<li><p>单击完成返回主页。</p>
</li>
</ol>
<h2 id="步骤7：从失败的步骤恢复或执行手动升级"><a href="#步骤7：从失败的步骤恢复或执行手动升级" class="headerlink" title="步骤7：从失败的步骤恢复或执行手动升级"></a>步骤7：从失败的步骤恢复或执行手动升级</h2><p>“手动执行升级向导操作”中列出了升级向导执行的操作。如果“ 升级群集命令”屏幕中的任何步骤失败，请在继续之前完成该部分中所述的步骤。</p>
<h2 id="步骤8：删除以前的CDH版本包和刷新符号链接"><a href="#步骤8：删除以前的CDH版本包和刷新符号链接" class="headerlink" title="步骤8：删除以前的CDH版本包和刷新符号链接"></a>步骤8：删除以前的CDH版本包和刷新符号链接</h2><p>如果先前的安装或升级使用Parcels，请跳过此步骤。</p>
<p>如果先前安装的CDH是使用packages完成的，请在安装了packages的所有主机上删除这些packages，并刷新符号链接，以便客户端运行新的软件版本。</p>
<ol>
<li>如果您的Hue服务使用嵌入式SQLite数据库，请备份 /var/lib/hue/desktop.db 到 /var/lib/hue以外的位置因为在删除packages时会删除此目录。</li>
<li><p>卸载每个主机上的CDHpackages：</p>
<ul>
<li>不包括Impala和Search<br><code>sudo zypper remove bigtop-utils bigtop-jsvc bigtop-tomcat hue-common sqoop2-client</code></li>
<li>包括Impala和Search<br><code>sudo zypper remove&#39;bigtop- *&#39;hue-common impala-shell solr-server sqoop2-client hbase-solr-doc avro-libs crunch-doc avro-doc solr-doc</code></li>
</ul>
</li>
<li><p>重新启动所有Cloudera Manager Agent以强制更新符号链接，以指向每个主机上新安装的组件：<br><code>sudo service cloudera-scm-agent restart</code></p>
</li>
<li>如果您的Hue服务使用嵌入式SQLite数据库，请还原您备份的数据库：<ol>
<li>停止Hue服务。</li>
<li>将备份从临时位置复制到新创建的Hue数据库目录中，/var/lib/hue。</li>
<li>启动Hue服务。</li>
</ol>
</li>
</ol>
<h2 id="步骤9：完成HDFS元数据升级"><a href="#步骤9：完成HDFS元数据升级" class="headerlink" title="步骤9：完成HDFS元数据升级"></a>步骤9：完成HDFS元数据升级</h2><p>本节中的步骤仅需进行以下升级：</p>
<pre><code>CDH 5.0或5.1至5.2或更高
CDH 5.2或5.3至5.4或更高


</code></pre><p>要确定是否可以完成，请以important workloads运行以确保它们能成功。一旦升级完成后，将无法使用备份即无法回滚到先前版本的HDFS。验证您是否已完成升级可能需要很长时间。</p>
<p>请确保您有足够的可用磁盘空间，请记住以下行为，直到升级完成：</p>
<ul>
<li>删除文件不会释放磁盘空间。</li>
<li>使用balancer会导致所有移动的副本被复制。</li>
<li>表示NameNodes元数据的所有磁盘数据都被保留，这可以将NameNode和JournalNode磁盘所需的空间大小增加一倍。</li>
</ul>
<p>要完成元数据升级：</p>
<ul>
<li>转到HDFS服务。</li>
<li>单击Instances选项卡。</li>
<li>单击NameNode实例。</li>
<li>选择Actions&gt;Finalize Metadata Upgrade，然后单击 Finalize Metadata Upgrade以确认。<h2 id="步骤10：退出维护模式"><a href="#步骤10：退出维护模式" class="headerlink" title="步骤10：退出维护模式"></a>步骤10：退出维护模式</h2>如果在此升级期间进入维护模式，请退出维护模式。</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Document/12-20 微信商学院-开发者培训班.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Document/12-20 微信商学院-开发者培训班.html" itemprop="url">
                  12-20 微信商学院-开发者培训班
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2016-12-20 00:00:00" itemprop="dateCreated datePublished" datetime="2016-12-20T00:00:00+08:00">2016-12-20</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2017-09-24 13:58:04" itemprop="dateModified" datetime="2017-09-24T13:58:04+08:00">2017-09-24</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Document/" itemprop="url" rel="index"><span itemprop="name">Document</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="12-20-微信商学院-开发者培训班"><a href="#12-20-微信商学院-开发者培训班" class="headerlink" title="12-20 微信商学院-开发者培训班"></a>12-20 微信商学院-开发者培训班</h1><h3 id="小程序是什么"><a href="#小程序是什么" class="headerlink" title="小程序是什么"></a>小程序是什么</h3><ul>
<li><a href="https://mp.weixin.qq.com/" target="_blank" rel="noopener">https://mp.weixin.qq.com/</a></li>
<li>开发者社区 <a href="http://developers.weixin.qq.com/" target="_blank" rel="noopener">http://developers.weixin.qq.com/</a></li>
<li>一种连接用户和服务的方式</li>
<li>一个全新的生态</li>
<li>一套解决方案</li>
<li>AppService 应用逻辑层,实现交互和业务逻辑处理,生命周期管理</li>
<li>JSBrigdge</li>
</ul>
<hr>
<h3 id="小程序的优点"><a href="#小程序的优点" class="headerlink" title="小程序的优点"></a>小程序的优点</h3><ul>
<li>不是H5(算是类web应用,基于H5开发但是可以调用微信native API,缺点是不能对API进行定制)</li>
<li>基于微信</li>
<li>原生体验</li>
<li>解决方案</li>
<li>即用即走,随手可得</li>
<li>拥有离线能力</li>
<li>一次开发,多端兼容</li>
<li>优秀的操作系统</li>
<li>在安卓上的适配是最优的</li>
</ul>
<h3 id="小程序的接入流程"><a href="#小程序的接入流程" class="headerlink" title="小程序的接入流程"></a>小程序的接入流程</h3><p>注册-&gt;开发-&gt;提交审核-&gt;发布</p>
<p><em>邮箱不能注册过其他组件(公众号,企业号等)</em></p>
<ul>
<li>只有管理员才能上传代码</li>
<li>公测期间不支持发布</li>
<li>不能做营销和游戏</li>
<li>不做收集用户隐私的接口</li>
<li>便捷:尽量减少输入,避免误操作</li>
<li>统一:视觉统一,WeUI(可以根据它来调整,由自己的品牌来定制)</li>
<li>审核规范:判断原则<ul>
<li>真实性,一致性(信息一一对应),稳定性,合法性</li>
<li>常见拒绝原因:demo版本或trial版本,或仍存在bug<ul>
<li>提供的服务属于暂未开放的服务范围</li>
<li>名称,简介,logo,服务范围没有对应关系</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>单页面应用 Single Page Application</li>
<li>动态加载</li>
<li>Framework Overview</li>
<li>10M稳定存储能力,</li>
<li>jssdk -&gt;小程序的API</li>
<li>API 拥有调取Native 系统层能力</li>
<li>Page Frame<ul>
<li>预先加载一个web view</li>
<li>当打开指定页面时,无需请求额外资源,直接渲染</li>
<li>init–&gt;ready–&gt;nav–&gt;ready-&gt;(从右边)push(100-200ms)(开发者最好自己也做一些点击态)</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>App Service -Manager<ul>
<li>App() 小程序入口</li>
<li>Page() 页面入口</li>
</ul>
</li>
<li>App Service -Life Cycle<ul>
<li>Native加载两个线程 (view, App Service)</li>
<li>redirect (越过5层页面层级限制)</li>
</ul>
</li>
<li>App Service -API<ul>
<li>通过JSbridge同客户端通信</li>
<li>用户信息,微信支付,模版消息,网络通信,本地存储等等</li>
</ul>
</li>
<li>View - Hybrid 混合应用<ul>
<li>凌驾于web view</li>
<li>web-like 开发方式</li>
<li>App-like 用户体验</li>
</ul>
</li>
<li>View -WXML<ul>
<li>支持逻辑,算数计算</li>
<li>支持模版,引用</li>
<li>(WXML)compiler–&gt;(JS:generateFunc)date–&gt;(Virtual Tree)Virtual DOM–&gt;(View DOM)</li>
</ul>
</li>
<li>View -WXSS<ul>
<li>自适应单位RPX- Responsive Pixel</li>
<li>无级联(但是其实还是可以用的用)-避免被组件内结构破坏(最好别用)</li>
<li>(WXSS)Compiler–&gt;(JS)Width,DPR–&gt;(CSS)</li>
</ul>
</li>
<li>View -Render<ul>
<li>数据M 和视图V 完全分离</li>
<li>逻辑层运行在独立的环境中,无法直接操作DOM</li>
<li>使用WXML模版语言减少维护成本</li>
<li>单项数据绑定</li>
</ul>
</li>
</ul>
<h3 id="Virtual-DOM"><a href="#Virtual-DOM" class="headerlink" title="Virtual-DOM"></a>Virtual-DOM</h3><ul>
<li>生成和DOM tree – 对应的Virtual Tree</li>
<li>对比新Tree和旧Tree的不同</li>
<li>将这些不同的点应用到DOM Tree中</li>
<li>动态改变的节点需要加上WX:key 来做节点的唯一标示</li>
<li>wx:if,wx:for,template增加一个&lt;virtual/&gt;的节点</li>
<li>diff</li>
<li>native 凌驾于webview 有些webview层中的一些事件(比如滑动)不能在原生环境中监听</li>
</ul>
<hr>
<h2 id="技术人员分享"><a href="#技术人员分享" class="headerlink" title="技术人员分享"></a>技术人员分享</h2><ul>
<li>单向数据流 </li>
<li>局部化组件</li>
<li>不携带cookie</li>
<li>globalData事件订阅</li>
<li>页面传值</li>
<li>server层</li>
<li>1M限制(用图片替代代码来越过限制,不推荐)</li>
<li>react与小程序语法替换关系<ul>
<li>state ==&gt; data</li>
<li>setState ==&gt; setData</li>
<li>array.map ==&gt; war.map</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Document/weixin.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Document/weixin.html" itemprop="url">
                  weixin
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2016-12-20 00:00:00" itemprop="dateCreated datePublished" datetime="2016-12-20T00:00:00+08:00">2016-12-20</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2017-09-24 13:58:04" itemprop="dateModified" datetime="2017-09-24T13:58:04+08:00">2017-09-24</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Document/" itemprop="url" rel="index"><span itemprop="name">Document</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>微信小程序中的每一个页面的【路径+页面名】都需要写在 app.json 的 pages 中，且 pages 中的第一个页面是小程序的首页。</p>
<p>通过全局函数 getApp() 可以获取全局的应用实例，如果需要全局的数据可以在 App() 中设置</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">对象</div><div class="line">&lt;template is=&quot;objectCombine&quot; data=&quot;&#123;&#123;for: a, bar: b&#125;&#125;&quot;&gt;&lt;/template&gt;</div><div class="line">Page(&#123;</div><div class="line">  data: &#123;</div><div class="line">    a: 1,</div><div class="line">    b: 2</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line">最终组合成的对象是 &#123;for: 1, bar: 2&#125;</div><div class="line"></div><div class="line">也可以用扩展运算符 ... 来将一个对象展开</div><div class="line"></div><div class="line">&lt;template is=&quot;objectCombine&quot; data=&quot;&#123;&#123;...obj1, ...obj2, e: 5&#125;&#125;&quot;&gt;&lt;/template&gt;</div><div class="line">Page(&#123;</div><div class="line">  data: &#123;</div><div class="line">    obj1: &#123;</div><div class="line">      a: 1,</div><div class="line">      b: 2</div><div class="line">    &#125;,</div><div class="line">    obj2: &#123;</div><div class="line">      c: 3,</div><div class="line">      d: 4</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Document/Docker入门到实践.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Document/Docker入门到实践.html" itemprop="url">
                  Docker入门到实践
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2016-10-20 00:00:00" itemprop="dateCreated datePublished" datetime="2016-10-20T00:00:00+08:00">2016-10-20</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2017-09-24 13:58:04" itemprop="dateModified" datetime="2017-09-24T13:58:04+08:00">2017-09-24</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Document/" itemprop="url" rel="index"><span itemprop="name">Document</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Docker–入门到实践"><a href="#Docker–入门到实践" class="headerlink" title="Docker–入门到实践"></a>Docker–入门到实践</h1><p>Virtuial Machines<br>each virtualized application includes not nonly the application - which may be only 10s of MB -and the necessary binaries,but also an entire guest operating system - which may weigh 10s of GB</p>
<hr>
<p>Docker<br>The Docker Engine container comprises just the application and its dependencies. it runs aas an isolated process in userspace on the host operating system,sharing the kernel with other containers. Thus,it enjoys the resource and allocation benefits of VMs but is much more portable and efficient.</p>
<hr>
<p>容器除了运行其中的应用外,基本不消耗额外的系统资源,使得应用性能很高,同事系统的开销尽量小,相比传统虚拟机方式运行10个不同的应用要起10个虚拟机,而Docker只需要启动10个隔离应用即可.</p>
<table>
<thead>
<tr>
<th style="text-align:left">特性</th>
<th style="text-align:left">容器</th>
<th style="text-align:left">虚拟机</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">启动</td>
<td style="text-align:left">秒级</td>
<td style="text-align:left">分钟级</td>
</tr>
<tr>
<td style="text-align:left">硬盘使用</td>
<td style="text-align:left">一般为MB</td>
<td style="text-align:left">一般为GB</td>
</tr>
<tr>
<td style="text-align:left">性能</td>
<td style="text-align:left">接近原生</td>
<td style="text-align:left">弱于</td>
</tr>
<tr>
<td style="text-align:left">系统支持量</td>
<td style="text-align:left">单机支持上千个容器</td>
<td style="text-align:left">一般几十个</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><ul>
<li>镜像(Image)</li>
</ul>
<p>Docker镜像就是一个只读的模版,如可以包含一个完整的操作系统里面仅安装了Apache<br>镜像可以用来创建Docker容器<br>Docker提供了一个很简单的机制来创建镜像或者更新现有镜像,或者拿一个做好的镜像直接使用</p>
<hr>
<ul>
<li>容器(Container)</li>
</ul>
<p>Docker利用容器俩运行运用<br>容器是从镜像创建的运行实例.可以被启动,开始停止,删除.每个容器容器都是相互隔离的,保证安全的平台<br>可以把容器看作是一个简易版的Linux环境 (包括root用户权限,进程空间,用户空间和网络空间等)和运行在其中的应用程序</p>
<p>// 镜像是只读的,容器在启动的时候创建一层<code>可写层</code>作为最上层</p>
<hr>
<ul>
<li>仓库(Repository)</li>
</ul>
<p>仓库是几种存放镜像文件的场所.仓库注册服务器上往往存放多个仓库,每个仓库中又包含多个镜像,每个镜像有不同的标签(tag)</p>
<p>仓库分为公开仓库(Public)和私有仓库(Private)</p>
<p>最大的公开仓库是Docker Hub,国内公开仓库有Docker Pool</p>
<p>用户可以本地网络内创建一个私有仓库,当创建了自己的镜像后可使用<code>push</code>命令上传到仓库,命令<code>pull</code>从仓库下载</p>
<hr>
<h2 id="CentOS-系列安装Docker"><a href="#CentOS-系列安装Docker" class="headerlink" title="CentOS 系列安装Docker"></a>CentOS 系列安装Docker</h2><p><code>docker pull hub.c.163.com/public/&lt;centos:7 class=&quot;0&quot;&gt;&lt;/centos:7&gt;</code></p>
<p><code>docker run -t -i hub.c.163.com/public/centos:7.0 /bin/bash</code><br>-t  选项让Docker分配一个伪终端（pseudo-tty）并绑定到容器的标准输入上，  -i  则让容器的标准输入保持打开</p>
<p><code>docker run -t -i training/sinatra /bin/bash</code>  //会下载一个新的…镜像</p>
<p>当利用<code>docker run</code> 创建容器时,Docker在后台运行的标准是:</p>
<ul>
<li>检查本地是否存在指定的镜像,不存在就从公有仓库下载</li>
<li>利用镜像创建并启动一个容器</li>
<li>分配一个文件系统,并在只读的镜像层外面挂载一层可读写成</li>
<li>从宿主主机配置的网桥接口中桥接一个虚拟接口道容器中去</li>
<li>从地址池配置一个IP地址给容器</li>
<li>执行用户指定的应用程序</li>
</ul>
<p><code>docker commit -m &quot;Added git&quot; -a &quot;Docker Newbee&quot; 40c9fe0a35ef centos:v2</code></p>
<hr>
<p><code>docker run -t -i hub.c.163.com/public/centos:7.0 /bin/bash</code><br><code>-t 让Docker分配一个伪终端(pseudo-tty)并绑定到容器的标准输入上,-i 让容器的标准输入保持打开</code></p>
<p>当利用docker run 创建容器时,Docker在后台运行的标准操作包括:</p>
<ul>
<li>检查本地是否存在指定的镜像,不存在就从公有仓库下载</li>
<li>利用镜像创建并启动一个容器</li>
<li>分配一个文件系统,并在只读的镜像层外面挂载一层可读写层</li>
<li>从宿主主机配置的网桥接口中桥接一个虚拟接口道容器中去</li>
<li>从地址池配置一个ip地址给容器</li>
<li>执行用户指定的应用程序</li>
<li>执行完毕后容器被终止</li>
</ul>
<h4 id="启动已终止容器"><a href="#启动已终止容器" class="headerlink" title="启动已终止容器"></a>启动已终止容器</h4><p>利用 <code>docker start</code> ,直接将一个已经终止的容器启动运行<br>容器的核心为所执行的应用程序,所需要的资源都是应用程序运行必需的.</p>
<h4 id="后台background运行"><a href="#后台background运行" class="headerlink" title="后台background运行"></a>后台background运行</h4><p>需要让docker在后台运行</p>
<hr>
<p>安装 `.bashrc_docker</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">wget -P ~ https://github.com/yeasy/docker_practice/raw/master/_local/.bashrc_docker</div><div class="line"><span class="built_in">echo</span> <span class="string">"[ -f ~/.bashrc_docker ] &amp;&amp; . ~/.bashrc_docker"</span> &gt;&gt; ~/.bashrc; <span class="built_in">source</span> ~/.bashrc</div><div class="line"></div><div class="line"><span class="built_in">echo</span> $(docker-pid docker)</div></pre></td></tr></table></figure>
</p>
<hr>
<h2 id="redis-master"><a href="#redis-master" class="headerlink" title="redis-master"></a>redis-master</h2><p><code>docker run --name redis-master -v /home/testuser/docker/master-redis.conf:/usr/local/etc/master-redis.conf -d -p 16397:16379 redis redis-server /usr/local/etc/master-redis.conf</code></p>
<h2 id="redis-slave"><a href="#redis-slave" class="headerlink" title="redis-slave"></a>redis-slave</h2><p><code>docker run --link redis-master:redis-master -v /home/testuser/docker/slave-redis.conf:/usr/local/etc/slave-redis.conf --name redis-slave1 -d redis redis-server /usr/local/etc/slave-redis.conf</code></p>
<h4 id="宿主机上如何获得-docker-container-容器的-ip-地址？"><a href="#宿主机上如何获得-docker-container-容器的-ip-地址？" class="headerlink" title="宿主机上如何获得 docker container 容器的 ip 地址？"></a>宿主机上如何获得 docker container 容器的 ip 地址？</h4><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">docker inspect --format=&apos;&#123;&#123;.NetworkSettings.IPAddress&#125;&#125;&apos; $CONTAINER_ID</div></pre></td></tr></table></figure>
</p>
<h3 id="在Docker容器内外互相拷贝数据"><a href="#在Docker容器内外互相拷贝数据" class="headerlink" title="在Docker容器内外互相拷贝数据"></a>在Docker容器内外互相拷贝数据</h3><h4 id="从容器内拷贝文件到主机上"><a href="#从容器内拷贝文件到主机上" class="headerlink" title="从容器内拷贝文件到主机上"></a>从容器内拷贝文件到主机上</h4><p><code>docker cp &lt;containerId&gt;:/file/path/within/container /host/path/target</code></p>
<p>没试验过</p>
<h4 id="从主机上拷贝文件到容器内"><a href="#从主机上拷贝文件到容器内" class="headerlink" title="从主机上拷贝文件到容器内"></a>从主机上拷贝文件到容器内</h4><ol>
<li><p>用-v挂载主机数据卷到容器内<br><code>docker run -v /path/to/hostdir:/mnt $container</code><br>在容器内拷贝<br><code>cp /mnt/sourcefile /path/to/destfile</code></p>
</li>
<li><p>直接在主机上拷贝到容器物理存储系统</p>
<ol>
<li>获取容器名称或者id : <code>docker ps</code></li>
<li><p>获取整个容器的id: </p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">docker inspect -f   <span class="string">'&#123;&#123;.Id&#125;&#125;'</span>  [获取的名称或者id]</div></pre></td></tr></table></figure>
</p>
</li>
<li><p>在主机上拷贝文件: <code>cp path-file-host /var/lib/docker/devicemapper/mnt/[获取的名称或者id]/rootfs/root</code></p>
</li>
</ol>
</li>
</ol>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line"></div><div class="line">1.</div><div class="line">[testuser@CentOS1 docker]<span class="variable">$docker</span> ps</div><div class="line">CONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                                NAMES</div><div class="line">01a349ea86bd        redis               <span class="string">"docker-entrypoint.s   42 minutes ago      Up 42 minutes       6379/tcp                             redis-slave3        </span></div><div class="line">bd45650a61f6        redis               "docker-entrypoint.s   43 minutes ago      Up 43 minutes       6379/tcp                             redis-slave2        </div><div class="line">ce2321f0d4d5        redis               <span class="string">"docker-entrypoint.s   46 minutes ago      Up 46 minutes       6379/tcp                             redis-slave1        </span></div><div class="line">9408dd71f9e9        redis               "docker-entrypoint.s   54 minutes ago      Up 54 minutes       6379/tcp, 0.0.0.0:16397-&gt;16379/tcp   redis-master </div><div class="line"></div><div class="line"></div><div class="line">2. </div><div class="line">[testuser@CentOS1 docker]$ docker inspect -f <span class="string">'&#123;&#123;.Id&#125;&#125;'</span> 9408dd71f9e9</div><div class="line">9408dd71f9e943b6ed08dd146e20700439eef280db7ce914852452340bfbfbbe</div><div class="line"></div><div class="line"></div><div class="line">3.</div><div class="line">[root@CentOS1 ~]<span class="comment">#cp sentinel.conf /var/lib/docker/devicemapper/mnt/9408dd71f9e943b6ed08dd146e20700439eef280db7ce914852452340bfbfbbe/rootfs/root/</span></div></pre></td></tr></table></figure>
</p>
<h4 id="退出容器而不停止容器"><a href="#退出容器而不停止容器" class="headerlink" title="退出容器而不停止容器"></a>退出容器而不停止容器</h4><p>组合键：Ctrl+P+Q</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Document/ubuntu的网络配置.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Document/ubuntu的网络配置.html" itemprop="url">
                  ubuntu的网络配置
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2016-10-20 00:00:00" itemprop="dateCreated datePublished" datetime="2016-10-20T00:00:00+08:00">2016-10-20</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2017-09-24 13:58:04" itemprop="dateModified" datetime="2017-09-24T13:58:04+08:00">2017-09-24</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Document/" itemprop="url" rel="index"><span itemprop="name">Document</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ubuntu的网络配置"><a href="#ubuntu的网络配置" class="headerlink" title="ubuntu的网络配置"></a>ubuntu的网络配置</h1><h2 id="有线连接互联网"><a href="#有线连接互联网" class="headerlink" title="有线连接互联网"></a>有线连接互联网</h2><ol>
<li>Ubuntu使用两条配置线路   /etc/network/interfaces这个配置文件主要用于服务器版本的Ubuntu系统使用;<br>当/etc/NetworkManager/NetworkManager.conf  中managed=false ，以interfaces文件中的配置为准， </li>
<li>为了适应移动办公造成ip和网络环境不断变化,上网配置在/networkManager/NetworkManager.conf<br>/etc/NetworkManager/NetworkManager.conf  中managed=true ，以本配置为准。</li>
</ol>
<p><code>sudo ifconfig</code> #示所有网卡的接口信息  如果你看到 eth0  —- 有线网卡 wlan0 — 表示 无线网卡 这样几个模块说明你的网卡已经安装好了。(要用lspci -vnn -d 14e4 :查看网卡信息 ，网上下载合适的驱动))</p>
<p>sudo pppoeconf   # 调出 pppoe有线拨号上网的配置界面，按提示进行配置<br>sudo pon dsl-provider    # 建立连接<br>sudo poff        # 终止连接<br>sudo vim /etc/network/interfaces<br>修改interfaces 文件如下：让系统开机时自己连接上有线网络</p>
<p>`</p>
<pre><code>#interfaces(5) file used by ifup(8) and ifdown(8)
auto lo
iface lo inet loopback

auto dsl-provider
iface dsl-provider inet ppp
pre-up /sbin/ifconfig eth0 up # line maintained by pppoeconf
provider dsl-provider
auto eth0
iface eth0 inet manual

</code></pre><p>`</p>
<p>sudo etc/init.d/networking restart  ##配置完毕，终端命令重启网络配置</p>
<hr>
<p>在调试过程中 常用的网络调试命令是<br>sudo stop network-manager   #禁用和启用网络管理面板<br>sudo start network-manager<br>sudo etc/init.d/networking restart   #重启网络配置<br>sudo ifconfig eth0 down<br>sudo ifconfig eth0 up    #禁用和启用有线网卡</p>
<hr>
<h2 id="无线连接互联网"><a href="#无线连接互联网" class="headerlink" title="无线连接互联网"></a>无线连接互联网</h2><p>iwconfig  wlan0   #显示无线网卡联网情况<br>iwlist wlan0 scan    #扫描无线网络<br>sudo iwconfig wlan0 essid 【account】  key  【password】</p>
<p>dhclient wlan0   #自动获取ip地址<br>ifconfig wlan0 down  #关闭网卡<br>ifconfig wlan0 up    #启动网卡<br>ping  192.168.1.1  # 拼网关，检测是否已能联上网</p>
<h2 id="wifi故障情况分析"><a href="#wifi故障情况分析" class="headerlink" title="wifi故障情况分析"></a>wifi故障情况分析</h2><p>情况是网速非常慢，ping 网关速度慢，ping外网没网络。<br>终端执行如下命令：<br>lspci -vnn -d 14e4  查看网卡型号，和现用驱动<br>比对下表查看自己的驱动是否安装正确<br><a href="http://askubuntu.com/questions/55868/installing-broadcom-wireless-drivers?lq=1" target="_blank" rel="noopener">http://askubuntu.com/questions/55868/installing-broadcom-wireless-drivers?lq=1</a> 的<br>BROADCOM WIRELESS TABLE (Updated 31 March 2014) 表</p>
<hr>
<p>sudo apt-update<br>sudo apt-get remove –purge bcmwl-kernel-source   #卸载当前驱动 bcmwl-kernel-source<br>sudo modprobe -r b43 ssb wl brcmfmac  # 移除你看到的驱动模块 b43, ssb ….. 是 驱动模块名<br>sudo apt-get reinstall install bcmwl-kernel-source     #安装新驱动，可以到ubuntu的软件中心安装<br>sudo modprobe wl 加载新驱动模块到linux内核</p>
<p>到/etc/modprobe.d/中去删除 冗余的 .conf 配置，并检查文件 blacklist 中是否把新装的驱动在屏蔽范围内，如有则解除屏蔽。<br>sudo rm /etc/modprobe.d/blacklist-bcm43.conf<br>sudo rm /etc/modprobe.d/broadcom-sta-common.conf<br>sudo rm /etc/modprobe.d/broadcom-sta-dkms.conf<br> sudo sed -i “s/blacklist b43/#blacklist b43/g” $(egrep -lo ‘blacklist b43’ /etc/modprobe.d/<em>)<br>sudo sed -i “s/blacklist ssb/#blacklist ssb/g” $(egrep -lo ‘blacklist ssb’ /etc/modprobe.d/</em>)<br>sudo sed -i “s/blacklist bcma/#blacklist bcma/g” $(egrep -lo ‘blacklist bcma’ /etc/modprobe.d/*)</p>
<p>网卡的驱动属于外设驱动，可到 System &gt; Administration &gt; Hardware/Additional Drivers<br>查看网卡状态，ubuntu 14.04，是在  系统设置 &gt; 软件和更新 &gt; 附加驱动 查看</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/14/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><span class="page-number current">15</span><a class="page-number" href="/page/16/">16</a><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/16/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="Nameless13" />
            
              <p class="site-author-name" itemprop="name">Nameless13</p>
              <p class="site-description motion-element" itemprop="description">─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">164</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">33</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Nameless13</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动 v3.4.3</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Mist</a> v6.3.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



	





  





  










  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=6.3.0"></script>



  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
