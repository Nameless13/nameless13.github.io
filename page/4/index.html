<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: 'J3OX6892F7',
      apiKey: '38852eb9095216f8f2ada575a06a9cfc',
      indexName: 'Blog',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
<meta property="og:type" content="website">
<meta property="og:title" content="Nameless13">
<meta property="og:url" content="https://nameless13.github.io/page/4/index.html">
<meta property="og:site_name" content="Nameless13">
<meta property="og:description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Nameless13">
<meta name="twitter:description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">






  <link rel="canonical" href="https://nameless13.github.io/page/4/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Nameless13</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Nameless13</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Installation/Linux 修改时区.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Installation/Linux 修改时区.html" itemprop="url">
                  Linux 修改时区
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:35 / 修改时间：23:12:06" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">2018-05-23</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Installation/" itemprop="url" rel="index"><span itemprop="name">Installation</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="linux-修改时区"><a href="#linux-修改时区" class="headerlink" title="linux 修改时区"></a>linux 修改时区</h1><p>在linux中与时间相关的文件有</p>
<ol>
<li><code>/etc/localtime</code></li>
<li><code>/etc/timezone</code></li>
</ol>
<p>其中，/etc/localtime是用来描述本机时间，而 /etc/timezone是用来描述本机所属的时区。</p>
<h2 id="修改本机时间"><a href="#修改本机时间" class="headerlink" title="修改本机时间"></a>修改本机时间</h2><p><code>cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</code></p>
<p>在/usr/share/zoneinfo下存放着不同时区格式的时间文件，执行以下命令，可以将本机时间调整至目标时区的时间格式。<br>但是！调整了时间格式，本机所属的时区是保持不变的！</p>
<h2 id="修改本机时区"><a href="#修改本机时区" class="headerlink" title="修改本机时区"></a>修改本机时区</h2><p>在linux中，有一些程序会自己计算时间，不会直接采用带有时区的本机时间格式，会根据UTC时间和本机所属的时区等计算出当前的时间。<br>比如jdk应用，时区为“Etc/UTC”，本机时间改为北京时间，通过java代码中new 出来的时间还是utc时间，所以必须得修正本机的时区。</p>
<p><code>echo &#39;Asia/Shanghai&#39; &gt;/etc/timezone</code></p>
<p>(参考资料)[<a href="http://blog.csdn.net/linuxnews/article/details/51325180" target="_blank" rel="noopener">http://blog.csdn.net/linuxnews/article/details/51325180</a>]</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Installation/CentOS7 关闭防火墙,禁用ipv6.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Installation/CentOS7 关闭防火墙,禁用ipv6.html" itemprop="url">
                  CentOS7 关闭防火墙,禁用ipv6
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:35" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">2018-05-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-05-29 23:19:59" itemprop="dateModified" datetime="2018-05-29T23:19:59+08:00">2018-05-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Installation/" itemprop="url" rel="index"><span itemprop="name">Installation</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="CentOS7-关闭防火墙-禁用ipv6"><a href="#CentOS7-关闭防火墙-禁用ipv6" class="headerlink" title="CentOS7 关闭防火墙,禁用ipv6"></a>CentOS7 关闭防火墙,禁用ipv6</h1><h2 id="CentOS7-关闭防火墙"><a href="#CentOS7-关闭防火墙" class="headerlink" title="CentOS7 关闭防火墙"></a>CentOS7 关闭防火墙</h2><p>firewall-cmd –state #查看默认防火墙状态（关闭后显示notrunning，开启后显示running）</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[root@localhost network-scripts]# firewall-cmd --state</div><div class="line">running</div><div class="line">[root@localhost network-scripts]# systemctl stop firewalld.service </div><div class="line">[75721.569225] Ebtables v2.0 unregistered</div><div class="line">[root@localhost network-scripts]# systemctl disable firewalld.service</div><div class="line">Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.</div><div class="line">Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.</div><div class="line">[root@localhost network-scripts]# firewall-cmd --state</div><div class="line">not running</div></pre></td></tr></table></figure>
</p>
<p>systemctl stop firewalld.service #停止firewall<br>systemctl disable firewalld.service #禁止firewall开机启动</p>
<h2 id="CentOS7禁用ipv6"><a href="#CentOS7禁用ipv6" class="headerlink" title="CentOS7禁用ipv6"></a>CentOS7禁用ipv6</h2><p>vi /etc/default/grub<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">GRUB_TIMEOUT=1</div><div class="line">GRUB_DISTRIBUTOR=&quot;$(sed &apos;s, release .*$,,g&apos; /etc/system-release)&quot;</div><div class="line">GRUB_DEFAULT=saved</div><div class="line">GRUB_DISABLE_SUBMENU=true</div><div class="line">GRUB_TERMINAL=&quot;serial console&quot;</div><div class="line">GRUB_SERIAL_COMMAND=&quot;serial --speed=115200&quot;</div><div class="line">GRUB_CMDLINE_LINUX=&quot;ipv6.disable=1 console=tty0 crashkernel=auto console=ttyS0,115200&quot;</div><div class="line">GRUB_DISABLE_RECOVERY=&quot;true&quot;</div><div class="line">GRUB_DEVICE=LABEL=cloudimg-rootfs</div><div class="line">GRUB_DISABLE_LINUX_UUID=true</div><div class="line">GRUB_TIMEOUT=5</div><div class="line">GRUB_TERMINAL=&quot;serial console&quot;</div><div class="line">GRUB_GFXPAYLOAD_LINUX=text</div><div class="line">GRUB_CMDLINE_LINUX_DEFAULT=&quot;console=tty0 console=ttyS0,115200 no_timer_check&quot;</div><div class="line">GRUB_SERIAL_COMMAND=&quot;serial --speed=115200 --unit=0 --word=8 --parity=no --stop=1&quot;</div><div class="line">GRUB_CMDLINE_LINUX=&quot;nofb nomodeset vga=normal&quot;</div></pre></td></tr></table></figure></p>
<p>grub2-mkconfig -o /boot/grub2/grub.cfg</p>
<p>If the output is 0, IPv6 is enabled.<br>If the output is 1, IPv6 is already disabled.<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[root@localhost network-scripts]# cat /proc/sys/net/ipv6/conf/all/disable_ipv6</div><div class="line">0</div></pre></td></tr></table></figure></p>
<p>lsmod | grep ipv6</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">cloud-init[1716]: 2018-01-08 10:05:08,907 - url_helper.py[WARNING]: Calling &apos;http://10.151.164.1/latest/meta-data/instance-id&apos; failed [30/120s]: request error [(&apos;Connection aborted.&apos;, error(111, &apos;Connection refused&apos;))]</div></pre></td></tr></table></figure>
</p>
<p>删除cloud-init</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Hive/hive元数据库升级脚本.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Hive/hive元数据库升级脚本.html" itemprop="url">
                  hive元数据库升级脚本
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:35 / 修改时间：23:12:06" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">2018-05-23</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Hive/" itemprop="url" rel="index"><span itemprop="name">Hive</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="hive-元数据库升级脚本"><a href="#hive-元数据库升级脚本" class="headerlink" title="hive 元数据库升级脚本"></a>hive 元数据库升级脚本</h1><p>用于HDFS nameservice变更</p>
<p><code>/opt/cloudera/parcels/CDH/lib/hive/scripts</code></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Shell/rmall.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Shell/rmall.html" itemprop="url">
                  rmall
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:35" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">2018-05-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-05-29 23:19:59" itemprop="dateModified" datetime="2018-05-29T23:19:59+08:00">2018-05-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Shell/" itemprop="url" rel="index"><span itemprop="name">Shell</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">for i in `cat ~/servers.txt`</div><div class="line">do</div><div class="line">    echo &quot;--------------begin to change ntpd to $i--------------&quot;</div><div class="line"></div><div class="line">    ssh $i &apos;service cloudera-scm-agent stop&apos;</div><div class="line">    ssh $i &apos;umount /var/run/cloudera-scm-agent/process&apos;</div><div class="line">    ssh $i &apos;rm -rf /usr/share/cmf /var/lib/cloudera* /var/cache/zypp/packages/cloudera-* /var/cache/zypp/raw/cloudera-* /var/cache/zypp/solv/cloudera-* /var/log/cloudera-scm-* /var/run/&apos;cloudera-scm-* /etc/cloudera-scm-server*&apos;</div><div class="line">    ssh $i &apos;rpm -qa |grep cloudera&apos;</div><div class="line">    ssh $i &apos;rpm -e cloudera-manager-agent-5.13.0-1.cm5130.p0.55.el7.x86_64&apos;</div><div class="line">    ssh $i &apos;rpm -e cloudera-manager-daemons-5.13.0-1.cm5130.p0.55.el7.x86_64&apos;</div><div class="line">    ssh $i rm -rf /var/lib/hadoop-* /var/lib/impala /var/lib/solr /var/lib/zookeeper /var/lib/hue /var/lib/oozie  /var/lib/pgsql  /var/lib/sqoop2  /data/dfs/  /data/impala/ /data/yarn/  /dfs/ /impala/ /yarn/  /var/run/hadoop-*/ /var/run/hdfs-*/ /usr/bin/hadoop* /usr/bin/zookeeper* /usr/bin/hbase* /usr/bin/hive* /usr/bin/hdfs /usr/bin/mapred /usr/bin/yarn /usr/&apos;bin/sqoop* /usr/bin/oozie /etc/hadoop* /etc/zookeeper* /etc/hive* /etc/hue /etc/impala /etc/sqoop* /etc/oozie /etc/hbase* /etc/hcatalog &apos;</div><div class="line">    ssh $i &apos;rm -rf /opt/cloudera/parcel-cache /opt/cloudera/parcels&apos;</div><div class="line">    ssh $i &apos;ps aux|grep  supervisord |grep -v grep | awk &apos;&#123;print &quot;kill -9 &quot;$2&#125;&apos;|sh&apos;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">done</div></pre></td></tr></table></figure>
</p>
<hr>
<h2 id="更换Default-gw"><a href="#更换Default-gw" class="headerlink" title="更换Default gw"></a>更换Default gw</h2><p>[root@tddp-nm-5 ~]# route del default gw 10.151.0.1<br>[root@tddp-nm-5 ~]# route add default gw 10.150.4.1</p>
<hr>
<h2 id="Zypper-源配置"><a href="#Zypper-源配置" class="headerlink" title="Zypper 源配置"></a>Zypper 源配置</h2><p>zypper ar <a href="http://10.200.58.39/suse/" target="_blank" rel="noopener">http://10.200.58.39/suse/</a> local.main<br>zypper update</p>
<h2 id="备份源地址："><a href="#备份源地址：" class="headerlink" title="备份源地址："></a>备份源地址：</h2><p>zypper ar <a href="http://10.200.58.43" target="_blank" rel="noopener">http://10.200.58.43</a> local.main<br>zypper ar <a href="http://10.200.58.70/SLES-11-SP3/x86_64/" target="_blank" rel="noopener">http://10.200.58.70/SLES-11-SP3/x86_64/</a> main</p>
<p>zypper 常用命令：<br>      repos, lr     List all defined repositories.<br>addrepo, ar     Add a new repository.<br>removerepo, rr      Remove specified repository.<br>renamerepo, nr      Rename specified repository.<br>modifyrepo, mr      Modify specified repository.<br>refresh, ref        Refresh all repositories.<br>clean           Clean local caches.</p>
<hr>
<h2 id="角色启动失败-报错supervisor"><a href="#角色启动失败-报错supervisor" class="headerlink" title="角色启动失败 报错supervisor"></a>角色启动失败 报错supervisor</h2><p>检查一下,客户端配置是否部署<br>检查 krb5.conf</p>
<hr>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">for i in `cat ~/servers.txt`</div><div class="line">do</div><div class="line">    echo &quot;--------------begin to rm cloudera to $i--------------&quot;</div><div class="line"></div><div class="line">    scp /root/rmall.sh $i:/root/</div><div class="line">    ssh $i &apos;sh /root/rmall.sh&apos;</div><div class="line"></div><div class="line">done</div></pre></td></tr></table></figure>
</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">service cloudera-scm-server stop</div><div class="line">service cloudera-scm-agent stop</div><div class="line">umount /var/run/cloudera-scm-agent/process</div><div class="line">rm -rf /usr/share/cmf /var/lib/cloudera* /var/cache/zypp/packages/cloudera-* /var/cache/zypp/raw/cloudera-* /var/cache/zypp/solv/cloudera-* /var/log/cloudera-scm-* /var/run/cloudera-scm-* /etc/cloudera-scm-server*</div><div class="line">rpm -qa |grep cloudera</div><div class="line">rpm -e cloudera-manager-agent-5.13.0-1.cm5130.p0.55.el7.x86_64</div><div class="line">rpm -e cloudera-manager-server-5.13.0-1.cm5130.p0.55.el7.x86_64</div><div class="line">rpm -e cloudera-manager-daemons-5.13.0-1.cm5130.p0.55.el7.x86_64</div><div class="line">rm -rf /var/lib/hadoop-* /var/lib/impala /var/lib/solr /var/lib/zookeeper /var/lib/hue /var/lib/oozie  /var/lib/pgsql  /var/lib/sqoop2  /data/dfs/  /data/impala/ /data/yarn/  /dfs/ /impala/ /yarn/  /var/run/hadoop-*/ /var/run/hdfs-*/ /usr/bin/hadoop* /usr/bin/zookeeper* /usr/bin/hbase* /usr/bin/hive* /usr/bin/hdfs /usr/bin/mapred /usr/bin/yarn /usr/bin/sqoop* /usr/bin/oozie /etc/hadoop* /etc/zookeeper* /etc/hive* /etc/hue /etc/impala /etc/sqoop* /etc/oozie /etc/hbase* /etc/hcatalog </div><div class="line">rm -rf /opt/cloudera/parcel-cache /opt/cloudera/parcels</div><div class="line">ps aux|grep  supervisord |grep -v grep | awk &apos;&#123;print &quot;kill -9 &quot; $2&#125;&apos;|sh</div></pre></td></tr></table></figure>
</p>
<h2 id="删除对应数据库"><a href="#删除对应数据库" class="headerlink" title="删除对应数据库"></a>删除对应数据库</h2><p><figure class="highlight sql"><table><tr><td class="code"><pre><div class="line"><span class="keyword">drop</span> <span class="keyword">database</span> amon_test;      </div><div class="line"><span class="keyword">drop</span> <span class="keyword">database</span> hue_test;      </div><div class="line"><span class="keyword">drop</span> <span class="keyword">database</span> cm_test;      </div><div class="line"><span class="keyword">drop</span> <span class="keyword">database</span> metastore_test;                </div><div class="line"><span class="keyword">drop</span> <span class="keyword">database</span> nav_test;      </div><div class="line"><span class="keyword">drop</span> <span class="keyword">database</span> navms_test;</div><div class="line"><span class="keyword">drop</span> <span class="keyword">database</span> oozie_test;</div><div class="line"><span class="keyword">drop</span> <span class="keyword">database</span> rman_test;</div><div class="line"><span class="keyword">drop</span> <span class="keyword">database</span> sentry_test;</div><div class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">create</span> <span class="keyword">database</span> metastore_test <span class="keyword">default</span> <span class="built_in">character</span> <span class="keyword">set</span> utf8;</div><div class="line"><span class="keyword">GRANT</span> ALL <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> metastore_test. * <span class="keyword">TO</span> <span class="string">'hive'</span>@<span class="string">'%'</span>;</div><div class="line"><span class="keyword">create</span> <span class="keyword">database</span> amon_test <span class="keyword">default</span> <span class="built_in">character</span> <span class="keyword">set</span> utf8;</div><div class="line"><span class="keyword">grant</span> all <span class="keyword">privileges</span> <span class="keyword">on</span> amon_test.* <span class="keyword">to</span> <span class="string">'amon'</span>@<span class="string">'%'</span>;</div><div class="line"><span class="keyword">create</span> <span class="keyword">database</span> rman_test <span class="keyword">default</span> <span class="built_in">character</span> <span class="keyword">set</span> utf8;</div><div class="line"><span class="keyword">grant</span> all <span class="keyword">privileges</span> <span class="keyword">on</span> rman_test.* <span class="keyword">to</span> <span class="string">'rman'</span>@<span class="string">'%'</span>;</div><div class="line"><span class="keyword">create</span> <span class="keyword">database</span> sentry_test <span class="keyword">default</span> <span class="built_in">character</span> <span class="keyword">set</span> utf8;</div><div class="line"><span class="keyword">grant</span> all <span class="keyword">privileges</span> <span class="keyword">on</span> sentry_test.* <span class="keyword">to</span> <span class="string">'sentry'</span>@<span class="string">'%'</span>;</div><div class="line"><span class="keyword">create</span> <span class="keyword">database</span> nav_test <span class="keyword">default</span> <span class="built_in">character</span> <span class="keyword">set</span> utf8;</div><div class="line"><span class="keyword">grant</span> all <span class="keyword">privileges</span> <span class="keyword">on</span> nav_test.* <span class="keyword">to</span> <span class="string">'nav'</span>@<span class="string">'%'</span>;</div><div class="line"><span class="keyword">create</span> <span class="keyword">database</span> navms_test <span class="keyword">default</span> <span class="built_in">character</span> <span class="keyword">set</span> utf8;</div><div class="line"><span class="keyword">grant</span> all <span class="keyword">privileges</span> <span class="keyword">on</span> navms_test.* <span class="keyword">to</span> <span class="string">'navms'</span>@<span class="string">'%'</span>;</div><div class="line"><span class="keyword">create</span> <span class="keyword">database</span> cm_test <span class="keyword">default</span> <span class="built_in">character</span> <span class="keyword">set</span> utf8;</div><div class="line"><span class="keyword">grant</span> all <span class="keyword">privileges</span> <span class="keyword">on</span> cm_test.* <span class="keyword">to</span> <span class="string">'cm'</span>@<span class="string">'%'</span>;</div><div class="line"><span class="keyword">create</span> <span class="keyword">database</span> hue_test <span class="keyword">default</span> <span class="built_in">character</span> <span class="keyword">set</span> utf8;</div><div class="line"><span class="keyword">GRANT</span> ALL <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> hue_test.* <span class="keyword">TO</span> <span class="string">'hue'</span>@<span class="string">'%'</span>; </div><div class="line"><span class="keyword">create</span> <span class="keyword">database</span> oozie_test <span class="keyword">default</span> <span class="built_in">character</span> <span class="keyword">set</span> utf8;</div><div class="line"><span class="keyword">GRANT</span> ALL <span class="keyword">PRIVILEGES</span> <span class="keyword">ON</span> oozie_test.* <span class="keyword">TO</span> <span class="string">'oozie'</span>@<span class="string">'%'</span>; </div><div class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</div></pre></td></tr></table></figure>
</p>
<p>删除路由 route del -net 10.125.137.0/24 gw 10.150.4.1<br>显示路由 netstat -rn<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[root@tddp-nm-5 ~]# route del default gw 10.151.0.1</div><div class="line">[root@tddp-nm-5 ~]# route add default gw 10.150.4.1</div><div class="line"></div><div class="line">route del default gw 10.151.0.1</div><div class="line">route add default gw 10.150.4.1</div><div class="line"></div><div class="line"></div><div class="line">route add -net 10.200.0.0/16 gw 10.151.0.1</div><div class="line">route add -net 10.125.137.0/24 gw 10.151.0.1</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">route add -net 10.150.4.0/16 gw 10.150.4.1</div></pre></td></tr></table></figure></p>
<h2 id="手动安装"><a href="#手动安装" class="headerlink" title="手动安装"></a>手动安装</h2><p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">yum install cloudera-manager-daemons cloudera-manager-server</div><div class="line">/usr/share/cmf/schema/scm_prepare_database.sh -h 10.150.4.88 mysql cm_test cm Cloudera@123</div><div class="line">vi /etc/hosts</div><div class="line">sh sync_hosts.sh </div><div class="line">service cloudera-scm-server start</div><div class="line"></div><div class="line">tail -f /var/<span class="built_in">log</span>/cloudera-scm-server/cloudera-scm-server.log</div></pre></td></tr></table></figure>
</p>
<p>[root@tddp-zk-2 ~]# tail -f /var/log/cloudera-scm-agent/cloudera-scm-agent.log </p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Hive/hive 元数据库添加中文字段.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Hive/hive 元数据库添加中文字段.html" itemprop="url">
                  hive 元数据库添加中文字段
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:35 / 修改时间：23:12:06" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">2018-05-23</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Hive/" itemprop="url" rel="index"><span itemprop="name">Hive</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="hive-元数据库添加中文字段"><a href="#hive-元数据库添加中文字段" class="headerlink" title="hive 元数据库添加中文字段"></a>hive 元数据库添加中文字段</h1><p>alter table COLUMNS_V2 modify column COMMENT varchar(256) character set utf8;</p>
<p>alter table TABLE_PARAMS modify column PARAM_VALUE varchar(4000) character set utf8;</p>
<p>alter table PARTITION_KEYS modify column PKEY_COMMENT varchar(4000) character set utf8;</p>
<p>alter table TBLS modify column <code>VIEW_EXPANDED_TEXT</code> mediumtext character set utf8;</p>
<p>alter table TBLS modify column <code>VIEW_ORIGINAL_TEXT</code> mediumtext character set utf8;</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/HDFS/Hadoop集成Ceph rgw存储.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/HDFS/Hadoop集成Ceph rgw存储.html" itemprop="url">
                  Hadoop集成Ceph rgw存储
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:35 / 修改时间：23:12:06" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">2018-05-23</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/HDFS/" itemprop="url" rel="index"><span itemprop="name">HDFS</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Hadoop集成Ceph-rgw存储"><a href="#Hadoop集成Ceph-rgw存储" class="headerlink" title="Hadoop集成Ceph rgw存储"></a>Hadoop集成Ceph rgw存储</h1><p>Hadoop与S3的集成可以参考<a href="http://hadoop.apache.org/docs/current/hadoop-aws/tools/hadoop-aws/index.html" target="_blank" rel="noopener">官方说明</a>。实际上对于AWS来说，只有s3协议，但是hadoop由于历史原因，逐步实现了s3-&gt;s3n-&gt;s3a三种访问S3服务的协议，支持的文件也越来越大。由于我们使用的是自建S3 Service，而只有s3a支持设置endpoint，虽然号称“仍有bug”，但也只能硬着头皮上了。</p>
<h2 id="Hadoop配置S3集成"><a href="#Hadoop配置S3集成" class="headerlink" title="Hadoop配置S3集成"></a>Hadoop配置S3集成</h2><p>修改core-site.xml，增加如下配置：<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&lt;property&gt;</div><div class="line">  &lt;name&gt;fs.s3a.access.key&lt;/name&gt;</div><div class="line">  &lt;value&gt;BBBA74VJ69J8I4N0GW3O&lt;/value&gt;</div><div class="line">  &lt;description&gt;AWS access key ID. Omit for Role-based authentication.&lt;/description&gt;</div><div class="line">&lt;/property&gt;</div><div class="line"></div><div class="line">&lt;property&gt;</div><div class="line">  &lt;name&gt;fs.s3a.secret.key&lt;/name&gt;</div><div class="line">  &lt;value&gt;eNKTsutRmHR8HHM03Mx3xT6ctaW3Fd+PX75KGatk&lt;/value&gt;</div><div class="line">  &lt;description&gt;AWS secret key&lt;/description&gt;</div><div class="line">&lt;/property&gt;</div><div class="line"></div><div class="line">&lt;property&gt;</div><div class="line">  &lt;name&gt;fs.s3a.endpoint&lt;/name&gt;</div><div class="line">  &lt;value&gt;10.125.137.31:8080&lt;/value&gt;</div><div class="line">  &lt;description&gt;AWS S3 endpoint to connect to. An up-to-date list is</div><div class="line">    provided in the AWS Documentation: regions and endpoints. Without this</div><div class="line">    property, the standard region (s3.amazonaws.com) is assumed.</div><div class="line">  &lt;/description&gt;</div><div class="line">&lt;/property&gt;</div><div class="line"></div><div class="line">&lt;property&gt;</div><div class="line">  &lt;name&gt;fs.s3a.connection.ssl.enabled&lt;/name&gt;</div><div class="line">  &lt;value&gt;false&lt;/value&gt;</div><div class="line">  &lt;description&gt;Enables or disables SSL connections to S3.&lt;/description&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">  &lt;name&gt;fs.defaultFS&lt;/name&gt;</div><div class="line">  &lt;value&gt;s3a://migu001/&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div></pre></td></tr></table></figure></p>
<p>分别说明下配置项的功能，这些选项在org.apache.hadoop.fs.s3a.Constants中有定义，后面spark集成S3时也会用到。</p>
<p>fs.s3a.access.key/fs.s3a.secret.key，即AK<br>fs.s3a.endpoint，即S3服务地址端口号，注意填写IP，不要用FQDN或者hostname，否则会报Caused by: java.net.UnknownHostException: xxx.zelda2。使用主机名的形式，会造成按AWS的方式来访问，即bucketname.awsxxx.com这种。<br>fs.s3a.connection.ssl.enabled，是否开启ssl，我们的S3服务使用http，需要填写为否。<br>fs.defaultFS, 只需要配置hive,yarn</p>
<p>配置完成后记得重启HDFS/YARN。</p>
<p>试一下文件上传下载好不好使：</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">hdfs dfs -ls s3a://migu001/diamonds.csv</div><div class="line">-rw-rw-rw-   root    3000 2017-10-10 09:59 s3a://migu001/1.log</div><div class="line">hdfs ddistcp /mapred s3a://migu001/</div><div class="line">hdfs dfs -ls s3a://migu001/</div><div class="line">Found 2 items</div><div class="line">-rw-rw-rw-   root    3000 2017-10-10 09:59 s3a://migu001/1.log</div><div class="line">-rw-rw-rw-   root       5953 2017-10-10 09:55 s3a://migu001/mapred</div><div class="line">hdfs dfs -get s3a://migu001/mapred</div></pre></td></tr></table></figure>
</p>
<p>注意fs -ls的时候，bucketname后面有个斜杠，不加会报错：ls: `s3a://xxx’: No such file or directory。 distcp可以把HDFS的文件拷贝到s3上去，当然更方便的是直接使用dfs -put。</p>
<p>再跑个MR：(这个我没有测试过,但是我测试了spark)<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ ./bin/hadoop jar /home/dtdream/hadoop/hadoop-2.7.2/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.2.jar wordcount  s3a://xxx/diamonds.csv /xxx2</div><div class="line">16/07/27 09:59:05 INFO Configuration.deprecation: session.id is deprecated. Instead, use dfs.metrics.session-id</div><div class="line">..</div><div class="line">16/07/27 09:59:06 INFO mapred.MapTask: Processing split: s3a://xxx/diamonds.csv:0+2772075</div><div class="line">16/07/27 09:59:06 INFO mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)</div><div class="line">16/07/27 09:59:06 INFO mapred.MapTask: mapreduce.task.io.sort.mb: 100</div><div class="line">..</div></pre></td></tr></table></figure></p>
<h2 id="Signature-V2-V4"><a href="#Signature-V2-V4" class="headerlink" title="Signature V2/V4"></a>Signature V2/V4</h2><p>由于hadoop的Signature是V2,而s3cmd用的是V4,需要加上参数<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ s3cmd --signature-v2 ls s3://xxx</div><div class="line">2016-07-26 01:59   2772075   s3://xxx/diamonds.csv</div><div class="line">2016-07-26 01:55      5953   s3://xxx/mapred`</div></pre></td></tr></table></figure></p>
<p>而Ceph支持V2，使用1.7.4的aws-java-sdk去访问Ceph S3 Service是正常的。</p>
<p><a href="https://ieevee.com/tech/2016/07/26/s3-2.html" target="_blank" rel="noopener">借鉴文章</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Error/[jdk]Datanode Web 服务器状态告警,但节点其余服务监控正常.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Error/[jdk]Datanode Web 服务器状态告警,但节点其余服务监控正常.html" itemprop="url">
                  Datanode Web 服务器状态告警,但节点其余服务监控正常
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:34" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:34+08:00">2018-05-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-05-29 23:19:59" itemprop="dateModified" datetime="2018-05-29T23:19:59+08:00">2018-05-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Error/" itemprop="url" rel="index"><span itemprop="name">Error</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Datanode-Web-服务器状态告警-但节点其余服务监控正常"><a href="#Datanode-Web-服务器状态告警-但节点其余服务监控正常" class="headerlink" title="Datanode Web 服务器状态告警,但节点其余服务监控正常"></a>Datanode Web 服务器状态告警,但节点其余服务监控正常</h1><blockquote>
<p>告警信息:<br>Cloudera Manager Agent 无法与该角色的 web 服务器通信。</p>
</blockquote>
<h2 id="Datanode-日志如下"><a href="#Datanode-日志如下" class="headerlink" title="Datanode 日志如下"></a>Datanode 日志如下</h2><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">(59 skipped) Error fetching metrics at &apos;http://ddp-dn-072.cmdmp.com:1006/jmx&apos;</div><div class="line">Traceback (most recent call last):</div><div class="line">  File &quot;/usr/lib64/cmf/agent/build/env/lib/python2.6/site-packages/cmf-5.10.0-py2.6.egg/cmf/monitor/generic/metric_collectors.py&quot;, line 200, in _collect_and_parse_and_return</div><div class="line">    self._adapter.safety_valve))</div><div class="line">  File &quot;/usr/lib64/cmf/agent/build/env/lib/python2.6/site-packages/cmf-5.10.0-py2.6.egg/cmf/url_util.py&quot;, line 204, in urlopen_with_retry_on_authentication_errors</div><div class="line">    return function()</div><div class="line">  File &quot;/usr/lib64/cmf/agent/build/env/lib/python2.6/site-packages/cmf-5.10.0-py2.6.egg/cmf/monitor/generic/metric_collectors.py&quot;, line 217, in _open_url</div><div class="line">    password=self._password_value)</div><div class="line">  File &quot;/usr/lib64/cmf/agent/build/env/lib/python2.6/site-packages/cmf-5.10.0-py2.6.egg/cmf/url_util.py&quot;, line 67, in urlopen_with_timeout</div><div class="line">    return opener.open(url, data, timeout)</div><div class="line">  File &quot;/usr/lib64/python2.6/urllib2.py&quot;, line 397, in open</div><div class="line">    response = meth(req, response)</div><div class="line">  File &quot;/usr/lib64/python2.6/urllib2.py&quot;, line 510, in http_response</div><div class="line">    &apos;http&apos;, request, response, code, msg, hdrs)</div><div class="line">  File &quot;/usr/lib64/python2.6/urllib2.py&quot;, line 429, in error</div><div class="line">    result = self._call_chain(*args)</div><div class="line">  File &quot;/usr/lib64/python2.6/urllib2.py&quot;, line 369, in _call_chain</div><div class="line">    result = func(*args)</div><div class="line">  File &quot;/usr/lib64/cmf/agent/build/env/lib/python2.6/site-packages/urllib2_kerberos-0.1.6-py2.6.egg/urllib2_kerberos.py&quot;, line 203, in http_error_401</div><div class="line">    retry = self.http_error_auth_reqed(host, req, headers)</div><div class="line">  File &quot;/usr/lib64/cmf/agent/build/env/lib/python2.6/site-packages/urllib2_kerberos-0.1.6-py2.6.egg/urllib2_kerberos.py&quot;, line 127, in http_error_auth_reqed</div><div class="line">    return self.retry_http_kerberos_auth(req, headers, neg_value)</div><div class="line">  File &quot;/usr/lib64/cmf/agent/build/env/lib/python2.6/site-packages/urllib2_kerberos-0.1.6-py2.6.egg/urllib2_kerberos.py&quot;, line 143, in retry_http_kerberos_auth</div><div class="line">    resp = self.parent.open(req)</div><div class="line">  File &quot;/usr/lib64/python2.6/urllib2.py&quot;, line 397, in open</div><div class="line">    response = meth(req, response)</div><div class="line">  File &quot;/usr/lib64/python2.6/urllib2.py&quot;, line 510, in http_response</div><div class="line">    &apos;http&apos;, request, response, code, msg, hdrs)</div><div class="line">  File &quot;/usr/lib64/python2.6/urllib2.py&quot;, line 435, in error</div><div class="line">    return self._call_chain(*args)</div><div class="line">  File &quot;/usr/lib64/python2.6/urllib2.py&quot;, line 369, in _call_chain</div><div class="line">    result = func(*args)</div><div class="line">  File &quot;/usr/lib64/cmf/agent/build/env/lib/python2.6/site-packages/cmf-5.10.0-py2.6.egg/cmf/https.py&quot;, line 205, in http_error_default</div><div class="line">    raise e</div><div class="line">HTTPError: HTTP Error 403: GSSException: Failure unspecified at GSS-API level (Mechanism level: Encryption type AES256 CTS mode with HMAC SHA1-96 is not supported/enabled)</div></pre></td></tr></table></figure>
</p>
<h2 id="首先检查krb5-conf-发现正常"><a href="#首先检查krb5-conf-发现正常" class="headerlink" title="首先检查krb5.conf(发现正常)"></a>首先检查krb5.conf(发现正常)</h2><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">cat /etc/krb5.conf </div><div class="line">[libdefaults]</div><div class="line">#       default_realm = EXAMPLE.COM </div><div class="line">default_realm = CMDMP.COM</div><div class="line">dns_lookup_realm = false</div><div class="line">dns_lookup_kdc = false</div><div class="line">ticket_lifetime = 24h</div><div class="line">renew_lifetime = 7d</div><div class="line">forwardable = true</div><div class="line">#default_tkt_enctypes = arcfour-hmac-md5</div><div class="line">#default_tgs_enctypes = arcfour-hmac-md5</div><div class="line"></div><div class="line">[realms]</div><div class="line">#       EXAMPLE.COM = &#123;</div><div class="line">#                kdc = kerberos.example.com</div><div class="line">#               admin_server = kerberos.example.com</div><div class="line">#       &#125;</div><div class="line">CMDMP.COM = &#123;</div><div class="line">  kdc = ddp-kdc01.cmdmp.com</div><div class="line">  kdc = ddp-kdc02.cmdmp.com</div><div class="line">  admin_server = ddp-kdc01.cmdmp.com</div><div class="line">&#125;</div><div class="line">SJTEST.COM = &#123;</div><div class="line">kdc = dsj-ddp-test-mstr-06</div><div class="line">kdc = dsj-ddp-test-mstr-02</div><div class="line">admin_server = dsj-ddp-test-mstr-02</div><div class="line">&#125;</div><div class="line">SJAD.COM = &#123;</div><div class="line">kdc = dsj-ddp-ad-kdc-01.sjad.com</div><div class="line">kdc = dsj-ddp-ad-kdc-02.sjad.com</div><div class="line">admin_server = dsj-ddp-ad-kdc-01.sjad.com</div><div class="line">&#125;</div><div class="line"></div><div class="line">[domain_realm]</div><div class="line">.cmdmp.com = CMDMP.COM</div><div class="line">cmdmp.com = CMDMP.COM</div><div class="line">.sjtest.com = SJTEST.COM</div><div class="line">sjtest.com = SJTEST.COM</div><div class="line">.sjad.com = SJAD.COM</div><div class="line">sjad.com = SJAD.COM</div><div class="line"></div><div class="line">[logging]</div><div class="line">    kdc = FILE:/var/log/krb5/krb5kdc.log</div><div class="line">    admin_server = FILE:/var/log/krb5/kadmind.log</div><div class="line">    default = SYSLOG:NOTICE:DAEMON</div></pre></td></tr></table></figure>
</p>
<h2 id="检查Java环境-发现root-用户jdk环境被指定且无特定的jce包"><a href="#检查Java环境-发现root-用户jdk环境被指定且无特定的jce包" class="headerlink" title="检查Java环境(发现root 用户jdk环境被指定且无特定的jce包)"></a>检查Java环境(发现root 用户jdk环境被指定且无特定的jce包)</h2><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">cat ~/.bashrc</div><div class="line">export JAVA_HOME=/usr/java/jdk1.7.0_67</div><div class="line">export PATH=$JAVA_HOME/bin:$PATH</div><div class="line">export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</div><div class="line"></div><div class="line">unset JAVA_HOME</div><div class="line">echo $JAVA_HOME</div><div class="line"></div><div class="line">/etc/init.d/cloudera-scm-agent restart</div></pre></td></tr></table></figure>
</p>
<p>之后为其添加集群所适配的jce解决问题</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Error/[CM]主机心跳显示host id 不被识别.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Error/[CM]主机心跳显示host id 不被识别.html" itemprop="url">
                  主机心跳显示host id 不被识别
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:34" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:34+08:00">2018-05-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-05-29 23:19:59" itemprop="dateModified" datetime="2018-05-29T23:19:59+08:00">2018-05-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Error/" itemprop="url" rel="index"><span itemprop="name">Error</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="主机心跳显示host-id-不被识别"><a href="#主机心跳显示host-id-不被识别" class="headerlink" title="主机心跳显示host id 不被识别"></a>主机心跳显示host id 不被识别</h1><p>主要是有些主机停止服务后太久没有启用,后重新启用导致的<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">The process directory is within /var/run/cloudera-scm-agent/process which</div><div class="line">is a in-memory filesystem. You can recreate it by rebooting the box or by</div><div class="line">restarting the agent with the clean_restart option, which will restart all</div><div class="line">CDH roles on the host as well.</div><div class="line"></div><div class="line"># service cloudera-scm-agent clean_restart</div><div class="line"></div><div class="line">If you face this error again, please check the filesystem&apos;s health (disk</div><div class="line">free, is it writable etc)</div></pre></td></tr></table></figure></p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">WARN 2140628375@agentServer-117775:com.cloudera.server.cmf.AgentProtocolImpl: Received an optimized heartbeat for a host with ID &apos;85e3dd0a-f712-4f70-b151-89d56ae895d2&apos; that is not recognized</div></pre></td></tr></table></figure>
</p>
<p>建议尝试重启agent</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Error/[CM]CDH upgrade alternatives link not updated.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Error/[CM]CDH upgrade alternatives link not updated.html" itemprop="url">
                  CDH upgrade alternatives link not updated
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:34" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:34+08:00">2018-05-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-05-29 23:19:59" itemprop="dateModified" datetime="2018-05-29T23:19:59+08:00">2018-05-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/Error/" itemprop="url" rel="index"><span itemprop="name">Error</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="CDH-upgrade-alternatives-link-not-updated"><a href="#CDH-upgrade-alternatives-link-not-updated" class="headerlink" title="CDH upgrade alternatives link not updated"></a>CDH upgrade alternatives link not updated</h1><p>There seems to be issues around update-alternatives command.<br>Which is often caused by a broken alternatives link under /etc/alternatives/ or a bad (zero length,see [0]) alternatives configuration file under /var/lib/alternatives,and based on your description it appears to be the former.<br>The root cause is that Cloudera Manager Agents relies in the OS provided binary of update-alternatives,<br>however the binary doesn’t relay feedback on bad entries or problems,<br>therefore we have to resort to manually rectifying issues like these.<br>We have an internal improvement JIRA OPSAPS-39415 to explore options on how to make alternatives updates during upgrades more resilient.<br>To recover from the issue,<br>you would need to remove CDH related entries from alternatives configuration files. </p>
<p>[0] <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1016725" target="_blank" rel="noopener">https://bugzilla.redhat.com/show_bug.cgi?id=1016725</a><br>= = = = = = = </p>
<ol>
<li>Stop CM agent service on node service cloudera-scm-agent stop<br><code>service cloudera-scm-agent stop</code></li>
<li>Delete hadoop /etc/alternatives - below will displays the rm command you’ll need to issue.<br><code>ls -l /etc/alternatives/ | grep &quot;\/opt\/cloudera&quot; | awk {&#39;print $9&#39;} | while read m; do if [[ -e /var/lib/alternatives/${m} ]]; then echo &quot;rm -fv /var/lib/alternatives/${m}&quot;; fi; echo &quot;rm -fv /etc/alternatives/${m}&quot;; done</code></li>
<li><p>Remove 0 byte /var/lib/alternatives </p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">cd /var/lib/alternatives </div><div class="line">find . -size 0 | awk &apos;&#123;print $1 &quot; &quot;&#125;&apos; | tr -d &apos;\n&apos;</div></pre></td></tr></table></figure>
</p>
</li>
<li><p>The above command will give you a multi-line output of all 0 byte files in /var/lib/alternatives. Copy all the files,and put into the rm -f rm -f </p>
</li>
<li>Start CM agent service cloudera-scm-agent start<br><code>service cloudera-scm-agent start</code><br>= = = = = = =</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/CM/Windows Kerberos客户端配置并访问CDH.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/CM/Windows Kerberos客户端配置并访问CDH.html" itemprop="url">
                  Windows Kerberos客户端配置并访问CDH
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-05-23 09:57:34" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:34+08:00">2018-05-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-05-29 23:19:59" itemprop="dateModified" datetime="2018-05-29T23:19:59+08:00">2018-05-29</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/" itemprop="url" rel="index"><span itemprop="name">CDH</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CDH/CM/" itemprop="url" rel="index"><span itemprop="name">CM</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Windows-Kerberos客户端配置并访问CDH"><a href="#Windows-Kerberos客户端配置并访问CDH" class="headerlink" title="Windows Kerberos客户端配置并访问CDH"></a>Windows Kerberos客户端配置并访问CDH</h1><p>本文档描述Windows Server2008 R2（windows的内核版本是6.1，与windows 7相同）下安装Kerberos Client及FireFox下HTTP访问HDFS、Yarn、Hive、HBase等Hadoop服务的Web UI(如Namenode的50070，Yarn的8088)的过程。<br>安装文档主要分为以下几步：<br>1.在Windows Server2008 R2 64位上安装Kerberos Client。<br>2.在Windows下使用kinit测试。<br>3.通过keytab在Windows下进行kinit操作。<br>4.配置FireFox。(chrome,ie的配置仅需配置 Internet options. )<br>5.验证服务是否正常访问。<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">xxx-cm:~ # curl --negotiate -u : http://xxx-nn-01.xxxxx.com:50070/</div><div class="line">&lt;html&gt;</div><div class="line">&lt;head&gt;</div><div class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;/&gt;</div><div class="line">&lt;title&gt;Error 401 Authentication required&lt;/title&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;&lt;h2&gt;HTTP ERROR 401&lt;/h2&gt;</div><div class="line">&lt;p&gt;Problem accessing /index.html. Reason:</div><div class="line">&lt;pre&gt;    Authentication required&lt;/pre&gt;&lt;/p&gt;&lt;hr /&gt;&lt;i&gt;&lt;small&gt;Powered by Jetty://&lt;/small&gt;&lt;/i&gt;&lt;br/&gt;                                                </div><div class="line">...</div></pre></td></tr></table></figure></p>
<hr>
<h3 id="linux服务器上是可以通过negotiate参数访问"><a href="#linux服务器上是可以通过negotiate参数访问" class="headerlink" title="linux服务器上是可以通过negotiate参数访问"></a>linux服务器上是可以通过negotiate参数访问</h3><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">xxx-cm:~ # kinit hdfs</div><div class="line">Password for hdfs@xxxxx.COM: </div><div class="line">xxx-cm:~ # curl --negotiate -u : http://xxx-nn-01.xxxxx.com:50070/</div><div class="line">&lt;!--</div><div class="line">   Licensed to the Apache Software Foundation (ASF) under one or more</div><div class="line">   contributor license agreements.  See the NOTICE file distributed with</div><div class="line">   this work for additional information regarding copyright ownership.</div><div class="line">   The ASF licenses this file to You under the Apache License, Version 2.0</div><div class="line">   (the &quot;License&quot;); you may not use this file except in compliance with</div><div class="line">   the License.  You may obtain a copy of the License at</div><div class="line"></div><div class="line">       http://www.apache.org/licenses/LICENSE-2.0</div><div class="line"></div><div class="line">   Unless required by applicable law or agreed to in writing, software</div><div class="line">   distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</div><div class="line">   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</div><div class="line">   See the License for the specific language governing permissions and</div><div class="line">   limitations under the License.</div><div class="line">--&gt;</div><div class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;</div><div class="line">    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;</div><div class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">&lt;meta http-equiv=&quot;REFRESH&quot; content=&quot;1;url=dfshealth.jsp&quot; /&gt;</div><div class="line">&lt;title&gt;Hadoop Administration&lt;/title&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">&lt;script type=&quot;text/javascript&quot;&gt;</div><div class="line">//&lt;![CDATA[</div><div class="line">window.location.href=&apos;dfshealth.html&apos;;</div><div class="line">//]]&gt;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;h1&gt;Hadoop Administration&lt;/h1&gt;</div><div class="line">&lt;ul&gt;</div><div class="line">&lt;li&gt;&lt;a href=&quot;dfshealth.jsp&quot;&gt;DFS Health/Status&lt;/a&gt;&lt;/li&gt;</div><div class="line">&lt;/ul&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
</p>
<h3 id="chrome的配置"><a href="#chrome的配置" class="headerlink" title="chrome的配置"></a>chrome的配置</h3><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">negotiate-delegatewhitelist =“MYIISSERVER.DOMAIN.COM”-auth-schemes =“digest，ntlm，negotiate”</div><div class="line"></div><div class="line">Chrome.exe -auth-server-whitelist =“MYIISSERVER.DOMAIN.COM”-auth-negotiate-delegatewhitelist =“MYIISSERVER.DOMAIN.COM”-auth-schemes =“digest，ntlm，negotiate”</div><div class="line"></div><div class="line">&quot;C:\Program Files (x86)\Google\Chrome\Application\chrome.exe&quot; --auth-server-whitelist =“xxx-cm.xxxxx.com,xxx-nn-01.xxxxx.com,xxx-nn-02.xxxxx.com” --auth-negotiate-delegatewhitelist =“xxx-cm.xxxxx.com,xxx-nn-01.xxxxx.com,xxx-nn-02.xxxxx.com”</div><div class="line"></div><div class="line">--auth-server-whitelist=&quot;xxx-cm.xxxxx.com,xxx-nn-01.xxxxx.com,xxx-nn-02.xxxxx.com&quot;</div></pre></td></tr></table></figure>
</p>
<p>但是配置过后依旧不成功Firefox配置后可以使用</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="Nameless13" />
            
              <p class="site-author-name" itemprop="name">Nameless13</p>
              <p class="site-description motion-element" itemprop="description">─=≡Σ((( つ•̀ω•́)つ，大数据运维工程狮，90后</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">164</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">33</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Nameless13</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动 v3.4.3</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Mist</a> v6.3.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



	





  





  










  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=6.3.0"></script>



  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
