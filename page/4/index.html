<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="90后，桶装水保洁工程狮，ಥ_ಥ">
<meta property="og:type" content="website">
<meta property="og:title" content="Nameless13">
<meta property="og:url" content="https://nameless13.github.io/page/4/index.html">
<meta property="og:site_name" content="Nameless13">
<meta property="og:description" content="90后，桶装水保洁工程狮，ಥ_ಥ">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Nameless13">
<meta name="twitter:description" content="90后，桶装水保洁工程狮，ಥ_ಥ">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: 'J3OX6892F7',
      apiKey: '38852eb9095216f8f2ada575a06a9cfc',
      indexName: 'Blog',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://nameless13.github.io/page/4/"/>





  <title>Nameless13</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Nameless13</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/HDFS/Hadoop集成Ceph rgw存储.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/HDFS/Hadoop集成Ceph rgw存储.html" itemprop="url">Hadoop集成Ceph rgw存储</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/" itemprop="url" rel="index">
                    <span itemprop="name">CDH</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/HDFS/" itemprop="url" rel="index">
                    <span itemprop="name">HDFS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Hadoop集成Ceph-rgw存储"><a href="#Hadoop集成Ceph-rgw存储" class="headerlink" title="Hadoop集成Ceph rgw存储"></a>Hadoop集成Ceph rgw存储</h1><p>Hadoop与S3的集成可以参考<a href="http://hadoop.apache.org/docs/current/hadoop-aws/tools/hadoop-aws/index.html" target="_blank" rel="noopener">官方说明</a>。实际上对于AWS来说，只有s3协议，但是hadoop由于历史原因，逐步实现了s3-&gt;s3n-&gt;s3a三种访问S3服务的协议，支持的文件也越来越大。由于我们使用的是自建S3 Service，而只有s3a支持设置endpoint，虽然号称“仍有bug”，但也只能硬着头皮上了。</p>
<h2 id="Hadoop配置S3集成"><a href="#Hadoop配置S3集成" class="headerlink" title="Hadoop配置S3集成"></a>Hadoop配置S3集成</h2><p>修改core-site.xml，增加如下配置：<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&lt;property&gt;</div><div class="line">  &lt;name&gt;fs.s3a.access.key&lt;/name&gt;</div><div class="line">  &lt;value&gt;BBBA74VJ69J8I4N0GW3O&lt;/value&gt;</div><div class="line">  &lt;description&gt;AWS access key ID. Omit for Role-based authentication.&lt;/description&gt;</div><div class="line">&lt;/property&gt;</div><div class="line"></div><div class="line">&lt;property&gt;</div><div class="line">  &lt;name&gt;fs.s3a.secret.key&lt;/name&gt;</div><div class="line">  &lt;value&gt;eNKTsutRmHR8HHM03Mx3xT6ctaW3Fd+PX75KGatk&lt;/value&gt;</div><div class="line">  &lt;description&gt;AWS secret key&lt;/description&gt;</div><div class="line">&lt;/property&gt;</div><div class="line"></div><div class="line">&lt;property&gt;</div><div class="line">  &lt;name&gt;fs.s3a.endpoint&lt;/name&gt;</div><div class="line">  &lt;value&gt;10.125.137.31:8080&lt;/value&gt;</div><div class="line">  &lt;description&gt;AWS S3 endpoint to connect to. An up-to-date list is</div><div class="line">    provided in the AWS Documentation: regions and endpoints. Without this</div><div class="line">    property, the standard region (s3.amazonaws.com) is assumed.</div><div class="line">  &lt;/description&gt;</div><div class="line">&lt;/property&gt;</div><div class="line"></div><div class="line">&lt;property&gt;</div><div class="line">  &lt;name&gt;fs.s3a.connection.ssl.enabled&lt;/name&gt;</div><div class="line">  &lt;value&gt;false&lt;/value&gt;</div><div class="line">  &lt;description&gt;Enables or disables SSL connections to S3.&lt;/description&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">  &lt;name&gt;fs.defaultFS&lt;/name&gt;</div><div class="line">  &lt;value&gt;s3a://migu001/&lt;/value&gt;</div><div class="line">&lt;/property&gt;</div></pre></td></tr></table></figure></p>
<p>分别说明下配置项的功能，这些选项在org.apache.hadoop.fs.s3a.Constants中有定义，后面spark集成S3时也会用到。</p>
<p>fs.s3a.access.key/fs.s3a.secret.key，即AK<br>fs.s3a.endpoint，即S3服务地址端口号，注意填写IP，不要用FQDN或者hostname，否则会报Caused by: java.net.UnknownHostException: xxx.zelda2。使用主机名的形式，会造成按AWS的方式来访问，即bucketname.awsxxx.com这种。<br>fs.s3a.connection.ssl.enabled，是否开启ssl，我们的S3服务使用http，需要填写为否。<br>fs.defaultFS, 只需要配置hive,yarn</p>
<p>配置完成后记得重启HDFS/YARN。</p>
<p>试一下文件上传下载好不好使：</p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">hdfs dfs -ls s3a://migu001/diamonds.csv</div><div class="line">-rw-rw-rw-   root    3000 2017-10-10 09:59 s3a://migu001/1.log</div><div class="line">hdfs ddistcp /mapred s3a://migu001/</div><div class="line">hdfs dfs -ls s3a://migu001/</div><div class="line">Found 2 items</div><div class="line">-rw-rw-rw-   root    3000 2017-10-10 09:59 s3a://migu001/1.log</div><div class="line">-rw-rw-rw-   root       5953 2017-10-10 09:55 s3a://migu001/mapred</div><div class="line">hdfs dfs -get s3a://migu001/mapred</div></pre></td></tr></table></figure>
</p>
<p>注意fs -ls的时候，bucketname后面有个斜杠，不加会报错：ls: `s3a://xxx’: No such file or directory。 distcp可以把HDFS的文件拷贝到s3上去，当然更方便的是直接使用dfs -put。</p>
<p>再跑个MR：(这个我没有测试过,但是我测试了spark)<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ ./bin/hadoop jar /home/dtdream/hadoop/hadoop-2.7.2/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.2.jar wordcount  s3a://xxx/diamonds.csv /xxx2</div><div class="line">16/07/27 09:59:05 INFO Configuration.deprecation: session.id is deprecated. Instead, use dfs.metrics.session-id</div><div class="line">..</div><div class="line">16/07/27 09:59:06 INFO mapred.MapTask: Processing split: s3a://xxx/diamonds.csv:0+2772075</div><div class="line">16/07/27 09:59:06 INFO mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)</div><div class="line">16/07/27 09:59:06 INFO mapred.MapTask: mapreduce.task.io.sort.mb: 100</div><div class="line">..</div></pre></td></tr></table></figure></p>
<h2 id="Signature-V2-V4"><a href="#Signature-V2-V4" class="headerlink" title="Signature V2/V4"></a>Signature V2/V4</h2><p>由于hadoop的Signature是V2,而s3cmd用的是V4,需要加上参数<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ s3cmd --signature-v2 ls s3://xxx</div><div class="line">2016-07-26 01:59   2772075   s3://xxx/diamonds.csv</div><div class="line">2016-07-26 01:55      5953   s3://xxx/mapred`</div></pre></td></tr></table></figure></p>
<p>而Ceph支持V2，使用1.7.4的aws-java-sdk去访问Ceph S3 Service是正常的。</p>
<p><a href="https://ieevee.com/tech/2016/07/26/s3-2.html" target="_blank" rel="noopener">借鉴文章</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Document/CentOS 7 修改时区.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Document/CentOS 7 修改时区.html" itemprop="url">CentOS 7 修改时区</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Document/" itemprop="url" rel="index">
                    <span itemprop="name">Document</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Linux 系统(我特指发行版, 没说内核) 下大部分软件的风格就是不会仔细去考虑向后 的兼容性, 比如你上个版本能用这种程序配置, 没准到了下一个版本, 该程序已经不见了. 比如 sysvinit 这种东西.<br>设置时区同样, 在 CentOS 7 中, 引入了一个叫 timedatectl 的设置设置程序.<br>用法很简单:<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line"># timedatectl # 查看系统时间方面的各种状态</div><div class="line">      Local time: 四 2014-12-25 10:52:10 CST</div><div class="line">  Universal time: 四 2014-12-25 02:52:10 UTC</div><div class="line">        RTC time: 四 2014-12-25 02:52:10</div><div class="line">        Timezone: Asia/Shanghai (CST, +0800)</div><div class="line">     NTP enabled: yes</div><div class="line">NTP synchronized: yes</div><div class="line"> RTC in local TZ: no</div><div class="line">      DST active: n/a</div><div class="line"># timedatectl list-timezones # 列出所有时区</div><div class="line"># timedatectl set-local-rtc 1 # 将硬件时钟调整为与本地时钟一致, 0 为设置为 UTC 时间</div><div class="line"># timedatectl set-timezone Asia/Shanghai # 设置系统时区为上海</div></pre></td></tr></table></figure></p>
<p>其实不考虑各个发行版的差异化, 从更底层出发的话, 修改时间时区比想象中要简单:<br><code># cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</code></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Notes/openstack部署cdh初始化同步脚本.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Notes/openstack部署cdh初始化同步脚本.html" itemprop="url">openstack部署cdh初始化同步脚本</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/" itemprop="url" rel="index">
                    <span itemprop="name">CDH</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/Notes/" itemprop="url" rel="index">
                    <span itemprop="name">Notes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `cat ~/servers.txt`</div><div class="line"><span class="keyword">do</span></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to sync ntp.conf to <span class="variable">$i</span>--------------"</span></div><div class="line">    scp /etc/ntp.conf <span class="variable">$i</span>:/etc/ntp.conf</div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'systemctl restart ntpd.service'</span></div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to change ntpd to <span class="variable">$i</span>--------------"</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'systemctl enable ntpd.service'</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'systemctl start ntpd.service'</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'systemctl disable chronyd'</span></div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to change hugepage to <span class="variable">$i</span>--------------"</span></div><div class="line">    scp /etc/rc.d/rc.local <span class="variable">$i</span>:/etc/rc.d/rc.local</div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'chmod +x /etc/rc.d/rc.local'</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled'</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'echo never &gt; /sys/kernel/mm/transparent_hugepage/defrag'</span></div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to sync hosts to <span class="variable">$i</span>--------------"</span></div><div class="line">    scp /etc/hosts <span class="variable">$i</span>:/etc/hosts</div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to add route to <span class="variable">$i</span>--------------"</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'route add -net 10.200.0.0/16 gw 10.151.0.1'</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'route add -net 10.125.137.0/24 gw 10.151.0.1'</span></div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to restart agent to <span class="variable">$i</span>--------------"</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'systemctl restart cloudera-scm-agent.service'</span></div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to restart agent to <span class="variable">$i</span>--------------"</span></div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'service cloudera-scm-agent restart'</span></div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to rm cloudera to <span class="variable">$i</span>--------------"</span></div><div class="line">    scp /root/rmall.sh <span class="variable">$i</span>:/root/</div><div class="line">    ssh <span class="variable">$i</span> <span class="string">'sh /root/rmall.sh'</span></div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to sync disable ens6 to default-route  <span class="variable">$i</span>--------------"</span></div><div class="line">    scp /etc/sysconfig/network-scripts/ifcfg-ens6 <span class="variable">$i</span>:/etc/sysconfig/network-scripts/ifcfg-ens6</div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="string">"--------------begin to sync wget to <span class="variable">$i</span>--------------"</span></div><div class="line">    ssh  <span class="variable">$i</span> <span class="string">'yum -y install wget'</span></div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure>
</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Linux/Cannot unlock the password for user.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Linux/Cannot unlock the password for user.html" itemprop="url">Cannot unlock the password for user</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="‘Cannot-unlock-the-password-for-lt-user-gt-’"><a href="#‘Cannot-unlock-the-password-for-lt-user-gt-’" class="headerlink" title="‘Cannot unlock the password for &lt;user&gt;!’"></a>‘Cannot unlock the password for &lt;user&gt;!’</h1><p>pam_tally –user= –reset</p>
<p>Example</p>
<p>pam_tally –user=cyberninja –reset<br>I hope this helps someone.</p>
<p>I found this post looking for an answer to this exact question. I had the same error but on a SLES 11 SP2 server. My co-worker reset my password and tried to unlock my account with the command passwd -u. One of my other co-workers said I needed clear account in PAM and gave me the command. Which I have posted above.</p>
<p>Update,</p>
<p>I now have a fix that keeps this from happening again. It seems that there are two PAM files that where in conflict. These files are; /etc/pam.d/login and /etc/pam.d/sshd. Both files have this line.</p>
<p>auth required pam_tally.so onerr=fail deny=3<br>You must commit out, this line from one of the files listed above. We commented the line out in the /etc/pam.d/sshd file.</p>
<p>After you do this you should never have this issue again.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Document/google font.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Document/google font.html" itemprop="url">google font</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Document/" itemprop="url" rel="index">
                    <span itemprop="name">Document</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="google字体更改到本地调用"><a href="#google字体更改到本地调用" class="headerlink" title="google字体更改到本地调用"></a>google字体更改到本地调用</h1><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">layout/_partials/head/external-fonts.swig</div><div class="line"></div><div class="line">46      &#123;% set font_families += &apos;&amp;subset=latin,latin-ext&apos; %&#125;</div><div class="line">47      &#123;% set font_host = font_config.host | default(&apos;//fonts.googleapis.com&apos;) %&#125;</div><div class="line">48      &lt;link href=&quot;&#123;&#123; font_host &#125;&#125;/css?family=&#123;&#123; font_families &#125;&#125;&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;</div></pre></td></tr></table></figure>
</p>
<p>更改wp-includes文件夹下script-loader.php中的代码，大概在602行将：<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">1</div><div class="line">$open_sans_font_url = &quot;//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,300,400,600&amp;subset=$subsets&quot;;</div><div class="line">替换为：</div><div class="line"></div><div class="line">1</div><div class="line">$open_sans_font_url = &quot;//fonts.useso.com/css?family=Open+Sans:300italic,400italic,600italic,300,400,600&amp;subset=$subsets&quot;;</div></pre></td></tr></table></figure></p>
<p><a href="https://link.zhihu.com/?target=https%3A//github.com/AlphaTr/redirectggfonts" target="_blank" rel="noopener">https://link.zhihu.com/?target=https%3A//github.com/AlphaTr/redirectggfonts</a></p>
<p><a href="http://lug.ustc.edu.cn" target="_blank" rel="noopener">http://lug.ustc.edu.cn</a> </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/Linux/Linux 操作系统检查.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Linux/Linux 操作系统检查.html" itemprop="url">Linux 操作系统检查</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:35+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Linux-操作系统检查"><a href="#Linux-操作系统检查" class="headerlink" title="Linux 操作系统检查"></a>Linux 操作系统检查</h1><p>输入”uname -a “,可显示电脑以及操作系统的相关信息<br>输入”cat /proc/version”,说明正在运行的内核版本。<br>输入”cat /etc/issue”, 显示的是发行版本信息<br>lsb_release -a (适用于所有的linux，包括Redhat、SuSE、Debian等发行版，但是需要安装lsb)</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/CM/Windows Kerberos客户端配置并访问CDH.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/CM/Windows Kerberos客户端配置并访问CDH.html" itemprop="url">Windows Kerberos客户端配置并访问CDH</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:34+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/" itemprop="url" rel="index">
                    <span itemprop="name">CDH</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/CM/" itemprop="url" rel="index">
                    <span itemprop="name">CM</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Windows-Kerberos客户端配置并访问CDH"><a href="#Windows-Kerberos客户端配置并访问CDH" class="headerlink" title="Windows Kerberos客户端配置并访问CDH"></a>Windows Kerberos客户端配置并访问CDH</h1><p>本文档描述Windows Server2008 R2（windows的内核版本是6.1，与windows 7相同）下安装Kerberos Client及FireFox下HTTP访问HDFS、Yarn、Hive、HBase等Hadoop服务的Web UI(如Namenode的50070，Yarn的8088)的过程。<br>安装文档主要分为以下几步：<br>1.在Windows Server2008 R2 64位上安装Kerberos Client。<br>2.在Windows下使用kinit测试。<br>3.通过keytab在Windows下进行kinit操作。<br>4.配置FireFox。(chrome,ie的配置仅需配置 Internet options. )<br>5.验证服务是否正常访问。<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">xxx-cm:~ # curl --negotiate -u : http://xxx-nn-01.xxxxx.com:50070/</div><div class="line">&lt;html&gt;</div><div class="line">&lt;head&gt;</div><div class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;/&gt;</div><div class="line">&lt;title&gt;Error 401 Authentication required&lt;/title&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;&lt;h2&gt;HTTP ERROR 401&lt;/h2&gt;</div><div class="line">&lt;p&gt;Problem accessing /index.html. Reason:</div><div class="line">&lt;pre&gt;    Authentication required&lt;/pre&gt;&lt;/p&gt;&lt;hr /&gt;&lt;i&gt;&lt;small&gt;Powered by Jetty://&lt;/small&gt;&lt;/i&gt;&lt;br/&gt;                                                </div><div class="line">...</div></pre></td></tr></table></figure></p>
<hr>
<h3 id="linux服务器上是可以通过negotiate参数访问"><a href="#linux服务器上是可以通过negotiate参数访问" class="headerlink" title="linux服务器上是可以通过negotiate参数访问"></a>linux服务器上是可以通过negotiate参数访问</h3><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">xxx-cm:~ # kinit hdfs</div><div class="line">Password for hdfs@xxxxx.COM: </div><div class="line">xxx-cm:~ # curl --negotiate -u : http://xxx-nn-01.xxxxx.com:50070/</div><div class="line">&lt;!--</div><div class="line">   Licensed to the Apache Software Foundation (ASF) under one or more</div><div class="line">   contributor license agreements.  See the NOTICE file distributed with</div><div class="line">   this work for additional information regarding copyright ownership.</div><div class="line">   The ASF licenses this file to You under the Apache License, Version 2.0</div><div class="line">   (the &quot;License&quot;); you may not use this file except in compliance with</div><div class="line">   the License.  You may obtain a copy of the License at</div><div class="line"></div><div class="line">       http://www.apache.org/licenses/LICENSE-2.0</div><div class="line"></div><div class="line">   Unless required by applicable law or agreed to in writing, software</div><div class="line">   distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</div><div class="line">   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</div><div class="line">   See the License for the specific language governing permissions and</div><div class="line">   limitations under the License.</div><div class="line">--&gt;</div><div class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;</div><div class="line">    &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;</div><div class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">&lt;meta http-equiv=&quot;REFRESH&quot; content=&quot;1;url=dfshealth.jsp&quot; /&gt;</div><div class="line">&lt;title&gt;Hadoop Administration&lt;/title&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">&lt;script type=&quot;text/javascript&quot;&gt;</div><div class="line">//&lt;![CDATA[</div><div class="line">window.location.href=&apos;dfshealth.html&apos;;</div><div class="line">//]]&gt;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;h1&gt;Hadoop Administration&lt;/h1&gt;</div><div class="line">&lt;ul&gt;</div><div class="line">&lt;li&gt;&lt;a href=&quot;dfshealth.jsp&quot;&gt;DFS Health/Status&lt;/a&gt;&lt;/li&gt;</div><div class="line">&lt;/ul&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
</p>
<h3 id="chrome的配置"><a href="#chrome的配置" class="headerlink" title="chrome的配置"></a>chrome的配置</h3><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">negotiate-delegatewhitelist =“MYIISSERVER.DOMAIN.COM”-auth-schemes =“digest，ntlm，negotiate”</div><div class="line"></div><div class="line">Chrome.exe -auth-server-whitelist =“MYIISSERVER.DOMAIN.COM”-auth-negotiate-delegatewhitelist =“MYIISSERVER.DOMAIN.COM”-auth-schemes =“digest，ntlm，negotiate”</div><div class="line"></div><div class="line">&quot;C:\Program Files (x86)\Google\Chrome\Application\chrome.exe&quot; --auth-server-whitelist =“xxx-cm.xxxxx.com,xxx-nn-01.xxxxx.com,xxx-nn-02.xxxxx.com” --auth-negotiate-delegatewhitelist =“xxx-cm.xxxxx.com,xxx-nn-01.xxxxx.com,xxx-nn-02.xxxxx.com”</div><div class="line"></div><div class="line">--auth-server-whitelist=&quot;xxx-cm.xxxxx.com,xxx-nn-01.xxxxx.com,xxx-nn-02.xxxxx.com&quot;</div></pre></td></tr></table></figure>
</p>
<p>但是配置过后依旧不成功Firefox配置后可以使用</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Error/[jdk]Datanode Web 服务器状态告警,但节点其余服务监控正常.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Error/[jdk]Datanode Web 服务器状态告警,但节点其余服务监控正常.html" itemprop="url">Datanode Web 服务器状态告警,但节点其余服务监控正常</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:34+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/" itemprop="url" rel="index">
                    <span itemprop="name">CDH</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/Error/" itemprop="url" rel="index">
                    <span itemprop="name">Error</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Datanode-Web-服务器状态告警-但节点其余服务监控正常"><a href="#Datanode-Web-服务器状态告警-但节点其余服务监控正常" class="headerlink" title="Datanode Web 服务器状态告警,但节点其余服务监控正常"></a>Datanode Web 服务器状态告警,但节点其余服务监控正常</h1><blockquote>
<p>告警信息:<br>Cloudera Manager Agent 无法与该角色的 web 服务器通信。</p>
</blockquote>
<h2 id="Datanode-日志如下"><a href="#Datanode-日志如下" class="headerlink" title="Datanode 日志如下"></a>Datanode 日志如下</h2><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">(59 skipped) Error fetching metrics at &apos;http://ddp-dn-072.cmdmp.com:1006/jmx&apos;</div><div class="line">Traceback (most recent call last):</div><div class="line">  File &quot;/usr/lib64/cmf/agent/build/env/lib/python2.6/site-packages/cmf-5.10.0-py2.6.egg/cmf/monitor/generic/metric_collectors.py&quot;, line 200, in _collect_and_parse_and_return</div><div class="line">    self._adapter.safety_valve))</div><div class="line">  File &quot;/usr/lib64/cmf/agent/build/env/lib/python2.6/site-packages/cmf-5.10.0-py2.6.egg/cmf/url_util.py&quot;, line 204, in urlopen_with_retry_on_authentication_errors</div><div class="line">    return function()</div><div class="line">  File &quot;/usr/lib64/cmf/agent/build/env/lib/python2.6/site-packages/cmf-5.10.0-py2.6.egg/cmf/monitor/generic/metric_collectors.py&quot;, line 217, in _open_url</div><div class="line">    password=self._password_value)</div><div class="line">  File &quot;/usr/lib64/cmf/agent/build/env/lib/python2.6/site-packages/cmf-5.10.0-py2.6.egg/cmf/url_util.py&quot;, line 67, in urlopen_with_timeout</div><div class="line">    return opener.open(url, data, timeout)</div><div class="line">  File &quot;/usr/lib64/python2.6/urllib2.py&quot;, line 397, in open</div><div class="line">    response = meth(req, response)</div><div class="line">  File &quot;/usr/lib64/python2.6/urllib2.py&quot;, line 510, in http_response</div><div class="line">    &apos;http&apos;, request, response, code, msg, hdrs)</div><div class="line">  File &quot;/usr/lib64/python2.6/urllib2.py&quot;, line 429, in error</div><div class="line">    result = self._call_chain(*args)</div><div class="line">  File &quot;/usr/lib64/python2.6/urllib2.py&quot;, line 369, in _call_chain</div><div class="line">    result = func(*args)</div><div class="line">  File &quot;/usr/lib64/cmf/agent/build/env/lib/python2.6/site-packages/urllib2_kerberos-0.1.6-py2.6.egg/urllib2_kerberos.py&quot;, line 203, in http_error_401</div><div class="line">    retry = self.http_error_auth_reqed(host, req, headers)</div><div class="line">  File &quot;/usr/lib64/cmf/agent/build/env/lib/python2.6/site-packages/urllib2_kerberos-0.1.6-py2.6.egg/urllib2_kerberos.py&quot;, line 127, in http_error_auth_reqed</div><div class="line">    return self.retry_http_kerberos_auth(req, headers, neg_value)</div><div class="line">  File &quot;/usr/lib64/cmf/agent/build/env/lib/python2.6/site-packages/urllib2_kerberos-0.1.6-py2.6.egg/urllib2_kerberos.py&quot;, line 143, in retry_http_kerberos_auth</div><div class="line">    resp = self.parent.open(req)</div><div class="line">  File &quot;/usr/lib64/python2.6/urllib2.py&quot;, line 397, in open</div><div class="line">    response = meth(req, response)</div><div class="line">  File &quot;/usr/lib64/python2.6/urllib2.py&quot;, line 510, in http_response</div><div class="line">    &apos;http&apos;, request, response, code, msg, hdrs)</div><div class="line">  File &quot;/usr/lib64/python2.6/urllib2.py&quot;, line 435, in error</div><div class="line">    return self._call_chain(*args)</div><div class="line">  File &quot;/usr/lib64/python2.6/urllib2.py&quot;, line 369, in _call_chain</div><div class="line">    result = func(*args)</div><div class="line">  File &quot;/usr/lib64/cmf/agent/build/env/lib/python2.6/site-packages/cmf-5.10.0-py2.6.egg/cmf/https.py&quot;, line 205, in http_error_default</div><div class="line">    raise e</div><div class="line">HTTPError: HTTP Error 403: GSSException: Failure unspecified at GSS-API level (Mechanism level: Encryption type AES256 CTS mode with HMAC SHA1-96 is not supported/enabled)</div></pre></td></tr></table></figure>
</p>
<h2 id="首先检查krb5-conf-发现正常"><a href="#首先检查krb5-conf-发现正常" class="headerlink" title="首先检查krb5.conf(发现正常)"></a>首先检查krb5.conf(发现正常)</h2><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">cat /etc/krb5.conf </div><div class="line">[libdefaults]</div><div class="line">#       default_realm = EXAMPLE.COM </div><div class="line">default_realm = CMDMP.COM</div><div class="line">dns_lookup_realm = false</div><div class="line">dns_lookup_kdc = false</div><div class="line">ticket_lifetime = 24h</div><div class="line">renew_lifetime = 7d</div><div class="line">forwardable = true</div><div class="line">#default_tkt_enctypes = arcfour-hmac-md5</div><div class="line">#default_tgs_enctypes = arcfour-hmac-md5</div><div class="line"></div><div class="line">[realms]</div><div class="line">#       EXAMPLE.COM = &#123;</div><div class="line">#                kdc = kerberos.example.com</div><div class="line">#               admin_server = kerberos.example.com</div><div class="line">#       &#125;</div><div class="line">CMDMP.COM = &#123;</div><div class="line">  kdc = ddp-kdc01.cmdmp.com</div><div class="line">  kdc = ddp-kdc02.cmdmp.com</div><div class="line">  admin_server = ddp-kdc01.cmdmp.com</div><div class="line">&#125;</div><div class="line">SJTEST.COM = &#123;</div><div class="line">kdc = dsj-ddp-test-mstr-06</div><div class="line">kdc = dsj-ddp-test-mstr-02</div><div class="line">admin_server = dsj-ddp-test-mstr-02</div><div class="line">&#125;</div><div class="line">SJAD.COM = &#123;</div><div class="line">kdc = dsj-ddp-ad-kdc-01.sjad.com</div><div class="line">kdc = dsj-ddp-ad-kdc-02.sjad.com</div><div class="line">admin_server = dsj-ddp-ad-kdc-01.sjad.com</div><div class="line">&#125;</div><div class="line"></div><div class="line">[domain_realm]</div><div class="line">.cmdmp.com = CMDMP.COM</div><div class="line">cmdmp.com = CMDMP.COM</div><div class="line">.sjtest.com = SJTEST.COM</div><div class="line">sjtest.com = SJTEST.COM</div><div class="line">.sjad.com = SJAD.COM</div><div class="line">sjad.com = SJAD.COM</div><div class="line"></div><div class="line">[logging]</div><div class="line">    kdc = FILE:/var/log/krb5/krb5kdc.log</div><div class="line">    admin_server = FILE:/var/log/krb5/kadmind.log</div><div class="line">    default = SYSLOG:NOTICE:DAEMON</div></pre></td></tr></table></figure>
</p>
<h2 id="检查Java环境-发现root-用户jdk环境被指定且无特定的jce包"><a href="#检查Java环境-发现root-用户jdk环境被指定且无特定的jce包" class="headerlink" title="检查Java环境(发现root 用户jdk环境被指定且无特定的jce包)"></a>检查Java环境(发现root 用户jdk环境被指定且无特定的jce包)</h2><p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">cat ~/.bashrc</div><div class="line">export JAVA_HOME=/usr/java/jdk1.7.0_67</div><div class="line">export PATH=$JAVA_HOME/bin:$PATH</div><div class="line">export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</div><div class="line"></div><div class="line">unset JAVA_HOME</div><div class="line">echo $JAVA_HOME</div><div class="line"></div><div class="line">/etc/init.d/cloudera-scm-agent restart</div></pre></td></tr></table></figure>
</p>
<p>之后为其添加集群所适配的jce解决问题</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Error/[CM]CDH upgrade alternatives link not updated.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Error/[CM]CDH upgrade alternatives link not updated.html" itemprop="url">CDH upgrade alternatives link not updated</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:34+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/" itemprop="url" rel="index">
                    <span itemprop="name">CDH</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/Error/" itemprop="url" rel="index">
                    <span itemprop="name">Error</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="CDH-upgrade-alternatives-link-not-updated"><a href="#CDH-upgrade-alternatives-link-not-updated" class="headerlink" title="CDH upgrade alternatives link not updated"></a>CDH upgrade alternatives link not updated</h1><p>There seems to be issues around update-alternatives command.<br>Which is often caused by a broken alternatives link under /etc/alternatives/ or a bad (zero length,see [0]) alternatives configuration file under /var/lib/alternatives,and based on your description it appears to be the former.<br>The root cause is that Cloudera Manager Agents relies in the OS provided binary of update-alternatives,<br>however the binary doesn’t relay feedback on bad entries or problems,<br>therefore we have to resort to manually rectifying issues like these.<br>We have an internal improvement JIRA OPSAPS-39415 to explore options on how to make alternatives updates during upgrades more resilient.<br>To recover from the issue,<br>you would need to remove CDH related entries from alternatives configuration files. </p>
<p>[0] <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1016725" target="_blank" rel="noopener">https://bugzilla.redhat.com/show_bug.cgi?id=1016725</a><br>= = = = = = = </p>
<ol>
<li>Stop CM agent service on node service cloudera-scm-agent stop<br><code>service cloudera-scm-agent stop</code></li>
<li>Delete hadoop /etc/alternatives - below will displays the rm command you’ll need to issue.<br><code>ls -l /etc/alternatives/ | grep &quot;\/opt\/cloudera&quot; | awk {&#39;print $9&#39;} | while read m; do if [[ -e /var/lib/alternatives/${m} ]]; then echo &quot;rm -fv /var/lib/alternatives/${m}&quot;; fi; echo &quot;rm -fv /etc/alternatives/${m}&quot;; done</code></li>
<li><p>Remove 0 byte /var/lib/alternatives </p>
<p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">cd /var/lib/alternatives </div><div class="line">find . -size 0 | awk &apos;&#123;print $1 &quot; &quot;&#125;&apos; | tr -d &apos;\n&apos;</div></pre></td></tr></table></figure>
</p>
</li>
<li><p>The above command will give you a multi-line output of all 0 byte files in /var/lib/alternatives. Copy all the files,and put into the rm -f rm -f </p>
</li>
<li>Start CM agent service cloudera-scm-agent start<br><code>service cloudera-scm-agent start</code><br>= = = = = = =</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://nameless13.github.io/CDH/Error/[OpenStack]SUSE hostname 每4分钟修改为host-ip.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Nameless13">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nameless13">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/CDH/Error/[OpenStack]SUSE hostname 每4分钟修改为host-ip.html" itemprop="url">SUSE hostname 每4分钟修改为host-ip</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T09:57:34+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/" itemprop="url" rel="index">
                    <span itemprop="name">CDH</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CDH/Error/" itemprop="url" rel="index">
                    <span itemprop="name">Error</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>SUSE hostname 4分钟修改为host-ip</p>
<ol>
<li>dhcp SERVER 肯定那是设置了 修改client端的主机名的,因为我本机dhcp /etc/sysconfig/network/scripts/dhcpcd-hook 配置文件把修改主机名的 函数干掉了都还是会被修改</li>
<li>模版默认参数被修改了 /etc/sysconfig/network/dhcp DHCLIENT_SET_HOSTNAME:Q 默认应该client端不允许修改主机名才对</li>
<li>结果互相连接不上了</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Nameless13" />
          <p class="site-author-name" itemprop="name">Nameless13</p>
           
              <p class="site-description motion-element" itemprop="description">90后，桶装水保洁工程狮，ಥ_ಥ</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">164</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">33</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        

      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Nameless13</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
